{"openapi":"3.1.0","info":{"title":"Novel Builder Backend","description":"FastAPI backend for novel crawling and management","version":"0.2.0"},"paths":{"/health":{"get":{"summary":"Health Check","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Health Check Health Get"}}}}}}},"/source-sites":{"get":{"summary":"Get Source Sites","description":"获取所有源站列表","operationId":"get_source_sites_source_sites_get","parameters":[{"name":"X-API-TOKEN","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/SourceSite"},"title":"Response Get Source Sites Source Sites Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/search":{"get":{"summary":"Search","description":"搜索小说，支持指定站点","operationId":"search_search_get","parameters":[{"name":"keyword","in":"query","required":true,"schema":{"type":"string","minLength":1,"description":"小说名称或作者","title":"Keyword"},"description":"小说名称或作者"},{"name":"sites","in":"query","required":false,"schema":{"type":"string","description":"指定搜索站点，逗号分隔，如 alice_sw,shukuge","title":"Sites"},"description":"指定搜索站点，逗号分隔，如 alice_sw,shukuge"},{"name":"X-API-TOKEN","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Novel"},"title":"Response Search Search Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/chapters":{"get":{"summary":"Chapters","operationId":"chapters_chapters_get","parameters":[{"name":"url","in":"query","required":true,"schema":{"type":"string","description":"小说详情页或阅读页URL","title":"Url"},"description":"小说详情页或阅读页URL"},{"name":"X-API-TOKEN","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Chapter"},"title":"Response Chapters Chapters Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/chapter-content":{"get":{"summary":"Chapter Content","description":"获取章节内容\n\n- **url**: 章节URL\n- **force_refresh**: 是否强制刷新（默认 False）\n  - False: 优先从缓存获取，缓存不存在时从源站抓取\n  - True: 强制从源站重新获取（用于更新内容）","operationId":"chapter_content_chapter_content_get","parameters":[{"name":"url","in":"query","required":true,"schema":{"type":"string","description":"章节URL","title":"Url"},"description":"章节URL"},{"name":"force_refresh","in":"query","required":false,"schema":{"type":"boolean","description":"强制刷新，从源站重新获取","default":false,"title":"Force Refresh"},"description":"强制刷新，从源站重新获取"},{"name":"X-API-TOKEN","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterContent"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/cache/create":{"post":{"summary":"Create Cache Task","description":"创建缓存任务\n\n- **novel_url**: 小说详情页URL","operationId":"create_cache_task_api_cache_create_post","parameters":[{"name":"novel_url","in":"query","required":true,"schema":{"type":"string","description":"小说URL","title":"Novel Url"},"description":"小说URL"},{"name":"X-API-TOKEN","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/cache/status/{task_id}":{"get":{"summary":"Get Cache Status","description":"获取缓存任务状态","operationId":"get_cache_status_api_cache_status__task_id__get","parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"integer","title":"Task Id"}},{"name":"X-API-TOKEN","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/cache/tasks":{"get":{"summary":"Get Cache Tasks","description":"获取缓存任务列表","operationId":"get_cache_tasks_api_cache_tasks_get","parameters":[{"name":"status","in":"query","required":false,"schema":{"type":"string","description":"任务状态筛选: pending, running, completed, failed, cancelled","title":"Status"},"description":"任务状态筛选: pending, running, completed, failed, cancelled"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"返回数量限制","default":20,"title":"Limit"},"description":"返回数量限制"},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","minimum":0,"description":"偏移量","default":0,"title":"Offset"},"description":"偏移量"},{"name":"X-API-TOKEN","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/cache/cancel/{task_id}":{"post":{"summary":"Cancel Cache Task","description":"取消缓存任务","operationId":"cancel_cache_task_api_cache_cancel__task_id__post","parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"integer","title":"Task Id"}},{"name":"X-API-TOKEN","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/cache/download/{task_id}":{"get":{"summary":"Download Cached Novel","description":"下载已缓存的小说\n\n- **task_id**: 缓存任务ID\n- **format**: 下载格式 (json/txt)","operationId":"download_cached_novel_api_cache_download__task_id__get","parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"integer","title":"Task Id"}},{"name":"format","in":"query","required":false,"schema":{"type":"string","description":"下载格式: json, txt","default":"json","title":"Format"},"description":"下载格式: json, txt"},{"name":"X-API-TOKEN","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Index","operationId":"index__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"Chapter":{"properties":{"title":{"type":"string","title":"Title"},"url":{"type":"string","title":"Url"}},"type":"object","required":["title","url"],"title":"Chapter","description":"Chapter metadata schema."},"ChapterContent":{"properties":{"title":{"type":"string","title":"Title"},"content":{"type":"string","title":"Content"},"from_cache":{"type":"boolean","title":"From Cache","default":false}},"type":"object","required":["title","content"],"title":"ChapterContent","description":"Chapter content schema."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"Novel":{"properties":{"title":{"type":"string","title":"Title"},"author":{"type":"string","title":"Author"},"url":{"type":"string","title":"Url"}},"type":"object","required":["title","author","url"],"title":"Novel","description":"Novel metadata schema."},"SourceSite":{"properties":{"id":{"type":"string","title":"Id"},"name":{"type":"string","title":"Name"},"base_url":{"type":"string","title":"Base Url"},"description":{"type":"string","title":"Description"},"enabled":{"type":"boolean","title":"Enabled"},"search_enabled":{"type":"boolean","title":"Search Enabled"}},"type":"object","required":["id","name","base_url","description","enabled","search_enabled"],"title":"SourceSite","description":"Source site information schema."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}