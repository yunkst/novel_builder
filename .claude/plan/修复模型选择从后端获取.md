# 修复模型选择从后端获取 - 执行计划

## 项目上下文
- **项目**: Novel Builder - 全栈小说阅读平台
- **技术栈**: Flutter + FastAPI + PostgreSQL
- **目标**: 将视频生成对话框中的硬编码模型列表改为从后端动态获取

## 当前问题
- 前端 ModelSelector 组件硬编码返回 ['SVD', 'AnimateDiff']
- 后端已有 /api/models 接口但返回类型为 JsonObject
- API Service Wrapper 未包装对应方法
- 需要正确定义响应模型并使用代码生成工作流

## 实施步骤

### 步骤 1: 在后端定义准确的 Pydantic 响应模型
**文件**: backend/app/schemas.py
**目标**: 添加 WorkflowInfo 和 ModelsResponse 模型

### 步骤 2: 更新后端接口使用新模型
**文件**: backend/app/main.py
**目标**: 修改 get_models() 函数返回 ModelsResponse

### 步骤 3: 重启后端服务更新 OpenAPI 规范
**命令**: docker-compose restart backend
**目标**: 使 OpenAPI 规范包含新的响应模型

### 步骤 4: 生成新的 API 客户端代码
**命令**: dart run tool/generate_api.dart
**目标**: 自动生成强类型的 ModelsResponse 和 WorkflowInfo 模型

### 步骤 5: 在 API Service Wrapper 中添加 getModels() 方法
**文件**: novel_app/lib/services/api_service_wrapper.dart
**目标**: 包装生成的 API 方法，提供业务逻辑接口

### 步骤 6: 修改 ModelSelector 组件使用生成模型
**文件**: novel_app/lib/widgets/model_selector.dart
**目标**: 替换硬编码为动态 API 调用，添加加载状态

### 步骤 7: 测试验证
**目标**: 端到端测试视频生成对话框的模型选择功能

## 预期结果
- 视频生成对话框显示后端配置的实际模型列表
- 支持动态更新，无需修改前端代码
- 类型安全，编译时检查
- 良好的用户体验（加载状态、错误处理）