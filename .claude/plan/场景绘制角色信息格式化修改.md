# 场景绘制角色信息格式化修改

## 任务目标
修改 `_restore_roles_from_json()` 方法，使其返回结构化文本格式的角色信息，只包含名字、face_prompts、body_prompts 字段。

## 上下文
- 当前方法返回 dict[str, Any] 格式
- 需要改为返回格式化字符串
- 发送给 Dify 的角色信息要与 Flutter App 直接调用时的格式保持一致
- 缺少字段时跳过

## 执行计划

### 1. 分析当前方法实现
- 查看 `_restore_roles_from_json()` 方法的完整逻辑
- 理解数据流转和调用关系

### 2. 修改方法签名和返回类型
- 返回类型: dict[str, Any] -> str
- 更新文档说明

### 3. 实现新的格式化逻辑
- 解析 JSON 为 RoleInfo 对象列表
- 格式化输出，只包含名字、face_prompts、body_prompts
- 缺少字段时跳过

### 4. 修改调用点
- 更新 `process_scene_task()` 中的调用逻辑
- 直接将字符串发送给 Dify

### 5. 测试验证
- 验证输出格式正确性
- 确保功能正常工作