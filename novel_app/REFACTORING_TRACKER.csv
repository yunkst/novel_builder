文件路径,总行数,主要类数,估计方法数,问题类型,严重程度,主要职责,重构建议,预计工作量,状态,备注
lib/services/database_service.dart,3543,1,100+,God Class,严重,数据库管理+缓存+角色+关系+插图+大纲等8种职责,拆分为Repository模式,3-5天,待开始,最高优先级
lib/services/dify_service.dart,2150,1,40+,混合职责,严重,工作流+角色生成+场景生成+AI伴侣等6种AI功能,按AI功能领域拆分,2-3天,待开始,最高优先级
lib/screens/reader_screen.dart,1734,2,80+,Bloated View,严重,UI渲染+内容管理+用户交互+AI集成+导航+设置+TTS等7种职责,采用Controller模式拆分,4-6天,待开始,build方法372行
lib/screens/character_edit_screen.dart,1324,2,50+,Bloated View,高,复杂表单+角色卡片生成+图片上传+验证,提取表单组件和Controller,2-3天,待开始,
lib/services/api_service_wrapper.dart,1161,1,30+,职责过多,高,包装过多API端点+初始化+缓存+错误处理,按功能域拆分API客户端,2天,待开始,
lib/screens/chapter_list_screen.dart,1157,2,40+,Bloated View,高,章节列表UI+缓存管理+搜索+排序,拆分Controller和Widget,2天,待开始,
lib/screens/character_management_screen.dart,987,2,35+,Bloated View,高,角色列表+CRUD操作,提取Controller和Widget,1-2天,待开始,
lib/screens/multi_role_chat_screen.dart,921,2,30+,UI复杂,中,聊天界面复杂,拆分消息组件,1-2天,待开始,
lib/screens/insert_chapter_screen.dart,909,2,30+,表单复杂,中,插入章节表单,提取表单组件,1天,待开始,
lib/widgets/scene_image_preview.dart,856,1,25+,功能混合,中,图片预览+处理,提取图片服务,1天,待开始,
lib/screens/gallery_view_screen.dart,850,2,25+,功能复杂,中,画廊功能,拆分画廊组件,1-2天,待开始,
lib/services/tts_player_service.dart,801,1,20+,状态管理复杂,中,TTS播放+状态管理,简化状态管理,1天,待开始,
lib/widgets/character_input_dialog.dart,788,1,20+,对话框复杂,中,角色输入对话框,提取表单组件,1天,待开始,
lib/screens/unified_relationship_graph_screen.dart,714,2,20+,UI复杂,中,关系图谱渲染,拆分图谱组件,1-2天,待开始,
lib/widgets/immersive/immersive_init_screen.dart,694,2,20+,流程过长,中,沉浸式初始化,简化流程,1天,待开始,
lib/screens/character_chat_screen.dart,638,2,20+,UI复杂,中,聊天界面,简化UI组件,1天,待开始,
lib/screens/bookshelf_screen.dart,615,2,20+,功能混合,中,书架管理+UI,优化结构,1天,待开始,
lib/widgets/reader/paragraph_rewrite_dialog.dart,601,1,15+,对话框复杂,中,段落重写对话框,拆分组件,1天,待开始,
lib/utils/dialog_manager.dart,599,1,15+,功能过多,中,对话框管理,优化管理逻辑,1天,待开始,
lib/services/logger_service.dart,587,1,15+,功能冗余,中,日志服务,简化日志逻辑,1天,待开始,
lib/widgets/character_preview_dialog.dart,581,1,15+,对话框复杂,中,角色预览对话框,简化组件,1天,待开始,
lib/screens/illustration_debug_screen.dart,534,2,15+,调试界面,中,插图调试,精简界面,1天,待开始,
lib/controllers/pagination_controller.dart,532,1,15+,控制器复杂,中,分页控制,简化逻辑,1天,待开始,
lib/widgets/scene_illustration_dialog.dart,500,1,15+,对话框复杂,中,场景插图对话框,提取组件,1天,待开始,
lib/screens/background_setting_screen.dart,463,2,15+,表单复杂,低,背景设置表单,简化表单,1天,待开始,
lib/services/scene_illustration_service.dart,462,1,15+,服务职责多,低,场景插图服务,优化结构,1天,待开始,
lib/screens/log_viewer_screen.dart,458,2,15+,界面复杂,低,日志查看器,简化UI,1天,待开始,
lib/screens/tts_player_screen.dart,452,2,15+,UI复杂,低,TTS播放器,简化界面,1天,待开始,
lib/screens/chapter_search_screen.dart,452,2,15+,功能混合,低,章节搜索,优化结构,1天,待开始,
