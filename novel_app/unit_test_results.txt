Flutter assets will be downloaded from https://storage.flutter-io.cn. Make sure you trust this source!
00:00 +0: loading D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart
test/unit/ai_companion_auto_trigger_test.dart:316:11: Error: No named parameter with the name 'novelUrl'.
          novelUrl: novelUrl,
          ^^^^^^^^
lib/models/character_relationship.dart:14:3: Context: Found this candidate, but the arguments don't match.
  CharacterRelationship({
  ^^^^^^^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:40:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
      await databaseService.insertToBookshelf(
                            ^^^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:70:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
      await databaseService.insertToBookshelf(
                            ^^^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:98:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
      await databaseService.insertToBookshelf(
                            ^^^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:123:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
      await databaseService.insertToBookshelf(
                            ^^^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:144:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
      await databaseService.insertToBookshelf(
                            ^^^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:197:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
      await databaseService.insertToBookshelf(
                            ^^^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:204:29: Error: The method 'insertCharacter' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertCharacter'.
      await databaseService.insertCharacter(
                            ^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:250:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
      await databaseService.insertToBookshelf(
                            ^^^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:257:29: Error: The method 'insertCharacter' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertCharacter'.
      await databaseService.insertCharacter(
                            ^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:261:29: Error: The method 'insertCharacter' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertCharacter'.
      await databaseService.insertCharacter(
                            ^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:285:68: Error: The argument type 'String' can't be assigned to the parameter type 'int'.
      final relationships = await databaseService.getRelationships(novelUrl);
                                                                   ^
test/unit/ai_companion_auto_trigger_test.dart:289:23: Error: The getter 'character1' isn't defined for the type 'CharacterRelationship'.
 - 'CharacterRelationship' is from 'package:novel_app/models/character_relationship.dart' ('lib/models/character_relationship.dart').
Try correcting the name to the name of an existing getter, or defining a getter or field named 'character1'.
      expect(relation.character1, equals('张三'));
                      ^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:290:23: Error: The getter 'character2' isn't defined for the type 'CharacterRelationship'.
 - 'CharacterRelationship' is from 'package:novel_app/models/character_relationship.dart' ('lib/models/character_relationship.dart').
Try correcting the name to the name of an existing getter, or defining a getter or field named 'character2'.
      expect(relation.character2, equals('李四'));
                      ^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:291:23: Error: The getter 'relationType' isn't defined for the type 'CharacterRelationship'.
 - 'CharacterRelationship' is from 'package:novel_app/models/character_relationship.dart' ('lib/models/character_relationship.dart').
Try correcting the name to the name of an existing getter, or defining a getter or field named 'relationType'.
      expect(relation.relationType, contains('师父'));
                      ^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:297:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
      await databaseService.insertToBookshelf(
                            ^^^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:304:29: Error: The method 'insertCharacter' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertCharacter'.
      await databaseService.insertCharacter(
                            ^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:308:29: Error: The method 'insertCharacter' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertCharacter'.
      await databaseService.insertCharacter(
                            ^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:313:29: Error: The method 'insertRelationship' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertRelationship'.
      await databaseService.insertRelationship(
                            ^^^^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:342:68: Error: The argument type 'String' can't be assigned to the parameter type 'int'.
      final relationships = await databaseService.getRelationships(novelUrl);
                                                                   ^
test/unit/ai_companion_auto_trigger_test.dart:354:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
      await databaseService.insertToBookshelf(
                            ^^^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:361:41: Error: Too few positional arguments: 3 required, 0 given.
      await databaseService.cacheChapter(
                                        ^
test/unit/ai_companion_auto_trigger_test.dart:384:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
      await databaseService.insertToBookshelf(
                            ^^^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:390:41: Error: Too few positional arguments: 3 required, 0 given.
      await databaseService.cacheChapter(
                                        ^
test/unit/ai_companion_auto_trigger_test.dart:412:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
      await databaseService.insertToBookshelf(
                            ^^^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:418:41: Error: Too few positional arguments: 3 required, 0 given.
      await databaseService.cacheChapter(
                                        ^
test/unit/ai_companion_auto_trigger_test.dart:451:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
      await databaseService.insertToBookshelf(
                            ^^^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:457:41: Error: Too few positional arguments: 3 required, 0 given.
      await databaseService.cacheChapter(
                                        ^
test/unit/ai_companion_auto_trigger_test.dart:501:29: Error: The method 'insertCharacter' isn't defined for the type 'DatabaseService'.
 - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
Try correcting the name to the name of an existing method, or defining a method named 'insertCharacter'.
      await databaseService.insertCharacter(
                            ^^^^^^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:527:68: Error: The argument type 'String' can't be assigned to the parameter type 'int'.
      final relationships = await databaseService.getRelationships(novelUrl);
                                                                   ^
test/unit/ai_companion_auto_trigger_test.dart:529:34: Error: The getter 'character1' isn't defined for the type 'CharacterRelationship'.
 - 'CharacterRelationship' is from 'package:novel_app/models/character_relationship.dart' ('lib/models/character_relationship.dart').
Try correcting the name to the name of an existing getter, or defining a getter or field named 'character1'.
      expect(relationships.first.character1, equals('主角'));
                                 ^^^^^^^^^^
test/unit/ai_companion_auto_trigger_test.dart:530:34: Error: The getter 'character2' isn't defined for the type 'CharacterRelationship'.
 - 'CharacterRelationship' is from 'package:novel_app/models/character_relationship.dart' ('lib/models/character_relationship.dart').
Try correcting the name to the name of an existing getter, or defining a getter or field named 'character2'.
      expect(relationships.first.character2, equals('师父'));
                                 ^^^^^^^^^^
✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:00 +0: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段
00:00 +0 -1: loading D:/myspace/novel_builder/novel_app/test/unit/ai_companion_auto_trigger_test.dart [E]
  Failed to load "D:/myspace/novel_builder/novel_app/test/unit/ai_companion_auto_trigger_test.dart":
  Compilation failed for testPath=D:/myspace/novel_builder/novel_app/test/unit/ai_companion_auto_trigger_test.dart: test/unit/ai_companion_auto_trigger_test.dart:316:11: Error: No named parameter with the name 'novelUrl'.
            novelUrl: novelUrl,
            ^^^^^^^^
  lib/models/character_relationship.dart:14:3: Context: Found this candidate, but the arguments don't match.
    CharacterRelationship({
    ^^^^^^^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:40:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
        await databaseService.insertToBookshelf(
                              ^^^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:70:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
        await databaseService.insertToBookshelf(
                              ^^^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:98:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
        await databaseService.insertToBookshelf(
                              ^^^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:123:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
        await databaseService.insertToBookshelf(
                              ^^^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:144:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
        await databaseService.insertToBookshelf(
                              ^^^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:197:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
        await databaseService.insertToBookshelf(
                              ^^^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:204:29: Error: The method 'insertCharacter' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertCharacter'.
        await databaseService.insertCharacter(
                              ^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:250:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
        await databaseService.insertToBookshelf(
                              ^^^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:257:29: Error: The method 'insertCharacter' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertCharacter'.
        await databaseService.insertCharacter(
                              ^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:261:29: Error: The method 'insertCharacter' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertCharacter'.
        await databaseService.insertCharacter(
                              ^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:285:68: Error: The argument type 'String' can't be assigned to the parameter type 'int'.
        final relationships = await databaseService.getRelationships(novelUrl);
                                                                     ^
  test/unit/ai_companion_auto_trigger_test.dart:289:23: Error: The getter 'character1' isn't defined for the type 'CharacterRelationship'.
   - 'CharacterRelationship' is from 'package:novel_app/models/character_relationship.dart' ('lib/models/character_relationship.dart').
  Try correcting the name to the name of an existing getter, or defining a getter or field named 'character1'.
        expect(relation.character1, equals('张三'));
                        ^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:290:23: Error: The getter 'character2' isn't defined for the type 'CharacterRelationship'.
   - 'CharacterRelationship' is from 'package:novel_app/models/character_relationship.dart' ('lib/models/character_relationship.dart').
  Try correcting the name to the name of an existing getter, or defining a getter or field named 'character2'.
        expect(relation.character2, equals('李四'));
                        ^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:291:23: Error: The getter 'relationType' isn't defined for the type 'CharacterRelationship'.
   - 'CharacterRelationship' is from 'package:novel_app/models/character_relationship.dart' ('lib/models/character_relationship.dart').
  Try correcting the name to the name of an existing getter, or defining a getter or field named 'relationType'.
        expect(relation.relationType, contains('师父'));
                        ^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:297:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
        await databaseService.insertToBookshelf(
                              ^^^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:304:29: Error: The method 'insertCharacter' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertCharacter'.
        await databaseService.insertCharacter(
                              ^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:308:29: Error: The method 'insertCharacter' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertCharacter'.
        await databaseService.insertCharacter(
                              ^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:313:29: Error: The method 'insertRelationship' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertRelationship'.
        await databaseService.insertRelationship(
                              ^^^^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:342:68: Error: The argument type 'String' can't be assigned to the parameter type 'int'.
        final relationships = await databaseService.getRelationships(novelUrl);
                                                                     ^
  test/unit/ai_companion_auto_trigger_test.dart:354:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
        await databaseService.insertToBookshelf(
                              ^^^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:361:41: Error: Too few positional arguments: 3 required, 0 given.
        await databaseService.cacheChapter(
                                          ^
  test/unit/ai_companion_auto_trigger_test.dart:384:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
        await databaseService.insertToBookshelf(
                              ^^^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:390:41: Error: Too few positional arguments: 3 required, 0 given.
        await databaseService.cacheChapter(
                                          ^
  test/unit/ai_companion_auto_trigger_test.dart:412:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
        await databaseService.insertToBookshelf(
                              ^^^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:418:41: Error: Too few positional arguments: 3 required, 0 given.
        await databaseService.cacheChapter(
                                          ^
  test/unit/ai_companion_auto_trigger_test.dart:451:29: Error: The method 'insertToBookshelf' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertToBookshelf'.
        await databaseService.insertToBookshelf(
                              ^^^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:457:41: Error: Too few positional arguments: 3 required, 0 given.
        await databaseService.cacheChapter(
                                          ^
  test/unit/ai_companion_auto_trigger_test.dart:501:29: Error: The method 'insertCharacter' isn't defined for the type 'DatabaseService'.
   - 'DatabaseService' is from 'package:novel_app/services/database_service.dart' ('lib/services/database_service.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'insertCharacter'.
        await databaseService.insertCharacter(
                              ^^^^^^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:527:68: Error: The argument type 'String' can't be assigned to the parameter type 'int'.
        final relationships = await databaseService.getRelationships(novelUrl);
                                                                     ^
  test/unit/ai_companion_auto_trigger_test.dart:529:34: Error: The getter 'character1' isn't defined for the type 'CharacterRelationship'.
   - 'CharacterRelationship' is from 'package:novel_app/models/character_relationship.dart' ('lib/models/character_relationship.dart').
  Try correcting the name to the name of an existing getter, or defining a getter or field named 'character1'.
        expect(relationships.first.character1, equals('主角'));
                                   ^^^^^^^^^^
  test/unit/ai_companion_auto_trigger_test.dart:530:34: Error: The getter 'character2' isn't defined for the type 'CharacterRelationship'.
   - 'CharacterRelationship' is from 'package:novel_app/models/character_relationship.dart' ('lib/models/character_relationship.dart').
  Try correcting the name to the name of an existing getter, or defining a getter or field named 'character2'.
        expect(relationships.first.character2, equals('师父'));
                                   ^^^^^^^^^^
  .
00:00 +0 -1: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:00 +0 -2: loading D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart [E]
  Error: The Dart compiler exited unexpectedly.
  package:flutter_tools/src/base/common.dart 34:3  throwToolExit
  package:flutter_tools/src/compile.dart 910:11    DefaultResidentCompiler._compile.<fn>
  dart:async/zone.dart 1538:47                     _rootRunUnary
  dart:async/zone.dart 1429:19                     _CustomZone.runUnary
  dart:async/future_impl.dart 948:45               Future._propagateToListeners.handleValueCallback
  dart:async/future_impl.dart 977:13               Future._propagateToListeners
  dart:async/future_impl.dart 862:9                Future._propagateToListeners
  dart:async/future_impl.dart 720:5                Future._completeWithValue
  dart:async/future_impl.dart 804:7                Future._asyncCompleteWithValue.<fn>
  dart:async/zone.dart 1525:13                     _rootRun
  dart:async/zone.dart 1422:19                     _CustomZone.run
  dart:async/zone.dart 1321:7                      _CustomZone.runGuarded
  dart:async/zone.dart 1362:23                     _CustomZone.bindCallbackGuarded.<fn>
  dart:async/schedule_microtask.dart 40:35         _microtaskLoop
  dart:async/schedule_microtask.dart 49:5          _startMicrotaskLoop
  dart:isolate-patch/isolate_patch.dart 127:13     _runPendingImmediateCallback
  dart:isolate-patch/isolate_patch.dart 194:5      _RawReceivePort._handleMessage
  
00:00 +0 -2: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:00 +1 -2: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段
00:00 +2 -2: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段
00:00 +3 -2: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段
00:00 +4 -2: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段
00:00 +5 -2: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段
00:00 +6 -2: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段
00:00 +7 -2: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段
00:00 +8 -2: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段
00:00 +9 -2: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段
00:00 +10 -2: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段
00:00 +11 -2: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段

=== chapter_cache 表结构 ===
  id: INTEGER
  novelUrl: TEXT
  chapterUrl: TEXT
  title: TEXT
  content: TEXT
  chapterIndex: INTEGER
  cachedAt: INTEGER
  ai_accompanied: INTEGER
00:00 +11 -3: D:/myspace/novel_builder/novel_app/test/unit/ai_accompaniment_logic_verification_test.dart: AI伴读核心逻辑验证 场景模拟测试 场景2：用户重新阅读已伴读章节
00:00 +11 -3: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试1: 检查chapter_cache表是否有isAccompanied字段 [E]
  Expected: true
    Actual: <false>
  chapter_cache表应该包含isAccompanied字段
  
  package:matcher                                     expect
  package:flutter_test/src/widget_tester.dart 473:18  expect
  test\unit\accompaniment_display_test.dart 41:7      main.<fn>.<fn>
  
00:00 +12 -3: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试2: 检查novel_chapters表是否有isAccompanied字段
00:00 +13 -3: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试2: 检查novel_chapters表是否有isAccompanied字段
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:00 +14 -3: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试2: 检查novel_chapters表是否有isAccompanied字段
00:00 +15 -3: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试2: 检查novel_chapters表是否有isAccompanied字段
00:00 +16 -3: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试2: 检查novel_chapters表是否有isAccompanied字段
00:00 +17 -3: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试2: 检查novel_chapters表是否有isAccompanied字段
00:00 +18 -3: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试2: 检查novel_chapters表是否有isAccompanied字段
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}

=== novel_chapters 表结构 ===
  id: INTEGER
  novelUrl: TEXT
  chapterUrl: TEXT
  title: TEXT
  chapterIndex: INTEGER
  isUserInserted: INTEGER
  insertedAt: INTEGER
00:00 +18 -4: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试2: 检查novel_chapters表是否有isAccompanied字段 [E]
  Expected: true
    Actual: <false>
  novel_chapters表应该包含isAccompanied字段
  
  package:matcher                                     expect
  package:flutter_test/src/widget_tester.dart 473:18  expect
  test\unit\accompaniment_display_test.dart 64:7      main.<fn>.<fn>
  
00:00 +18 -4: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试3: 验证缓存章节时isAccompanied字段被保存
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}

=== 缓存章节数据 ===
  isAccompanied: null
00:00 +18 -5: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试3: 验证缓存章节时isAccompanied字段被保存 [E]
  Expected: <1>
    Actual: <null>
  isAccompanied应该被保存到数据库
  
  package:matcher                                     expect
  package:flutter_test/src/widget_tester.dart 473:18  expect
  test\unit\accompaniment_display_test.dart 115:7     main.<fn>.<fn>
  
00:00 +18 -5: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试4: 验证getChapters方法返回isAccompanied字段
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:00 +18 -6: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试4: 验证getChapters方法返回isAccompanied字段 [E]
  Expected: true
    Actual: <false>
  
  package:matcher                                     expect
  package:flutter_test/src/widget_tester.dart 473:18  expect
  test\unit\accompaniment_display_test.dart 155:7     main.<fn>.<fn>
  
00:00 +18 -6: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试5: 完整流程测试 - 模拟章节列表加载
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}

=== 章节列表伴读状态 ===
00:00 +18 -7: D:/myspace/novel_builder/novel_app/test/unit/accompaniment_display_test.dart: AI伴读状态显示问题分析 测试5: 完整流程测试 - 模拟章节列表加载 [E]
  Expected: <3>
    Actual: <0>
  
  package:matcher                                     expect
  package:flutter_test/src/widget_tester.dart 473:18  expect
  test\unit\accompaniment_display_test.dart 230:7     main.<fn>.<fn>
  
test/unit/chapter_manager_test.dart:122:30: Error: The method 'preloadChapter' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'preloadChapter'.
        await chapterManager.preloadChapter(
                             ^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:130:31: Error: The method 'isChapterPreloaded' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloaded'.
        expect(chapterManager.isChapterPreloaded(chapterUrl), isTrue);
                              ^^^^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:145:30: Error: The method 'preloadChapters' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'preloadChapters'.
        await chapterManager.preloadChapters(
                             ^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:155:31: Error: The method 'isChapterPreloaded' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloaded'.
        expect(chapterManager.isChapterPreloaded('https://example.com/chapter1'), isTrue);
                              ^^^^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:156:31: Error: The method 'isChapterPreloaded' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloaded'.
        expect(chapterManager.isChapterPreloaded('https://example.com/chapter2'), isTrue);
                              ^^^^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:157:31: Error: The method 'isChapterPreloaded' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloaded'.
        expect(chapterManager.isChapterPreloaded('https://example.com/chapter3'), isTrue);
                              ^^^^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:170:30: Error: The method 'preloadChapter' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'preloadChapter'.
        await chapterManager.preloadChapter(
                             ^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:176:30: Error: The method 'preloadChapter' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'preloadChapter'.
        await chapterManager.preloadChapter(
                             ^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:195:31: Error: The method 'isChapterBeingProcessed' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'isChapterBeingProcessed'.
        expect(chapterManager.isChapterBeingProcessed(chapterUrl), isFalse);
                              ^^^^^^^^^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:204:31: Error: The method 'isChapterBeingProcessed' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'isChapterBeingProcessed'.
        expect(chapterManager.isChapterBeingProcessed(chapterUrl), isTrue);
                              ^^^^^^^^^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:210:31: Error: The method 'isChapterBeingProcessed' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'isChapterBeingProcessed'.
        expect(chapterManager.isChapterBeingProcessed(chapterUrl), isFalse);
                              ^^^^^^^^^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:304:31: Error: The method 'isChapterBeingProcessed' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'isChapterBeingProcessed'.
        expect(chapterManager.isChapterBeingProcessed(chapterUrl), isFalse);
                              ^^^^^^^^^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:332:31: Error: The method 'isChapterBeingProcessed' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'isChapterBeingProcessed'.
        expect(chapterManager.isChapterBeingProcessed(chapterUrl), isTrue);
                              ^^^^^^^^^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:353:31: Error: The method 'isChapterPreloading' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloading'.
        expect(chapterManager.isChapterPreloading(chapterUrl), isFalse);
                              ^^^^^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:356:46: Error: The method 'preloadChapter' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'preloadChapter'.
        final preloadFuture = chapterManager.preloadChapter(
                                             ^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:362:31: Error: The method 'isChapterPreloading' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloading'.
        expect(chapterManager.isChapterPreloading(chapterUrl), isTrue);
                              ^^^^^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:368:31: Error: The method 'isChapterPreloading' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloading'.
        expect(chapterManager.isChapterPreloading(chapterUrl), isFalse);
                              ^^^^^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:369:31: Error: The method 'isChapterPreloaded' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloaded'.
        expect(chapterManager.isChapterPreloaded(chapterUrl), isTrue);
                              ^^^^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:377:30: Error: The method 'preloadChapters' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'preloadChapters'.
        await chapterManager.preloadChapters(
                             ^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:384:37: Error: The method 'preloadChapters' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'preloadChapters'.
        expect(() => chapterManager.preloadChapters(
                                    ^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:409:30: Error: The method 'preloadChapters' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'preloadChapters'.
        await chapterManager.preloadChapters(
                             ^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:428:30: Error: The method 'preloadChapter' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'preloadChapter'.
        await chapterManager.preloadChapter(
                             ^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:437:31: Error: The method 'isChapterPreloaded' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloaded'.
        expect(chapterManager.isChapterPreloaded(chapterUrl1), isFalse);
                              ^^^^^^^^^^^^^^^^^^
test/unit/chapter_manager_test.dart:462:30: Error: The method 'preloadChapters' isn't defined for the type 'ChapterManager'.
 - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
Try correcting the name to the name of an existing method, or defining a method named 'preloadChapters'.
        await chapterManager.preloadChapters(
                             ^^^^^^^^^^^^^^^
00:01 +18 -8: loading D:/myspace/novel_builder/novel_app/test/unit/chapter_manager_test.dart [E]
  Failed to load "D:/myspace/novel_builder/novel_app/test/unit/chapter_manager_test.dart":
  Compilation failed for testPath=D:/myspace/novel_builder/novel_app/test/unit/chapter_manager_test.dart: test/unit/chapter_manager_test.dart:122:30: Error: The method 'preloadChapter' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'preloadChapter'.
          await chapterManager.preloadChapter(
                               ^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:130:31: Error: The method 'isChapterPreloaded' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloaded'.
          expect(chapterManager.isChapterPreloaded(chapterUrl), isTrue);
                                ^^^^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:145:30: Error: The method 'preloadChapters' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'preloadChapters'.
          await chapterManager.preloadChapters(
                               ^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:155:31: Error: The method 'isChapterPreloaded' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloaded'.
          expect(chapterManager.isChapterPreloaded('https://example.com/chapter1'), isTrue);
                                ^^^^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:156:31: Error: The method 'isChapterPreloaded' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloaded'.
          expect(chapterManager.isChapterPreloaded('https://example.com/chapter2'), isTrue);
                                ^^^^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:157:31: Error: The method 'isChapterPreloaded' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloaded'.
          expect(chapterManager.isChapterPreloaded('https://example.com/chapter3'), isTrue);
                                ^^^^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:170:30: Error: The method 'preloadChapter' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'preloadChapter'.
          await chapterManager.preloadChapter(
                               ^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:176:30: Error: The method 'preloadChapter' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'preloadChapter'.
          await chapterManager.preloadChapter(
                               ^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:195:31: Error: The method 'isChapterBeingProcessed' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'isChapterBeingProcessed'.
          expect(chapterManager.isChapterBeingProcessed(chapterUrl), isFalse);
                                ^^^^^^^^^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:204:31: Error: The method 'isChapterBeingProcessed' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'isChapterBeingProcessed'.
          expect(chapterManager.isChapterBeingProcessed(chapterUrl), isTrue);
                                ^^^^^^^^^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:210:31: Error: The method 'isChapterBeingProcessed' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'isChapterBeingProcessed'.
          expect(chapterManager.isChapterBeingProcessed(chapterUrl), isFalse);
                                ^^^^^^^^^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:304:31: Error: The method 'isChapterBeingProcessed' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'isChapterBeingProcessed'.
          expect(chapterManager.isChapterBeingProcessed(chapterUrl), isFalse);
                                ^^^^^^^^^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:332:31: Error: The method 'isChapterBeingProcessed' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'isChapterBeingProcessed'.
          expect(chapterManager.isChapterBeingProcessed(chapterUrl), isTrue);
                                ^^^^^^^^^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:353:31: Error: The method 'isChapterPreloading' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloading'.
          expect(chapterManager.isChapterPreloading(chapterUrl), isFalse);
                                ^^^^^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:356:46: Error: The method 'preloadChapter' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'preloadChapter'.
          final preloadFuture = chapterManager.preloadChapter(
                                               ^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:362:31: Error: The method 'isChapterPreloading' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloading'.
          expect(chapterManager.isChapterPreloading(chapterUrl), isTrue);
                                ^^^^^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:368:31: Error: The method 'isChapterPreloading' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloading'.
          expect(chapterManager.isChapterPreloading(chapterUrl), isFalse);
                                ^^^^^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:369:31: Error: The method 'isChapterPreloaded' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloaded'.
          expect(chapterManager.isChapterPreloaded(chapterUrl), isTrue);
                                ^^^^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:377:30: Error: The method 'preloadChapters' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'preloadChapters'.
          await chapterManager.preloadChapters(
                               ^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:384:37: Error: The method 'preloadChapters' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'preloadChapters'.
          expect(() => chapterManager.preloadChapters(
                                      ^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:409:30: Error: The method 'preloadChapters' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'preloadChapters'.
          await chapterManager.preloadChapters(
                               ^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:428:30: Error: The method 'preloadChapter' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'preloadChapter'.
          await chapterManager.preloadChapter(
                               ^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:437:31: Error: The method 'isChapterPreloaded' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'isChapterPreloaded'.
          expect(chapterManager.isChapterPreloaded(chapterUrl1), isFalse);
                                ^^^^^^^^^^^^^^^^^^
  test/unit/chapter_manager_test.dart:462:30: Error: The method 'preloadChapters' isn't defined for the type 'ChapterManager'.
   - 'ChapterManager' is from 'package:novel_app/services/chapter_manager.dart' ('lib/services/chapter_manager.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'preloadChapters'.
          await chapterManager.preloadChapters(
                               ^^^^^^^^^^^^^^^
  .
00:02 +18 -8: D:/myspace/novel_builder/novel_app/test/unit/controllers/bookshelf_manager_test.dart: BookshelfManager isInBookshelf should call database
00:02 +19 -8: D:/myspace/novel_builder/novel_app/test/unit/controllers/bookshelf_manager_test.dart: BookshelfManager addToBookshelf should call database
00:02 +20 -8: D:/myspace/novel_builder/novel_app/test/unit/controllers/bookshelf_manager_test.dart: BookshelfManager removeFromBookshelf should call database
00:02 +21 -8: D:/myspace/novel_builder/novel_app/test/unit/controllers/bookshelf_manager_test.dart: BookshelfManager clearNovelCache should call database
00:02 +22 -8: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_action_handler_test.dart: ChapterActionHandler insertChapter should call database
00:02 +23 -8: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_action_handler_test.dart: ChapterActionHandler deleteChapter should call database
00:02 +24 -8: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_action_handler_test.dart: ChapterActionHandler isChapterCached should call database
00:02 +25 -8: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_action_handler_test.dart: ChapterActionHandler getPreviousChaptersContent should return chapters
00:02 +25 -9: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_action_handler_test.dart: ChapterActionHandler getPreviousChaptersContent should return chapters [E]
  Bad state: databaseFactory not initialized
  databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
  You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API
  
  package:sqflite_common/src/sqflite_database_factory.dart 32:7                 databaseFactory.<fn>
  package:sqflite_common/src/sqflite_database_factory.dart 36:6                 databaseFactory
  package:sqflite_common/sqflite.dart 109:38                                    getDatabasesPath
  package:novel_app/services/database_service.dart 51:32                        DatabaseService._initDatabase
  package:novel_app/services/database_service.dart 42:23                        DatabaseService.database
  package:novel_app/services/database_service.dart 762:22                       DatabaseService.getCachedChapter
  package:novel_app/services/chapter_service.dart 97:46                         ChapterService.getPreviousChaptersContent
  package:novel_app/controllers/chapter_list/chapter_action_handler.dart 49:34  ChapterActionHandler.getPreviousChaptersContent
  test\unit\controllers\chapter_action_handler_test.dart 62:36                  main.<fn>.<fn>
  
00:03 +25 -9: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_loader_test.dart: ChapterLoader initApi should call ApiServiceProvider initialize
00:03 +26 -9: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_loader_test.dart: ChapterLoader loadChapters with cache should return cached chapters
00:03 +27 -9: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_loader_test.dart: ChapterLoader loadChapters with empty cache should return empty list
00:03 +28 -9: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_loader_test.dart: ChapterLoader refreshFromBackend should call API and save to database
00:03 +29 -9: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_loader_test.dart: ChapterLoader loadLastReadChapter should return chapter index
00:03 +30 -9: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_loader_test.dart: ChapterLoader loadLastReadChapter should return 0 for new novel
00:03 +31 -9: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_reorder_controller_test.dart: ChapterReorderController onReorder should move chapter forward
00:03 +32 -9: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_reorder_controller_test.dart: ChapterReorderController onReorder should move chapter backward
00:03 +33 -9: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_reorder_controller_test.dart: ChapterReorderController onReorder should handle adjacent indices
00:03 +34 -9: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_reorder_controller_test.dart: ChapterReorderController saveReorderedChapters should call database
00:03 +35 -9: D:/myspace/novel_builder/novel_app/test/unit/controllers/chapter_reorder_controller_test.dart: ChapterReorderController saveReorderedChapters should handle errors
00:03 +36 -9: D:/myspace/novel_builder/novel_app/test/unit/dify_response_to_replace_test.dart: Dify返回内容后的替换逻辑测试 完整流程：Dify返回内容 -> 点击替换 -> 执行删除插入
🗑️ 删除段落 3: "第四段..."
🗑️ 删除段落 2: "第三段..."
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 3 段内容
✅ 完整流程测试通过：Dify返回 -> 替换 -> 新内容生成
00:03 +37 -9: D:/myspace/novel_builder/novel_app/test/unit/dify_response_to_replace_test.dart: Dify返回内容后的替换逻辑测试 场景：Dify返回更多段落
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 5 段内容
✅ Dify返回更多段落测试通过
00:03 +38 -9: D:/myspace/novel_builder/novel_app/test/unit/dify_response_to_replace_test.dart: Dify返回内容后的替换逻辑测试 场景：Dify返回更少段落
🗑️ 删除段落 3: "第四段..."
🗑️ 删除段落 2: "第三段..."
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 1 段内容
✅ Dify返回更少段落测试通过
00:03 +39 -9: D:/myspace/novel_builder/novel_app/test/unit/dify_response_to_replace_test.dart: Dify返回内容后的替换逻辑测试 场景：Dify返回空内容
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 1 段内容
✅ Dify返回空内容测试通过
00:03 +40 -9: D:/myspace/novel_builder/novel_app/test/unit/dify_response_to_replace_test.dart: Dify返回内容后的替换逻辑测试 场景：Dify返回相同数量段落
🗑️ 删除段落 3: "第四段..."
🗑️ 删除段落 2: "第三段..."
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 3 段内容
✅ Dify返回相同数量测试通过
00:03 +41 -9: D:/myspace/novel_builder/novel_app/test/unit/dify_response_to_replace_test.dart: Dify返回内容后的替换逻辑测试 边界：Dify返回包含空行
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 3 段内容
✅ Dify返回包含空行测试通过
00:03 +42 -9: D:/myspace/novel_builder/novel_app/test/unit/dify_response_to_replace_test.dart: Dify返回内容后的替换逻辑测试 边界：Dify返回内容有首尾空格
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 1 段内容
✅ Dify返回内容有首尾空格测试通过
00:03 +43 -9: D:/myspace/novel_builder/novel_app/test/unit/dify_response_to_replace_test.dart: Dify返回内容后的替换逻辑测试 数据验证：替换前后内容完整性
🗑️ 删除段落 3: "D段..."
🗑️ 删除段落 1: "B段..."
✅ 在位置 1 插入 2 段内容
✅ 数据完整性验证通过
00:03 +44 -9: D:/myspace/novel_builder/novel_app/test/unit/dify_response_to_replace_test.dart: Dify返回内容后的替换逻辑测试 性能：大章节内容替换
🗑️ 删除段落 14: "第15段..."
🗑️ 删除段落 13: "第14段..."
🗑️ 删除段落 12: "第13段..."
🗑️ 删除段落 11: "第12段..."
🗑️ 删除段落 10: "第11段..."
✅ 在位置 10 插入 3 段内容
✅ 大章节性能测试通过: 0ms
00:03 +45 -9: D:/myspace/novel_builder/novel_app/test/unit/dify_response_to_replace_test.dart: 特殊情况处理 特殊情况：选中包含空行的段落
🗑️ 删除段落 1: "..."
✅ 在位置 1 插入 1 段内容
✅ 选中空行段落测试通过
00:03 +46 -9: D:/myspace/novel_builder/novel_app/test/unit/dify_response_to_replace_test.dart: 特殊情况处理 特殊情况：Dify返回只有空格
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 1 段内容
✅ Dify返回只有空格测试通过
00:03 +47 -9: D:/myspace/novel_builder/novel_app/test/unit/dify_response_to_replace_test.dart: 日志验证测试 验证：替换过程的日志输出
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 1 段内容
✅ 日志验证测试通过
00:03 +48 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 构造函数和默认值 应该默认isAccompanied为false
00:03 +49 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 构造函数和默认值 应该可以显式设置isAccompanied为true
00:03 +50 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 构造函数和默认值 应该可以显式设置isAccompanied为false
00:03 +51 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 toMap - 序列化测试 应该正确序列化isAccompanied=true
00:03 +52 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 toMap - 序列化测试 应该正确序列化isAccompanied=false
00:03 +53 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 toMap - 序列化测试 应该保留其他字段
00:03 +54 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 fromMap - 反序列化测试 应该正确反序列化isAccompanied=1
00:03 +55 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 fromMap - 反序列化测试 应该正确反序列化isAccompanied=0
00:03 +56 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 fromMap - 反序列化测试 应该处理isAccompanied为null的情况
00:03 +57 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 fromMap - 反序列化测试 应该正确反序列化所有字段
00:03 +58 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 copyWith - 复制方法测试 应该保留原有的isAccompanied值
00:03 +59 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 copyWith - 复制方法测试 应该可以修改isAccompanied为true
00:03 +60 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 copyWith - 复制方法测试 应该可以修改isAccompanied为false
00:03 +61 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 copyWith - 复制方法测试 应该可以同时修改isAccompanied和其他字段
00:03 +62 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 copyWith - 复制方法测试 应该正确处理null参数（保持原值）
00:03 +63 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 序列化/反序列化往返测试 toMap -> fromMap应该保持isAccompanied=true
00:03 +64 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 序列化/反序列化往返测试 toMap -> fromMap应该保持isAccompanied=false
00:03 +65 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 序列化/反序列化往返测试 多次往返应该保持一致性
00:03 +66 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 边界情况测试 空URL应该也能正常工作
00:03 +67 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 边界情况测试 特殊字符应该正常处理
00:03 +68 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 边界情况测试 大量数据应该正确序列化
00:03 +69 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 兼容性测试 应该兼容旧数据（没有isAccompanied字段）
00:03 +70 -9: D:/myspace/novel_builder/novel_app/test/unit/models/chapter_ai_accompaniment_test.dart: Chapter模型 - AI伴读字段测试 兼容性测试 新数据序列化后应该包含isAccompanied字段
00:03 +71 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 构造函数和默认值 应该正确创建包含所有字段的实例
00:03 +72 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 构造函数和默认值 当id为null时表示新增关系
00:03 +73 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 构造函数和默认值 未指定createdAt时默认为当前时间
00:03 +74 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 构造函数和默认值 updatedAt可以为null
00:03 +75 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 序列化/反序列化 toMap应该正确转换所有字段
00:03 +76 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 序列化/反序列化 fromMap应该正确解析所有字段
00:03 +77 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 序列化/反序列化 应该正确处理DateTime与毫秒时间戳的转换
00:03 +78 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 序列化/反序列化 应该正确处理null字段（description和updatedAt）
00:03 +79 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - copyWith方法 应该能够更新所有字段
00:03 +80 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - copyWith方法 应该能够部分更新字段
00:03 +81 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - copyWith方法 updatedAt应该自动更新为当前时间
00:03 +82 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - copyWith方法 不传参数时应该保留原值（除updatedAt自动更新）
00:03 +83 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - isSameRelationship方法 相同id应该返回true
00:03 +84 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - isSameRelationship方法 不同id应该返回false
00:03 +85 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - isSameRelationship方法 id都为null时应该返回false
00:03 +86 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - isSameRelationship方法 一个id为null另一个不为null应该返回false
00:03 +87 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - getReverseTypeHint方法 "师父"应该推断为"徒弟"
00:03 +88 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - getReverseTypeHint方法 "徒弟"应该推断为"师父"
00:03 +89 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - getReverseTypeHint方法 "老师"应该推断为"学生"
00:03 +90 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - getReverseTypeHint方法 "学生"应该推断为"师父"
00:03 +91 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - getReverseTypeHint方法 应该正确替换"父"为"子"
00:03 +92 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - getReverseTypeHint方法 应该正确替换"母"为"女"
00:03 +93 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - getReverseTypeHint方法 应该正确替换"夫"为"妻"
00:03 +94 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - getReverseTypeHint方法 应该正确替换"妻"为"夫"
00:03 +95 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - getReverseTypeHint方法 应该正确替换"兄"为"弟"
00:03 +96 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - getReverseTypeHint方法 应该正确替换"姐"为"妹"
00:03 +97 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - getReverseTypeHint方法 无法推断的关系类型应该返回原类型
00:03 +98 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - getReverseTypeHint方法 空字符串应该返回空字符串
00:03 +99 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - getReverseTypeHint方法 大小写混合的关系类型应该无法推断
00:03 +100 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - toString方法 toString应该包含关键信息
00:03 +101 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - toString方法 id为null时应该正确显示
00:03 +102 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 相等性和哈希码 相同对象应该相等
00:03 +103 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 相等性和哈希码 相同字段的不同对象应该相等
00:04 +104 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 相等性和哈希码 不同对象应该不相等
00:04 +105 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 相等性和哈希码 sourceCharacterId不同应该不相等
00:04 +106 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 相等性和哈希码 targetCharacterId不同应该不相等
00:04 +107 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 相等性和哈希码 relationshipType不同应该不相等
00:04 +108 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 相等性和哈希码 相等对象应该有相同的hashCode
00:04 +109 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 相等性和哈希码 不相等对象应该有不同的hashCode（大概率）
00:04 +110 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 边界条件 应该处理自循环关系（source=target）
00:04 +111 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 边界条件 应该处理空字符串字段
00:04 +112 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 边界条件 应该处理长文本字段
00:04 +113 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_relationship_test.dart: CharacterRelationship - 边界条件 应该处理特殊字符关系类型
00:04 +114 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_update_test.dart: CharacterUpdate 应该正确识别新增角色
00:04 +115 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_update_test.dart: CharacterUpdate 应该正确识别更新角色
00:04 +116 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_update_test.dart: CharacterUpdate 应该正确检测年龄字段变化
00:04 +117 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_update_test.dart: CharacterUpdate 应该正确检测多个字段变化
00:04 +118 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_update_test.dart: CharacterUpdate 应该正确处理null值变化(新增字段)
00:04 +119 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_update_test.dart: CharacterUpdate 应该正确处理字段删除(新值为null)
00:04 +120 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_update_test.dart: CharacterUpdate 无变化时应返回空差异列表
00:04 +121 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_update_test.dart: CharacterUpdate 应该正确对比所有字段类型
00:04 +122 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_update_test.dart: FieldDiff hasChanged应该在值不同时返回true
00:04 +123 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_update_test.dart: FieldDiff hasChanged应该在值相同时返回false
00:04 +124 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_update_test.dart: FieldDiff isNewField应该在旧值为null时返回true
00:04 +125 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_update_test.dart: FieldDiff isDeletedField应该在新值为null时返回true
00:04 +126 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_update_test.dart: FieldDiff 应该正确处理两端都为null的情况
00:04 +127 -9: D:/myspace/novel_builder/novel_app/test/unit/models/character_update_test.dart: FieldDiff 应该正确处理只有一端为null的情况
00:04 +128 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress 应该正确创建进度对象
00:04 +129 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress positionText应该返回正确的格式
00:04 +130 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress 未过期的进度应该返回false
00:04 +131 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress 超过7天的进度应该过期
00:04 +132 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress 自定义过期天数应该正常工作
00:04 +133 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress copyWith应该正确复制并修改字段
00:04 +134 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress toJson应该返回正确的JSON格式
00:04 +135 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress fromJson应该正确解析JSON
00:04 +136 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress toJsonString应该返回有效的JSON字符串
00:04 +137 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress fromJsonString应该正确解析JSON字符串
00:04 +138 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress fromJsonString对null输入应该返回null
00:04 +139 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress fromJsonString对空字符串应该返回null
00:04 +140 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress fromJsonString对无效JSON应该返回null
00:04 +141 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress 相等性比较应该正常工作
00:04 +142 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress hashCode应该基于关键字段
00:04 +143 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress toString应该返回有用的描述
00:04 +144 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress - 边界情况 paragraphIndex为0时应该显示第1段
00:04 +145 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress - 边界情况 最小语速和音调值
00:04 +146 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress - 边界情况 最大语速和音调值
00:04 +147 -9: D:/myspace/novel_builder/novel_app/test/unit/models/reading_progress_test.dart: ReadingProgress - 边界情况 刚创建的进度不应该过期
00:04 +148 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: 段落替换逻辑核心测试 基础替换：删除选中段落并插入新内容
🗑️ 删除段落 3: "第四段..."
🗑️ 删除段落 2: "第三段..."
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 5 段内容
00:04 +149 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: 段落替换逻辑核心测试 AI生成更少段落
🗑️ 删除段落 3: "第四段..."
🗑️ 删除段落 2: "第三段..."
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 2 段内容
00:04 +150 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: 段落替换逻辑核心测试 AI生成相同数量段落
🗑️ 删除段落 3: "第四段..."
🗑️ 删除段落 2: "第三段..."
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 3 段内容
00:04 +151 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: 段落替换逻辑核心测试 空内容处理：AI生成空数组
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 0 段内容
00:04 +152 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: 段落替换逻辑核心测试 边界情况：索引越界保护
🗑️ 删除段落 1: "第二段..."
🗑️ 删除段落 0: "第一段..."
✅ 在位置 0 插入 1 段内容
00:04 +153 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: 段落替换逻辑核心测试 边界情况：所有索引都无效
⚠️ ParagraphReplaceHelper: 所有索引都无效
00:04 +154 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: 段落替换逻辑核心测试 特殊情况：选中不连续段落
🗑️ 删除段落 5: "第六段..."
🗑️ 删除段落 3: "第四段..."
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 3 段内容
00:04 +155 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: 段落替换逻辑核心测试 数据验证：替换后完整性检查
🗑️ 删除段落 3: "第四段..."
🗑️ 删除段落 2: "第三段..."
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 2 段内容
00:04 +156 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: 段落替换逻辑核心测试 边界情况：只选一段
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 1 段内容
00:04 +157 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: 段落替换逻辑核心测试 边界情况：选中所有段落
🗑️ 删除段落 2: "第三段..."
🗑️ 删除段落 1: "第二段..."
🗑️ 删除段落 0: "第一段..."
✅ 在位置 0 插入 4 段内容
00:04 +158 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: 段落替换逻辑核心测试 边界情况：选中第一段
🗑️ 删除段落 0: "第一段..."
✅ 在位置 0 插入 2 段内容
00:04 +159 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: 段落替换逻辑核心测试 边界情况：选中最后一段
🗑️ 删除段落 3: "第四段..."
✅ 在位置 3 插入 1 段内容
00:04 +160 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: ParagraphReplaceHelper 工具方法测试 executeReplaceAndJoin - 便捷方法
🗑️ 删除段落 1: "第二段..."
✅ 在位置 1 插入 1 段内容
00:04 +161 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: ParagraphReplaceHelper 工具方法测试 filterValidIndices - 过滤有效索引
00:04 +162 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: ParagraphReplaceHelper 工具方法测试 calculateNewLength - 计算新长度
00:04 +163 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: ParagraphReplaceHelper 工具方法测试 validateReplacement - 验证替换完整性
00:04 +164 -9: D:/myspace/novel_builder/novel_app/test/unit/paragraph_replace_logic_test.dart: ParagraphReplaceHelper 工具方法测试 validateReplacement - 检测内容丢失
00:04 +165 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: (setUpAll)
00:04 +165 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
✅ PreloadService初始化完成
🔄 速率限制器已重置
🧹 预加载队列已清空
📚 小说活跃: 测试小说 (第1章)
📚 小说活跃: 测试小说 (第2章)
📚 小说活跃: 测试小说 (第3章)
📚 小说活跃: 测试小说 (第4章)
📚 小说活跃: 测试小说 (第5章)
📚 小说活跃: 测试小说 (第6章)
📚 小说活跃: 测试小说 (第7章)
📚 小说活跃: 测试小说 (第8章)
📚 小说活跃: 测试小说 (第9章)
📚 小说活跃: 测试小说 (第10章)
📋 待缓存章节数: 100
📥 任务入队: 99 个 (队列长度: 99)
📊 队列状态 (共99个任务):
   1. 测试小说 第100章
   2. 测试小说 第99章
   3. 测试小说 第98章
   4. 测试小说 第97章
   5. 测试小说 第96章
   ... 还有 94 个任务
🚀 开始处理预加载队列
📋 待缓存章节数: 100
📥 任务入队: 1 个 (队列长度: 100)
📊 队列状态 (共100个任务):
   1. 测试小说 第1章
   2. 测试小说 第100章
   3. 测试小说 第99章
   4. 测试小说 第98章
   5. 测试小说 第97章
   ... 还有 95 个任务
⚠️ 队列处理中，跳过重复启动
📋 待缓存章节数: 100
⏭️ 所有任务已在队列中
📋 待缓存章节数: 100
⏭️ 所有任务已在队列中
📋 待缓存章节数: 100
⏭️ 所有任务已在队列中
📋 待缓存章节数: 100
⏭️ 所有任务已在队列中
📋 待缓存章节数: 100
⏭️ 所有任务已在队列中
📋 待缓存章节数: 100
⏭️ 所有任务已在队列中
📋 待缓存章节数: 100
⏭️ 所有任务已在队列中
📋 待缓存章节数: 100
⏭️ 所有任务已在队列中
📖 [队列99] 正在处理: 测试小说 第1章
🆕 发起章节请求: https://example.com/chapter-0
00:05 +166 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +167 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +168 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +169 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +170 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +171 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +172 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +173 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +174 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +175 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +176 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +177 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +178 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +179 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +180 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:05 +181 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +182 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +183 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +184 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +185 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +186 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +187 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +188 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +189 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +190 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +191 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +192 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +193 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +194 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +195 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +196 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +197 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +197 -9: D:/myspace/novel_builder/novel_app/test/unit/screens/character_management_screen_test.dart: CharacterManagementScreen - 关系图入口功能 测试1: 非多选模式下应显示关系图按钮
❌ 加载角色失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载大纲失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

00:06 +198 -9: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +198 -9: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试1: 新建模式下UI应包含生成提示词按钮
加载模型列表失败: Exception: ApiServiceWrapper 未初始化，请先调用 init()
Pending timers:
Timer (duration: 0:01:00.000000, periodic: true), created:
#0      new FakeTimer._ (package:fake_async/fake_async.dart:342:62)
#1      FakeAsync._createTimer (package:fake_async/fake_async.dart:260:29)
#2      FakeAsync.run.<anonymous closure> (package:fake_async/fake_async.dart:187:15)
#5      ChapterManager._initializeCleanupTimer (package:novel_app/services/chapter_manager.dart:152:27)
#6      new ChapterManager._internal (package:novel_app/services/chapter_manager.dart:19:5)
#7      ChapterManager._instance (package:novel_app/services/chapter_manager.dart:16:58)
#8      ChapterManager._instance (package:novel_app/services/chapter_manager.dart)
#9      new ChapterManager (package:novel_app/services/chapter_manager.dart:17:31)
#10     new ApiServiceWrapper._internal (package:novel_app/services/api_service_wrapper.dart:39:42)
#11     ApiServiceWrapper._instance (package:novel_app/services/api_service_wrapper.dart:30:64)
#12     ApiServiceWrapper._instance (package:novel_app/services/api_service_wrapper.dart)
#13     new ApiServiceWrapper (package:novel_app/services/api_service_wrapper.dart:31:34)
#14     ApiServiceProvider.instance (package:novel_app/core/di/api_service_provider.dart:10:19)
#15     new _CharacterEditScreenState (package:novel_app/screens/character_edit_screen.dart:36:60)
#16     CharacterEditScreen.createState (package:novel_app/screens/character_edit_screen.dart:31:47)
#17     new StatefulElement (package:flutter/src/widgets/framework.dart:5804:60)
#18     StatefulWidget.createElement (package:flutter/src/widgets/framework.dart:779:38)
...     Normal element mounting (228 frames)
#246    Element.inflateWidget (package:flutter/src/widgets/framework.dart:4548:16)
#247    MultiChildRenderObjectElement.inflateWidget (package:flutter/src/widgets/framework.dart:7169:36)
#248    MultiChildRenderObjectElement.mount (package:flutter/src/widgets/framework.dart:7185:32)
...     Normal element mounting (465 frames)
#713    Element.inflateWidget (package:flutter/src/widgets/framework.dart:4548:16)
#714    Element.updateChild (package:flutter/src/widgets/framework.dart:3998:20)
#715    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#716    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#717    ProxyElement.update (package:flutter/src/widgets/framework.dart:6051:5)
#718    _InheritedNotifierElement.update (package:flutter/src/widgets/inherited_notifier.dart:108:11)
#719    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#720    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#721    StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5884:11)
#722    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#723    StatefulElement.update (package:flutter/src/widgets/framework.dart:5909:5)
#724    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#725    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#726    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#727    ProxyElement.update (package:flutter/src/widgets/framework.dart:6051:5)
#728    _InheritedNotifierElement.update (package:flutter/src/widgets/inherited_notifier.dart:108:11)
#729    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#730    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#731    StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5884:11)
#732    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#733    StatefulElement.update (package:flutter/src/widgets/framework.dart:5909:5)
#734    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#735    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#736    StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5884:11)
#737    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#738    StatefulElement.update (package:flutter/src/widgets/framework.dart:5909:5)
#739    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#740    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#741    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#742    ProxyElement.update (package:flutter/src/widgets/framework.dart:6051:5)
#743    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#744    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#745    StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5884:11)
#746    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#747    StatefulElement.update (package:flutter/src/widgets/framework.dart:5909:5)
#748    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#749    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#750    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#751    ProxyElement.update (package:flutter/src/widgets/framework.dart:6051:5)
#752    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#753    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#754    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#755    ProxyElement.update (package:flutter/src/widgets/framework.dart:6051:5)
#756    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#757    _RawViewElement._updateChild (package:flutter/src/widgets/view.dart:481:16)
#758    _RawViewElement.update (package:flutter/src/widgets/view.dart:568:5)
#759    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#760    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#761    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#762    StatelessElement.update (package:flutter/src/widgets/framework.dart:5797:5)
#763    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#764    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#765    StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5884:11)
#766    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#767    StatefulElement.update (package:flutter/src/widgets/framework.dart:5909:5)
#768    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#769    RootElement._rebuild (package:flutter/src/widgets/binding.dart:1716:16)
#770    RootElement.update (package:flutter/src/widgets/binding.dart:1694:5)
#771    RootElement.performRebuild (package:flutter/src/widgets/binding.dart:1708:7)
#772    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#773    BuildScope._tryRebuild (package:flutter/src/widgets/framework.dart:2695:15)
#774    BuildScope._flushDirtyElements (package:flutter/src/widgets/framework.dart:2752:11)
#775    BuildOwner.buildScope (package:flutter/src/widgets/framework.dart:3056:18)
#776    AutomatedTestWidgetsFlutterBinding.drawFrame (package:flutter_test/src/binding.dart:1506:19)
#777    RendererBinding._handlePersistentFrameCallback (package:flutter/src/rendering/binding.dart:495:5)
#778    SchedulerBinding._invokeFrameCallback (package:flutter/src/scheduler/binding.dart:1434:15)
#779    SchedulerBinding.handleDrawFrame (package:flutter/src/scheduler/binding.dart:1347:9)
#780    AutomatedTestWidgetsFlutterBinding.pump.<anonymous closure> (package:flutter_test/src/binding.dart:1335:9)
#783    TestAsyncUtils.guard (package:flutter_test/src/test_async_utils.dart:74:41)
#784    AutomatedTestWidgetsFlutterBinding.pump (package:flutter_test/src/binding.dart:1324:27)
#785    WidgetTester.pumpWidget.<anonymous closure> (package:flutter_test/src/widget_tester.dart:598:22)
#788    TestAsyncUtils.guard (package:flutter_test/src/test_async_utils.dart:74:41)
#789    WidgetTester.pumpWidget (package:flutter_test/src/widget_tester.dart:595:27)
#790    main.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart:59:20)
#791    testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:29)
<asynchronous suspension>
#792    TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided 7 frames from dart:async and package:stack_trace)

══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following assertion was thrown running a test:
A Timer is still pending even after the widget tree was disposed.
'package:flutter_test/src/binding.dart':
Failed assertion: line 1617 pos 12: '!timersPending'

When the exception was thrown, this was the stack:
#2      AutomatedTestWidgetsFlutterBinding._verifyInvariants (package:flutter_test/src/binding.dart:1617:12)
#3      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1078:7)
<asynchronous suspension>
<asynchronous suspension>
(elided 3 frames from class _AssertionError and package:stack_trace)

The test description was:
  测试1: 新建模式下UI应包含生成提示词按钮
════════════════════════════════════════════════════════════════════════════════════════════════════
00:06 +198 -10: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +198 -10: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试1: 新建模式下UI应包含生成提示词按钮 [E]
  Test failed. See exception logs above.
  The test description was: 测试1: 新建模式下UI应包含生成提示词按钮
  
test/unit/services/api_service_wrapper_test.dart:20:8: Error: Error when reading 'test/unit/services/api_service_wrapper_test.mocks.dart': 系统找不到指定的文件。

import 'api_service_wrapper_test.mocks.dart';
       ^
test/unit/services/api_service_wrapper_test.dart:70:33: Error: The method 'checkImageToVideoHealth' isn't defined for the type 'ApiServiceWrapper'.
 - 'ApiServiceWrapper' is from 'package:novel_app/services/api_service_wrapper.dart' ('lib/services/api_service_wrapper.dart').
Try correcting the name to the name of an existing method, or defining a method named 'checkImageToVideoHealth'.
        expect(() => apiWrapper.checkImageToVideoHealth(), returnsNormally);
                                ^^^^^^^^^^^^^^^^^^^^^^^
00:06 +198 -10: D:/myspace/novel_builder/novel_app/test/unit/screens/character_management_screen_test.dart: CharacterManagementScreen - 关系图入口功能 测试2: 点击关系图按钮应触发导航
❌ 加载角色失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载大纲失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

00:06 +199 -10: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +199 -10: loading D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart
✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:06 +199 -11: loading D:/myspace/novel_builder/novel_app/test/unit/services/api_service_wrapper_test.dart [E]
  Failed to load "D:/myspace/novel_builder/novel_app/test/unit/services/api_service_wrapper_test.dart":
  Compilation failed for testPath=D:/myspace/novel_builder/novel_app/test/unit/services/api_service_wrapper_test.dart: test/unit/services/api_service_wrapper_test.dart:20:8: Error: Error when reading 'test/unit/services/api_service_wrapper_test.mocks.dart': 系统找不到指定的文件。
  
  import 'api_service_wrapper_test.mocks.dart';
         ^
  test/unit/services/api_service_wrapper_test.dart:70:33: Error: The method 'checkImageToVideoHealth' isn't defined for the type 'ApiServiceWrapper'.
   - 'ApiServiceWrapper' is from 'package:novel_app/services/api_service_wrapper.dart' ('lib/services/api_service_wrapper.dart').
  Try correcting the name to the name of an existing method, or defining a method named 'checkImageToVideoHealth'.
          expect(() => apiWrapper.checkImageToVideoHealth(), returnsNormally);
                                  ^^^^^^^^^^^^^^^^^^^^^^^
  .
00:06 +199 -11: D:/myspace/novel_builder/novel_app/test/unit/screens/character_management_screen_test.dart: CharacterManagementScreen - 关系图入口功能 测试3: 多选模式下不应显示关系图按钮
❌ 加载角色失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载大纲失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

00:06 +200 -11: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +200 -11: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 appendBackgroundSetting - 背景设定追加 应该成功追加背景设定到空背景
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:06 +200 -11: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
❌ 网络请求失败: https://example.com/chapter-0, 错误: Exception: 未知错误: Exception: 连接重新初始化失败: Binding has not yet been initialized.
The "instance" getter on the ServicesBinding binding mixin is only available once that binding has been initialized.
Typically, this is done by calling "WidgetsFlutterBinding.ensureInitialized()" or "runApp()" (the latter calls the former). Typically this call is done in the "void main()" method. The "ensureInitialized" method is idempotent; calling it multiple times is not harmful. After calling that method, the "instance" getter will return the binding.
In a test, one can call "TestWidgetsFlutterBinding.ensureInitialized()" as the first line in the test's "main()" method to initialize the binding.
If ServicesBinding is a custom binding mixin, there must also be a custom binding class, like WidgetsFlutterBinding, but that mixes in the selected binding, and that is the class that must be constructed before using the "instance" getter.
❌ 章节请求失败: https://example.com/chapter-0, 错误: Exception: 未知错误: Exception: 连接重新初始化失败: Binding has not yet been initialized.
The "instance" getter on the ServicesBinding binding mixin is only available once that binding has been initialized.
Typically, this is done by calling "WidgetsFlutterBinding.ensureInitialized()" or "runApp()" (the latter calls the former). Typically this call is done in the "void main()" method. The "ensureInitialized" method is idempotent; calling it multiple times is not harmful. After calling that method, the "instance" getter will return the binding.
In a test, one can call "TestWidgetsFlutterBinding.ensureInitialized()" as the first line in the test's "main()" method to initialize the binding.
If ServicesBinding is a custom binding mixin, there must also be a custom binding class, like WidgetsFlutterBinding, but that mixes in the selected binding, and that is the class that must be constructed before using the "instance" getter.
❌ 缓存失败: 测试小说 第1章, 错误: Exception: 未知错误: Exception: 连接重新初始化失败: Binding has not yet been initialized.
The "instance" getter on the ServicesBinding binding mixin is only available once that binding has been initialized.
Typically, this is done by calling "WidgetsFlutterBinding.ensureInitialized()" or "runApp()" (the latter calls the former). Typically this call is done in the "void main()" method. The "ensureInitialized" method is idempotent; calling it multiple times is not harmful. After calling that method, the "instance" getter will return the binding.
In a test, one can call "TestWidgetsFlutterBinding.ensureInitialized()" as the first line in the test's "main()" method to initialize the binding.
If ServicesBinding is a custom binding mixin, there must also be a custom binding class, like WidgetsFlutterBinding, but that mixes in the selected binding, and that is the class that must be constructed before using the "instance" getter.
⏳ 速率限制: 等待 28 秒
00:06 +200 -11: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 appendBackgroundSetting - 背景设定追加 应该成功追加背景设定到空背景
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:06 +200 -11: D:/myspace/novel_builder/novel_app/test/unit/screens/character_management_screen_test.dart: CharacterManagementScreen - 关系图入口功能 测试4: 关系图按钮应该与AI创建按钮同时显示
❌ 加载角色失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载大纲失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

00:06 +201 -11: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +202 -11: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +202 -11: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 appendBackgroundSetting - 背景设定追加 应该正确追加背景设定到已有背景
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:06 +202 -11: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试2: 编辑模式下UI应包含生成提示词按钮
❌ 获取角色头像路径失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载模型列表失败: Exception: ApiServiceWrapper 未初始化，请先调用 init()
00:06 +203 -11: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +204 -11: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +204 -11: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 appendBackgroundSetting - 背景设定追加 应该忽略空的背景设定追加
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:06 +204 -11: D:/myspace/novel_builder/novel_app/test/unit/screens/character_management_screen_test.dart: CharacterManagementScreen - 关系图入口功能 测试5: 验证导航时传递正确的novelUrl参数
❌ 加载角色失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载大纲失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

00:06 +205 -11: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +205 -11: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 appendBackgroundSetting - 背景设定追加 应该忽略空的背景设定追加
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:06 +205 -11: loading D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart
✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:06 +206 -11: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +206 -11: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 appendBackgroundSetting - 背景设定追加 应该忽略只有空白字符的背景设定追加
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:06 +206 -11: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 isChapterAccompanied - 检查章节伴读状态 应该返回false对于不存在的章节
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
00:06 +206 -11: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 appendBackgroundSetting - 背景设定追加 应该忽略只有空白字符的背景设定追加
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:06 +206 -11: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 isChapterAccompanied - 检查章节伴读状态 应该返回false对于不存在的章节
✅ 数据库测试环境初始化完成
00:06 +206 -11: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 appendBackgroundSetting - 背景设定追加 应该忽略只有空白字符的背景设定追加
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:06 +207 -11: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +207 -11: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 appendBackgroundSetting - 背景设定追加 应该对不存在的小说返回0
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:06 +207 -11: D:/myspace/novel_builder/novel_app/test/unit/screens/character_management_screen_test.dart: CharacterManagementScreen - UI布局验证 测试6: AppBar应该包含正确的标题
❌ 加载角色失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载大纲失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

00:06 +208 -11: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +208 -11: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 isChapterAccompanied - 检查章节伴读状态 应该返回false对于不存在的章节
error SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while selecting from statement, database is locked, database is locked (code 5)
  Causing statement: PRAGMA user_version}) DatabaseException(SqliteException(5): while selecting from statement, database is locked, database is locked (code 5)
  Causing statement: PRAGMA user_version) sql 'PRAGMA user_version' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}} during open, closing...
00:06 +208 -11: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 appendBackgroundSetting - 背景设定追加 应该对不存在的小说返回0
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:06 +209 -11: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:06 +209 -11: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 多次追加背景设定 应该正确累积多次背景设定追加
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +210 -11: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:07 +210 -12: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:07 +210 -12: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 isChapterAccompanied - 检查章节伴读状态 应该返回false对于不存在的章节 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while selecting from statement, database is locked, database is locked (code 5)
    Causing statement: PRAGMA user_version}) DatabaseException(SqliteException(5): while selecting from statement, database is locked, database is locked (code 5)
    Causing statement: PRAGMA user_version) sql 'PRAGMA user_version' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +210 -12: D:/myspace/novel_builder/novel_app/test/unit/screens/character_management_screen_test.dart: CharacterManagementScreen - UI布局验证 测试7: 关系图按钮应该使用正确的图标
❌ 加载角色失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载大纲失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

00:07 +210 -12: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 多次追加背景设定 应该正确处理长文本背景追加
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

00:07 +211 -12: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:07 +211 -12: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 多次追加背景设定 应该正确处理长文本背景追加
✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:07 +211 -12: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 isChapterAccompanied - 检查章节伴读状态 应该返回false对于未伴读的章节
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
error SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while selecting from statement, database is locked, database is locked (code 5)
  Causing statement: PRAGMA user_version}) DatabaseException(SqliteException(5): while selecting from statement, database is locked, database is locked (code 5)
  Causing statement: PRAGMA user_version) sql 'PRAGMA user_version' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 2, readOnly: false, singleInstance: true}}} during open, closing...
00:07 +211 -13: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
00:07 +211 -13: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 isChapterAccompanied - 检查章节伴读状态 应该返回false对于未伴读的章节 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while selecting from statement, database is locked, database is locked (code 5)
    Causing statement: PRAGMA user_version}) DatabaseException(SqliteException(5): while selecting from statement, database is locked, database is locked (code 5)
    Causing statement: PRAGMA user_version) sql 'PRAGMA user_version' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 2, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +211 -13: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 isChapterAccompanied - 检查章节伴读状态 应该返回true对于已伴读的章节
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:07 +211 -13: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 多次追加背景设定 应该正确处理长文本背景追加
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +211 -13: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 快速连续调用 enqueueTasks() 不应产生并发
═══════════════════════════════════════
📊 并发测试结果:
   队列长度: 99
   是否处理中: true
   已处理: 0
   失败: 1
═══════════════════════════════════════
⚠️  如果 processed >= 2,可能存在并发问题
⚠️  当前 processed = 0
00:07 +212 -13: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试3: 编辑模式下提示词字段应显示现有值
00:07 +212 -13: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 验证单例模式
🔄 速率限制器已重置
🧹 预加载队列已清空
✅ 单例模式正常工作
00:07 +213 -13: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试3: 编辑模式下提示词字段应显示现有值
00:07 +213 -13: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 验证 Completer 锁的行为
🔄 速率限制器已重置
🧹 预加载队列已清空
📚 小说活跃: 测试小说1 (第1章)
📚 小说活跃: 测试小说1 (第2章)
00:07 +213 -13: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 isChapterAccompanied - 检查章节伴读状态 应该返回true对于已伴读的章节
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +213 -13: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试3: 编辑模式下提示词字段应显示现有值
❌ 获取角色头像路径失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载模型列表失败: Exception: ApiServiceWrapper 未初始化，请先调用 init()
00:07 +214 -13: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 多次追加背景设定 应该正确处理长文本背景追加
00:07 +214 -14: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 isChapterAccompanied - 检查章节伴读状态 应该返回true对于已伴读的章节
00:07 +214 -14: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 多次追加背景设定 应该正确处理长文本背景追加 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: UPDATE bookshelf SET backgroundSetting = ? WHERE url = ?, parameters: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, https://example.com/novel6}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: UPDATE bookshelf SET backgroundSetting = ? WHERE url = ?, parameters: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, https://example.com/novel6) sql 'UPDATE bookshelf SET backgroundSetting = ? WHERE url = ?' args [AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA..., https://example.com/novel6] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +215 -14: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 验证 Completer 锁的行为
00:07 +215 -14: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 模拟AI伴读响应数据更新 应该正确处理AI伴读返回的背景设定
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:07 +215 -14: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 isChapterAccompanied - 检查章节伴读状态 应该正确区分不同小说的章节
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:07 +215 -14: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 模拟AI伴读响应数据更新 应该正确处理AI伴读返回的背景设定
清理表 chapter_cache 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM chapter_cache, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM chapter_cache, parameters: ) sql 'DELETE FROM chapter_cache' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 novel_chapters 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM novel_chapters, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM novel_chapters, parameters: ) sql 'DELETE FROM novel_chapters' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +215 -14: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 isChapterAccompanied - 检查章节伴读状态 应该正确区分不同小说的章节
清理表 novel_chapters 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM novel_chapters, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM novel_chapters, parameters: ) sql 'DELETE FROM novel_chapters' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +215 -14: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 模拟AI伴读响应数据更新 应该正确处理AI伴读返回的背景设定
清理表 scene_illustrations 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM scene_illustrations, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM scene_illustrations, parameters: ) sql 'DELETE FROM scene_illustrations' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +215 -15: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +215 -15: D:/myspace/novel_builder/novel_app/test/unit/preload_service_race_condition_test.dart: PreloadService 并发安全测试 验证 Completer 锁的行为 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while selecting from statement, database is locked, database is locked (code 5)
    Causing statement: SELECT * FROM chapter_cache WHERE chapterUrl = ?, parameters: https://example.com/chapter1-0}) DatabaseException(SqliteException(5): while selecting from statement, database is locked, database is locked (code 5)
    Causing statement: SELECT * FROM chapter_cache WHERE chapterUrl = ?, parameters: https://example.com/chapter1-0) sql 'SELECT * FROM chapter_cache WHERE chapterUrl = ?' args [https://example.com/chapter1-0] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +215 -15: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 模拟AI伴读响应数据更新 应该正确处理AI伴读返回的背景设定
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +215 -15: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +215 -15: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 isChapterAccompanied - 检查章节伴读状态 应该正确区分不同小说的章节
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +215 -16: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +215 -16: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 模拟AI伴读响应数据更新 应该正确处理AI伴读返回的背景设定 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while selecting from statement, database is locked, database is locked (code 5)
    Causing statement: SELECT backgroundSetting FROM bookshelf WHERE url = ?, parameters: https://example.com/novel7}) DatabaseException(SqliteException(5): while selecting from statement, database is locked, database is locked (code 5)
    Causing statement: SELECT backgroundSetting FROM bookshelf WHERE url = ?, parameters: https://example.com/novel7) sql 'SELECT backgroundSetting FROM bookshelf WHERE url = ?' args [https://example.com/novel7] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +215 -16: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 模拟AI伴读响应数据更新 当AI返回空背景时不应该修改现有背景
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
清理表 bookshelf 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM bookshelf, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM bookshelf, parameters: ) sql 'DELETE FROM bookshelf' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +215 -17: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +215 -17: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 isChapterAccompanied - 检查章节伴读状态 应该正确区分不同小说的章节 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO chapter_cache (novelUrl, chapterUrl, title, content, chapterIndex, cachedAt, ai_accompanied) VALUES (?, ?, ?, ?, NULL, ?, ?), parameters: https://example.com/novel2, https://example.com/chapter2, 第一章, 内容2, 1769409913499, 0}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO chapter_cache (novelUrl, chapterUrl, title, content, chapterIndex, cachedAt, ai_accompanied) VALUES (?, ?, ?, ?, NULL, ?, ?), parameters: https://example.com/novel2, https://example.com/chapter2, 第一章, 内容2, 1769409913499, 0) sql 'INSERT OR REPLACE INTO chapter_cache (novelUrl, chapterUrl, title, content, chapterIndex, cachedAt, ai_accompanied) VALUES (?, ?, ?, ?, NULL, ?, ?)' args [https://example.com/novel2, https://example.com/chapter2, 第一章, 内容2, 1769409913499, 0] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +215 -17: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 markChapterAsAccompanied - 标记章节为已伴读 应该成功标记已缓存的章节
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:07 +215 -17: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 模拟AI伴读响应数据更新 当AI返回空背景时不应该修改现有背景
清理表 scene_illustrations 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM scene_illustrations, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM scene_illustrations, parameters: ) sql 'DELETE FROM scene_illustrations' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +215 -18: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +215 -18: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 模拟AI伴读响应数据更新 当AI返回空背景时不应该修改现有背景 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, ?, ?), parameters: 测试小说, 测试作者, https://example.com/novel8, 初始背景。, 1769409913533}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, ?, ?), parameters: 测试小说, 测试作者, https://example.com/novel8, 初始背景。, 1769409913533) sql 'INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, ?, ?)' args [测试小说, 测试作者, https://example.com/novel8, 初始背景。, 1769409913533] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +215 -18: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 模拟AI伴读响应数据更新 应该正确处理AI伴读的完整数据更新流程
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:07 +215 -18: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 markChapterAsAccompanied - 标记章节为已伴读 应该成功标记已缓存的章节
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +215 -19: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +215 -19: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 markChapterAsAccompanied - 标记章节为已伴读 应该成功标记已缓存的章节 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?), parameters: 测试小说, 测试作者, https://example.com/novel1, 1769409913562}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?), parameters: 测试小说, 测试作者, https://example.com/novel1, 1769409913562) sql 'INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?)' args [测试小说, 测试作者, https://example.com/novel1, 1769409913562] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +215 -19: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 markChapterAsAccompanied - 标记章节为已伴读 应该可以重复标记同一章节
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
清理表 bookshelf 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM bookshelf, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM bookshelf, parameters: ) sql 'DELETE FROM bookshelf' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 chapter_cache 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM chapter_cache, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM chapter_cache, parameters: ) sql 'DELETE FROM chapter_cache' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +215 -19: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 模拟AI伴读响应数据更新 应该正确处理AI伴读的完整数据更新流程
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +215 -19: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 markChapterAsAccompanied - 标记章节为已伴读 应该可以重复标记同一章节
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +215 -20: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +215 -20: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 模拟AI伴读响应数据更新 应该正确处理AI伴读的完整数据更新流程 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, ?, ?), parameters: 测试小说, 测试作者, https://example.com/novel9, 初始背景。, 1769409913611}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, ?, ?), parameters: 测试小说, 测试作者, https://example.com/novel9, 初始背景。, 1769409913611) sql 'INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, ?, ?)' args [测试小说, 测试作者, https://example.com/novel9, 初始背景。, 1769409913611] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +215 -20: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 markChapterAsAccompanied - 标记章节为已伴读 应该可以重复标记同一章节
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +215 -20: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 边界条件和异常情况 应该正确处理包含特殊字符的背景设定
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:07 +215 -21: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +215 -21: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 markChapterAsAccompanied - 标记章节为已伴读 应该可以重复标记同一章节 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO chapter_cache (novelUrl, chapterUrl, title, content, chapterIndex, cachedAt, ai_accompanied) VALUES (?, ?, ?, ?, NULL, ?, ?), parameters: https://example.com/novel1, https://example.com/chapter1, 第一章, 测试内容, 1769409913628, 0}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO chapter_cache (novelUrl, chapterUrl, title, content, chapterIndex, cachedAt, ai_accompanied) VALUES (?, ?, ?, ?, NULL, ?, ?), parameters: https://example.com/novel1, https://example.com/chapter1, 第一章, 测试内容, 1769409913628, 0) sql 'INSERT OR REPLACE INTO chapter_cache (novelUrl, chapterUrl, title, content, chapterIndex, cachedAt, ai_accompanied) VALUES (?, ?, ?, ?, NULL, ?, ?)' args [https://example.com/novel1, https://example.com/chapter1, 第一章, 测试内容, 1769409913628, 0] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +215 -21: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 resetChapterAccompaniedFlag - 重置章节伴读标记 应该成功重置已伴读的章节
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
清理表 bookshelf 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM bookshelf, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM bookshelf, parameters: ) sql 'DELETE FROM bookshelf' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 chapter_cache 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM chapter_cache, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM chapter_cache, parameters: ) sql 'DELETE FROM chapter_cache' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 novel_chapters 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM novel_chapters, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM novel_chapters, parameters: ) sql 'DELETE FROM novel_chapters' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +215 -21: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 边界条件和异常情况 应该正确处理包含特殊字符的背景设定
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +215 -21: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 resetChapterAccompaniedFlag - 重置章节伴读标记 应该成功重置已伴读的章节
清理表 characters 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM characters, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM characters, parameters: ) sql 'DELETE FROM characters' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +215 -21: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 边界条件和异常情况 应该正确处理包含特殊字符的背景设定
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +215 -21: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 resetChapterAccompaniedFlag - 重置章节伴读标记 应该成功重置已伴读的章节
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +215 -21: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 边界条件和异常情况 应该正确处理包含特殊字符的背景设定
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +215 -21: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 resetChapterAccompaniedFlag - 重置章节伴读标记 应该成功重置已伴读的章节
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +215 -21: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
加载模型列表失败: Exception: ApiServiceWrapper 未初始化，请先调用 init()
00:07 +215 -22: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +215 -22: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 resetChapterAccompaniedFlag - 重置章节伴读标记 应该成功重置已伴读的章节 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?), parameters: 测试小说, 测试作者, https://example.com/novel1, 1769409913676}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?), parameters: 测试小说, 测试作者, https://example.com/novel1, 1769409913676) sql 'INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?)' args [测试小说, 测试作者, https://example.com/novel1, 1769409913676] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +216 -22: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +216 -22: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 resetChapterAccompaniedFlag - 重置章节伴读标记 应该可以重置未伴读的章节（幂等性）
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:07 +216 -22: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 边界条件和异常情况 应该正确处理包含SQL特殊字符的背景设定
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:07 +216 -22: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 resetChapterAccompaniedFlag - 重置章节伴读标记 应该可以重置未伴读的章节（幂等性）
清理表 chapter_cache 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM chapter_cache, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM chapter_cache, parameters: ) sql 'DELETE FROM chapter_cache' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 novel_chapters 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM novel_chapters, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM novel_chapters, parameters: ) sql 'DELETE FROM novel_chapters' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 characters 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM characters, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM characters, parameters: ) sql 'DELETE FROM characters' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 scene_illustrations 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM scene_illustrations, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM scene_illustrations, parameters: ) sql 'DELETE FROM scene_illustrations' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +216 -22: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 边界条件和异常情况 应该正确处理包含SQL特殊字符的背景设定
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +216 -23: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +216 -23: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 resetChapterAccompaniedFlag - 重置章节伴读标记 应该可以重置未伴读的章节（幂等性） [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?), parameters: 测试小说, 测试作者, https://example.com/novel1, 1769409913732}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?), parameters: 测试小说, 测试作者, https://example.com/novel1, 1769409913732) sql 'INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?)' args [测试小说, 测试作者, https://example.com/novel1, 1769409913732] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +216 -23: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 边界条件和异常情况 应该正确处理包含SQL特殊字符的背景设定
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +216 -23: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 resetChapterAccompaniedFlag - 重置章节伴读标记 应该只重置指定章节的标记
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
清理表 bookshelf 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM bookshelf, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM bookshelf, parameters: ) sql 'DELETE FROM bookshelf' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +216 -24: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +216 -24: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 边界条件和异常情况 应该正确处理包含SQL特殊字符的背景设定 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: UPDATE bookshelf SET backgroundSetting = ? WHERE url = ?, parameters: 背景包含'单引号'和"双引号"--注释, https://example.com/novel11}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: UPDATE bookshelf SET backgroundSetting = ? WHERE url = ?, parameters: 背景包含'单引号'和"双引号"--注释, https://example.com/novel11) sql 'UPDATE bookshelf SET backgroundSetting = ? WHERE url = ?' args [背景包含'单引号'和"双引号"--注释, https://example.com/novel11] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +216 -24: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 边界条件和异常情况 应该正确处理超大背景设定
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:07 +216 -24: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 resetChapterAccompaniedFlag - 重置章节伴读标记 应该只重置指定章节的标记
清理表 scene_illustrations 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM scene_illustrations, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM scene_illustrations, parameters: ) sql 'DELETE FROM scene_illustrations' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +216 -25: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +216 -25: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 resetChapterAccompaniedFlag - 重置章节伴读标记 应该只重置指定章节的标记 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?), parameters: 测试小说, 测试作者, https://example.com/novel1, 1769409913789}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?), parameters: 测试小说, 测试作者, https://example.com/novel1, 1769409913789) sql 'INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?)' args [测试小说, 测试作者, https://example.com/novel1, 1769409913789] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +216 -25: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 集成场景测试 完整流程：缓存 -> 标记 -> 检查 -> 重置 -> 检查
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:07 +216 -25: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 边界条件和异常情况 应该正确处理超大背景设定
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +216 -26: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +216 -26: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 边界条件和异常情况 应该正确处理超大背景设定 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?), parameters: 测试小说, 测试作者, https://example.com/novel12, 1769409913822}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?), parameters: 测试小说, 测试作者, https://example.com/novel12, 1769409913822) sql 'INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?)' args [测试小说, 测试作者, https://example.com/novel12, 1769409913822] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +216 -26: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 跨小说独立性 不同小说的背景设定应该独立
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:07 +216 -26: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 集成场景测试 完整流程：缓存 -> 标记 -> 检查 -> 重置 -> 检查
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +216 -27: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +216 -27: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 集成场景测试 完整流程：缓存 -> 标记 -> 检查 -> 重置 -> 检查 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?), parameters: 测试小说, 测试作者, https://example.com/novel1, 1769409913850}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?), parameters: 测试小说, 测试作者, https://example.com/novel1, 1769409913850) sql 'INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, NULL, ?)' args [测试小说, 测试作者, https://example.com/novel1, 1769409913850] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +216 -27: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 集成场景测试 多章节场景：正确跟踪每个章节的伴读状态
*** sqflite warning ***

You are changing sqflite default factory.
Be aware of the potential side effects. Any library using sqflite
will have this factory as the default for all operations.

*** sqflite warning ***

✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
清理表 bookshelf 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM bookshelf, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM bookshelf, parameters: ) sql 'DELETE FROM bookshelf' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 chapter_cache 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM chapter_cache, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM chapter_cache, parameters: ) sql 'DELETE FROM chapter_cache' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +216 -27: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 跨小说独立性 不同小说的背景设定应该独立
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +216 -27: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 集成场景测试 多章节场景：正确跟踪每个章节的伴读状态
清理表 characters 时出错: SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM characters, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
  Causing statement: DELETE FROM characters, parameters: ) sql 'DELETE FROM characters' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +216 -27: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 跨小说独立性 不同小说的背景设定应该独立
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
00:07 +216 -28: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
00:07 +216 -28: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_background_test.dart: AI伴读背景设定更新测试 跨小说独立性 不同小说的背景设定应该独立 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, ?, ?), parameters: 小说1, 作者1, https://example.com/novel1, 背景1, 1769409913886}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement: INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, ?, ?), parameters: 小说1, 作者1, https://example.com/novel1, 背景1, 1769409913886) sql 'INSERT OR REPLACE INTO bookshelf (title, author, url, coverUrl, description, backgroundSetting, addedAt) VALUES (?, ?, ?, NULL, NULL, ?, ?)' args [小说1, 作者1, https://example.com/novel1, 背景1, 1769409913886] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:07 +216 -28: D:/myspace/novel_builder/novel_app/test/unit/services/ai_accompaniment_database_test.dart: AI伴读数据库服务测试 集成场景测试 多章节场景：正确跟踪每个章节的伴读状态
清理表 character_relationships 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: character_relationships, SQL logic error (code 1)
  Causing statement: DELETE FROM character_relationships, parameters: ) sql 'DELETE FROM character_relationships' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 outlines 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: outlines, SQL logic error (code 1)
  Causing statement: DELETE FROM outlines, parameters: ) sql 'DELETE FROM outlines' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
清理表 chat_scenes 时出错: SqfliteFfiException(sqlite_error: 1, , SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: }) DatabaseException(SqliteException(1): while executing, no such table: chat_scenes, SQL logic error (code 1)
  Causing statement: DELETE FROM chat_scenes, parameters: ) sql 'DELETE FROM chat_scenes' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 3, readOnly: false, singleInstance: true}}}
00:07 +217 -28: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following TestFailure was thrown running a test:
Expected: exactly one matching candidate
  Actual: _AncestorWidgetFinder:<Found 0 widgets with type "TextFormField" that are ancestors of
widgets with text "姓名": []>
   Which: means none were found but one was expected
应该存在姓名输入框

When the exception was thrown, this was the stack:
#4      main.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart:129:7)
<asynchronous suspension>
#5      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#6      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided one frame from package:stack_trace)

This was caught by the test expectation on the following line:
  file:///D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart line 129
The test description was:
  测试4: 新建模式下必填字段验证
════════════════════════════════════════════════════════════════════════════════════════════════════
00:07 +217 -29: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试4: 新建模式下必填字段验证 [E]
  Test failed. See exception logs above.
  The test description was: 测试4: 新建模式下必填字段验证
  
00:07 +217 -29: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试5: 验证表单字段完整性
❌ 获取角色头像路径失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载模型列表失败: Exception: ApiServiceWrapper 未初始化，请先调用 init()
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following TestFailure was thrown running a test:
Expected: exactly one matching candidate
  Actual: _AncestorWidgetFinder:<Found 0 widgets with type "TextFormField" that are ancestors of
widgets with text "姓名": []>
   Which: means none were found but one was expected

When the exception was thrown, this was the stack:
#4      main.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart:152:7)
<asynchronous suspension>
#5      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#6      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided one frame from package:stack_trace)

This was caught by the test expectation on the following line:
  file:///D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart line 152
The test description was:
  测试5: 验证表单字段完整性
════════════════════════════════════════════════════════════════════════════════════════════════════
00:08 +217 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试5: 验证表单字段完整性 [E]
  Test failed. See exception logs above.
  The test description was: 测试5: 验证表单字段完整性
  
00:08 +217 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试6: 验证保存按钮存在
❌ 获取角色头像路径失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载模型列表失败: Exception: ApiServiceWrapper 未初始化，请先调用 init()
00:08 +218 -30: D:/myspace/novel_builder/novel_app/test/unit/services/batch_chapter_loading_test.dart: 批量加载章节测试 - 验证清理触发 批量获取章节内容时应该触发多次清理
00:08 +218 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试7: 新建模式下的AppBar标题
加载模型列表失败: Exception: ApiServiceWrapper 未初始化，请先调用 init()
00:08 +219 -30: D:/myspace/novel_builder/novel_app/test/unit/services/batch_chapter_loading_test.dart: 批量加载章节测试 - 验证清理触发 批量获取章节内容时应该触发多次清理
⏱️ 批量加载10个章节耗时: 13ms
📊 每个章节平均耗时: 1.3ms
00:08 +220 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
00:08 +220 -30: loading D:/myspace/novel_builder/novel_app/test/unit/services/chapter_search_service_test.dart
✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:09 +221 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
00:09 +222 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
00:09 +222 -30: D:/myspace/novel_builder/novel_app/test/unit/services/batch_chapter_loading_test.dart: 批量加载章节测试 - 验证清理触发 单次获取章节内容应该只触发一次清理
✅ 单次获取章节完成，内容未变化
00:09 +223 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
00:09 +224 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
00:09 +225 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
00:09 +226 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
00:09 +227 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
00:09 +228 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
00:09 +229 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
00:09 +230 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
00:09 +231 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
00:09 +232 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
00:09 +233 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
00:09 +234 -30: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试8: 编辑模式下的AppBar标题
❌ 获取角色头像路径失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载模型列表失败: Exception: ApiServiceWrapper 未初始化，请先调用 init()
00:09 +235 -30: D:/myspace/novel_builder/novel_app/test/unit/services/batch_chapter_loading_test.dart: 批量加载章节测试 - 验证清理触发 章节列表加载缓存状态的行为
00:09 +236 -30: D:/myspace/novel_builder/novel_app/test/unit/services/batch_chapter_loading_test.dart: 批量加载章节测试 - 验证清理触发 章节列表加载缓存状态的行为
00:09 +236 -30: D:/myspace/novel_builder/novel_app/test/unit/services/chapter_search_service_test.dart: ChapterSearchService 错误处理 DatabaseService 抛出异常时应转换为搜索失败异常
  Skip: 需要 mock DatabaseService 让其抛出异常
00:09 +236 ~1 -30: D:/myspace/novel_builder/novel_app/test/unit/services/batch_chapter_loading_test.dart: 批量加载章节测试 - 验证清理触发 章节列表加载缓存状态的行为
00:09 +236 ~1 -30: D:/myspace/novel_builder/novel_app/test/unit/services/chapter_search_service_test.dart: ChapterSearchService 结果排序逻辑 相同小说的章节应按索引升序排列
  Skip: 需要创建测试数据验证排序逻辑
00:09 +236 ~2 -30: D:/myspace/novel_builder/novel_app/test/unit/services/batch_chapter_loading_test.dart: 批量加载章节测试 - 验证清理触发 章节列表加载缓存状态的行为
00:09 +236 ~2 -30: D:/myspace/novel_builder/novel_app/test/unit/services/chapter_search_service_test.dart: ChapterSearchService 结果排序逻辑 不同小说的结果应先按小说URL分组
  Skip: 需要创建测试数据验证分组逻辑
00:09 +236 ~3 -30: D:/myspace/novel_builder/novel_app/test/unit/services/batch_chapter_loading_test.dart: 批量加载章节测试 - 验证清理触发 章节列表加载缓存状态的行为
00:09 +236 ~3 -30: D:/myspace/novel_builder/novel_app/test/unit/services/chapter_search_service_test.dart: ChapterSearchService 结果排序逻辑 相同索引时保持原始顺序（稳定排序）
  Skip: 需要创建测试数据验证稳定排序
00:09 +236 ~4 -30: D:/myspace/novel_builder/novel_app/test/unit/services/batch_chapter_loading_test.dart: 批量加载章节测试 - 验证清理触发 章节列表加载缓存状态的行为
00:09 +236 ~4 -30: D:/myspace/novel_builder/novel_app/test/unit/services/chapter_search_service_test.dart: ChapterSearchService 性能测试 搜索大量结果应正确排序
  Skip: 性能测试，需要真实数据库环境
00:09 +236 ~5 -30: D:/myspace/novel_builder/novel_app/test/unit/services/batch_chapter_loading_test.dart: 批量加载章节测试 - 验证清理触发 章节列表加载缓存状态的行为
00:09 +236 ~5 -30: D:/myspace/novel_builder/novel_app/test/unit/services/chapter_search_service_test.dart: ChapterSearchService 性能测试 重复搜索同一关键词应一致
  Skip: 需要验证缓存或一致性
00:09 +236 ~6 -30: D:/myspace/novel_builder/novel_app/test/unit/services/batch_chapter_loading_test.dart: 批量加载章节测试 - 验证清理触发 章节列表加载缓存状态的行为
00:09 +236 ~6 -31: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +236 ~6 -31: D:/myspace/novel_builder/novel_app/test/unit/services/batch_chapter_loading_test.dart: 批量加载章节测试 - 验证清理触发 章节列表加载缓存状态的行为 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement:         INSERT INTO novel_chapters (novelUrl, chapterUrl, title, chapterIndex, isUserInserted)
          VALUES (?, ?, ?, ?, 0)
          ON CONFLICT(novelUrl, chapterUrl) DO UPDATE SET
            title = excluded.title,
            chapterIndex = excluded.chapterIndex
        , parameters: https://test.com/novel/batch-test, https://test.com/chapter/8, 第8章, 7}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement:         INSERT INTO novel_chapters (novelUrl, chapterUrl, title, chapterIndex, isUserInserted)
          VALUES (?, ?, ?, ?, 0)
          ON CONFLICT(novelUrl, chapterUrl) DO UPDATE SET
            title = excluded.title,
            chapterIndex = excluded.chapterIndex
        , parameters: https://test.com/novel/batch-test, https://test.com/chapter/8, 第8章, 7) sql '        INSERT INTO novel_chapters (novelUrl, chapterUrl, title, chapterIndex, isUserInserted)
          VALUES (?, ?, ?, ?, 0)
          ON CONFLICT(novelUrl, chapterUrl) DO UPDATE SET
            title = excluded.title,
            chapterIndex = excluded.chapterIndex
        ' args [https://test.com/novel/batch-test, https://test.com/chapter/8, 第8章, 7] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:09 +236 ~6 -31: loading D:/myspace/novel_builder/novel_app/test/unit/services/chapter_service_test.dart
✅ 测试环境初始化完成 (SQLite FFI)
✅ 数据库测试环境初始化完成
00:09 +237 ~6 -31: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +238 ~6 -31: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +238 ~6 -31: D:/myspace/novel_builder/novel_app/test/unit/services/batch_chapter_loading_test.dart: 批量加载章节测试 - 验证清理触发 验证多次读取同一章节的清理行为
📝 原始内容包含无效标记: 章节开始
[插图:invalid-id]
章节结束
📖 第一次读取结果: 章节开始
[插图:invalid-id]
章节结束
00:09 +239 ~6 -31: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +239 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +239 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/services/chapter_service_test.dart: ChapterService 历史章节内容 应获取最近章节的内容 [E]
  MissingStubError: 'getCachedChapter'
  No stub was found which matches the arguments of this method call:
  getCachedChapter('chapter1')
  
  Add a stub for this method using Mockito's 'when' API, or generate the MockDatabaseService mock with the @GenerateNiceMocks annotation (see https://pub.dev/documentation/mockito/latest/annotations/MockSpec-class.html).
  package:mockito/src/mock.dart 200:7                        Mock._noSuchMethod
  package:mockito/src/mock.dart 194:47                       Mock.noSuchMethod
  test\unit\services\chapter_service_test.mocks.dart 304:14  MockDatabaseService.getCachedChapter
  package:novel_app/services/chapter_service.dart 52:48      ChapterService.getHistoryChaptersContent
  test\unit\services\chapter_service_test.dart 97:43         main.<fn>.<fn>
  
00:09 +240 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +241 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +242 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +243 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +244 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +245 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +246 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +247 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +248 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +249 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +249 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/services/batch_chapter_loading_test.dart: 批量加载章节测试 - 验证清理触发 验证多次读取同一章节的清理行为
📖 第二次读取结果: 章节开始
[插图:invalid-id]
章节结束
📖 第三次读取结果: 章节开始
[插图:invalid-id]
章节结束
✅ 验证完成：多次读取同一章节的行为正确
00:09 +250 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +251 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +252 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +253 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +254 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +255 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +256 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +257 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +258 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +259 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +260 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +261 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +262 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +263 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +264 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +265 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +266 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +267 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +268 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +269 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +270 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +271 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +272 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +273 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
00:09 +274 ~6 -32: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在
❌ 获取角色头像路径失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载模型列表失败: Exception: ApiServiceWrapper 未初始化，请先调用 init()
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following TestFailure was thrown running a test:
Expected: at least one matching candidate
  Actual: _IconWidgetFinder:<Found 0 widgets with icon "IconData(U+0E491)": []>
   Which: means none were found but some were expected

When the exception was thrown, this was the stack:
#4      main.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart:231:7)
<asynchronous suspension>
#5      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#6      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided one frame from package:stack_trace)

This was caught by the test expectation on the following line:
  file:///D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart line 231
The test description was:
  测试9: 验证头像显示区域存在
════════════════════════════════════════════════════════════════════════════════════════════════════
00:09 +274 ~6 -33: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试9: 验证头像显示区域存在 [E]
  Test failed. See exception logs above.
  The test description was: 测试9: 验证头像显示区域存在
  
00:09 +274 ~6 -33: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试10: 验证提示词输入框是可编辑的
test/unit/services/character_extraction_service_test.dart:235:9: Error: No named parameter with the name 'minGap'.
        minGap: 10, // 设置较小的重叠阈值
        ^^^^^^
00:09 +274 ~6 -33: D:/myspace/novel_builder/novel_app/test/unit/services/character_drop_first_last_test.dart: CharacterExtractionService - 丢弃首尾段落测试 应该丢弃每个片段的第一段和最后一段
合并结果：
片段1中间段A。
片段2中间段B。
片段2中间段C。
00:09 +275 ~6 -33: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试10: 验证提示词输入框是可编辑的
00:09 +276 ~6 -33: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试10: 验证提示词输入框是可编辑的
00:09 +277 ~6 -33: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试10: 验证提示词输入框是可编辑的
00:09 +277 ~6 -33: D:/myspace/novel_builder/novel_app/test/unit/services/character_drop_first_last_test.dart: CharacterExtractionService - 丢弃首尾段落测试 多个片段时应该正确处理
合并结果：
片段1-中1。
片段1-中2。
片段2-中。
片段3-中1。
片段3-中2。
片段3-中3。
00:09 +278 ~6 -33: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试10: 验证提示词输入框是可编辑的
00:09 +278 ~6 -33: D:/myspace/novel_builder/novel_app/test/unit/services/character_drop_first_last_test.dart: CharacterExtractionService - 丢弃首尾段落测试 应该正确处理去重
合并结果：
重复段落。
00:09 +279 ~6 -33: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试10: 验证提示词输入框是可编辑的
00:09 +279 ~6 -33: D:/myspace/novel_builder/novel_app/test/unit/services/character_drop_first_last_test.dart: CharacterExtractionService - 丢弃首尾段落测试 实际案例：角色提取场景
合并结果：
事实证明，姜还是老的辣，尽管他们这一战真的不能再真，但最后因为上官天月的表演，上官天阳还是看出了其中奥妙。
上官冰儿瞪大了美眸，"你这坏家伙，竟然和爸爸联合起来骗妈妈。"
长度：85 字
00:09 +280 ~6 -33: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试10: 验证提示词输入框是可编辑的
00:09 +280 ~6 -34: loading D:/myspace/novel_builder/novel_app/test/unit/services/character_extraction_service_test.dart [E]
  Failed to load "D:/myspace/novel_builder/novel_app/test/unit/services/character_extraction_service_test.dart":
  Compilation failed for testPath=D:/myspace/novel_builder/novel_app/test/unit/services/character_extraction_service_test.dart: test/unit/services/character_extraction_service_test.dart:235:9: Error: No named parameter with the name 'minGap'.
          minGap: 10, // 设置较小的重叠阈值
          ^^^^^^
  .
00:10 +280 ~6 -34: D:/myspace/novel_builder/novel_app/test/unit/services/character_extraction_bug_test.dart: Bug复现: matchPositions 丢失问题 当 matchPositions 为空时，extractContextAroundMatches 应该返回空列表
✅ 测试确认：当 matchPositions 为空时，无法提取任何上下文
00:10 +281 ~6 -34: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试10: 验证提示词输入框是可编辑的
00:10 +281 ~6 -34: D:/myspace/novel_builder/novel_app/test/unit/services/character_extraction_bug_test.dart: Bug复现: matchPositions 丢失问题 当 matchPositions 正确传递时，应该能提取上下文
✅ 测试确认：当 matchPositions 正确时，能成功提取上下文
00:10 +282 ~6 -34: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试10: 验证提示词输入框是可编辑的
00:10 +282 ~6 -34: D:/myspace/novel_builder/novel_app/test/unit/services/character_extraction_bug_test.dart: Bug复现: matchPositions 丢失问题 整章模式不受 matchPositions 影响
✅ 测试确认：整章模式不受 matchPositions 影响
00:10 +283 ~6 -34: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试10: 验证提示词输入框是可编辑的
00:10 +283 ~6 -34: D:/myspace/novel_builder/novel_app/test/unit/services/character_extraction_bug_test.dart: Bug复现: Chapter.content 可能为 null 当 Chapter.content 为 null 时应该正确处理
✅ 测试确认：当 content 为 null 时，应使用空字符串
00:10 +284 ~6 -34: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试10: 验证提示词输入框是可编辑的
❌ 获取角色头像路径失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载模型列表失败: Exception: ApiServiceWrapper 未初始化，请先调用 init()
❌ 获取角色头像路径失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

❌ 获取角色头像路径失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following TestFailure was thrown running a test:
Expected: exactly one matching candidate
  Actual: _TextWidgetFinder:<Found 2 widgets with text "new prompt text": [
            Text("new prompt text", inherit: true, color: Color(alpha: 0.8667, red: 0.0000, green:
0.0000, blue: 0.0000, colorSpace: ColorSpace.sRGB), size: 24.0, weight: 700, overflow: ellipsis,
dependencies: [DefaultSelectionStyle, DefaultTextStyle, MediaQuery]),
            EditableText-[LabeledGlobalKey<EditableTextState>#48814](controller:
TextEditingController#ce394(TextEditingValue(text: ┤new prompt text├, selection:
TextSelection.collapsed(offset: 15, affinity: TextAffinity.downstream, isDirectional: false),
composing: TextRange(start: -1, end: -1))), focusNode: FocusNode#b91c4([PRIMARY FOCUS]),
autocorrect: true, debugLabel: ((englishLike bodyLarge 2021).merge((blackMountainView
bodyLarge).apply)).merge(unknown), inherit: false, color: Color(alpha: 1.0000, red: 0.1137, green:
0.1059, blue: 0.1255, colorSpace: ColorSpace.sRGB), family: Roboto, size: 16.0, weight: 400,
letterSpacing: 0.5, baseline: alphabetic, height: 1.5x, leadingDistribution: even, decoration:
Color(alpha: 1.0000, red: 0.1137, green: 0.1059, blue: 0.1255, colorSpace: ColorSpace.sRGB)
TextDecoration.none, textAlign: start, keyboardType: TextInputType(name: TextInputType.text, signed:
null, decimal: null), spellCheckConfiguration: SpellCheckConfiguration(disabled, service: null, text
style: null, toolbar builder: null), dependencies: [Directionality, MediaQuery,
_EffectiveTickerMode, _ViewScope], state: EditableTextState#7ffaf(tickers: tracking 1 ticker)),
          ]>
   Which: is too many

When the exception was thrown, this was the stack:
#4      main.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart:257:7)
<asynchronous suspension>
#5      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#6      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided one frame from package:stack_trace)

This was caught by the test expectation on the following line:
  file:///D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart line 257
The test description was:
  测试10: 验证提示词输入框是可编辑的
════════════════════════════════════════════════════════════════════════════════════════════════════
00:10 +284 ~6 -35: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试10: 验证提示词输入框是可编辑的 [E]
  Test failed. See exception logs above.
  The test description was: 测试10: 验证提示词输入框是可编辑的
  
00:10 +284 ~6 -35: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试11: 验证生成提示词按钮存在
❌ 获取角色头像路径失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载模型列表失败: Exception: ApiServiceWrapper 未初始化，请先调用 init()
00:10 +285 ~6 -35: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试12: 验证姓名字段可正常输入
加载模型列表失败: Exception: ApiServiceWrapper 未初始化，请先调用 init()
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following TestFailure was thrown running a test:
Expected: exactly one matching candidate
  Actual: _AncestorWidgetFinder:<Found 0 widgets with type "TextFormField" that are ancestors of
widgets with text "姓名": []>
   Which: means none were found but one was expected

When the exception was thrown, this was the stack:
#4      main.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart:297:7)
<asynchronous suspension>
#5      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#6      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided one frame from package:stack_trace)

This was caught by the test expectation on the following line:
  file:///D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart line 297
The test description was:
  测试12: 验证姓名字段可正常输入
════════════════════════════════════════════════════════════════════════════════════════════════════
00:11 +285 ~6 -36: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试12: 验证姓名字段可正常输入 [E]
  Test failed. See exception logs above.
  The test description was: 测试12: 验证姓名字段可正常输入
  
00:11 +285 ~6 -36: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试13: 验证性别选择框存在
00:11 +285 ~6 -36: D:/myspace/novel_builder/novel_app/test/unit/services/character_merge_test.dart: CharacterExtractionService - 新合并逻辑测试 应该按段落分割，不截断句子
合并结果：

长度：0
00:11 +285 ~6 -37: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试13: 验证性别选择框存在
00:11 +285 ~6 -37: D:/myspace/novel_builder/novel_app/test/unit/services/character_merge_test.dart: CharacterExtractionService - 新合并逻辑测试 应该按段落分割，不截断句子 [E]
  Expected: contains '第一段完整的句子。'
    Actual: ''
     Which: does not contain '第一段完整的句子。'
  
  package:matcher                                     expect
  package:flutter_test/src/widget_tester.dart 473:18  expect
  test\unit\services\character_merge_test.dart 25:7   main.<fn>.<fn>
  
00:11 +285 ~6 -37: D:/myspace/novel_builder/novel_app/test/unit/services/character_merge_test.dart: CharacterExtractionService - 新合并逻辑测试 应该保留所有内容，无字数限制
合并结果：
短段落二。
短段落五。
长度：11
段落数：2
00:11 +285 ~6 -38: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试13: 验证性别选择框存在
00:11 +285 ~6 -38: D:/myspace/novel_builder/novel_app/test/unit/services/character_merge_test.dart: CharacterExtractionService - 新合并逻辑测试 应该保留所有内容，无字数限制 [E]
  Expected: <8>
    Actual: <2>
  
  package:matcher                                     expect
  package:flutter_test/src/widget_tester.dart 473:18  expect
  test\unit\services\character_merge_test.dart 52:7   main.<fn>.<fn>
  
00:11 +285 ~6 -38: D:/myspace/novel_builder/novel_app/test/unit/services/character_merge_test.dart: CharacterExtractionService - 新合并逻辑测试 应该处理重复段落
合并结果：

00:11 +285 ~6 -39: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试13: 验证性别选择框存在
00:11 +285 ~6 -39: D:/myspace/novel_builder/novel_app/test/unit/services/character_merge_test.dart: CharacterExtractionService - 新合并逻辑测试 应该处理重复段落 [E]
  Expected: <1>
    Actual: <0>
  
  package:matcher                                     expect
  package:flutter_test/src/widget_tester.dart 473:18  expect
  test\unit\services\character_merge_test.dart 69:7   main.<fn>.<fn>
  
00:11 +286 ~6 -39: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试13: 验证性别选择框存在
00:11 +287 ~6 -39: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试13: 验证性别选择框存在
00:11 +287 ~6 -39: D:/myspace/novel_builder/novel_app/test/unit/services/character_merge_test.dart: CharacterExtractionService - 新合并逻辑测试 实际案例：角色提取场景
合并结果：
周维清嘿嘿笑道："现在他们可顾不上你了，咱们还是赶快走才好。"
长度：31 字
00:11 +287 ~6 -40: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试13: 验证性别选择框存在
00:11 +287 ~6 -40: D:/myspace/novel_builder/novel_app/test/unit/services/character_merge_test.dart: CharacterExtractionService - 新合并逻辑测试 实际案例：角色提取场景 [E]
  Expected: contains '周维清之所以全力以赴'
    Actual: '周维清嘿嘿笑道："现在他们可顾不上你了，咱们还是赶快走才好。"'
     Which: does not contain '周维清之所以全力以赴'
  
  package:matcher                                     expect
  package:flutter_test/src/widget_tester.dart 473:18  expect
  test\unit\services\character_merge_test.dart 104:7  main.<fn>.<fn>
  
00:11 +287 ~6 -40: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试13: 验证性别选择框存在
❌ 获取角色头像路径失败: Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API

加载模型列表失败: Exception: ApiServiceWrapper 未初始化，请先调用 init()
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following TestFailure was thrown running a test:
Expected: exactly one matching candidate
  Actual: _AncestorWidgetFinder:<Found 0 widgets with type "TextFormField" that are ancestors of
widgets with text "性别": []>
   Which: means none were found but one was expected

When the exception was thrown, this was the stack:
#4      main.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart:322:7)
<asynchronous suspension>
#5      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#6      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided one frame from package:stack_trace)

This was caught by the test expectation on the following line:
  file:///D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart line 322
The test description was:
  测试13: 验证性别选择框存在
════════════════════════════════════════════════════════════════════════════════════════════════════
00:11 +287 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/screens/character_edit_screen_auto_save_test.dart: CharacterEditScreen - 提示词生成后自动保存功能 测试13: 验证性别选择框存在 [E]
  Test failed. See exception logs above.
  The test description was: 测试13: 验证性别选择框存在
  
00:11 +287 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: (setUpAll)
00:11 +287 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 初始化测试 should create database successfully
00:11 +288 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 初始化测试 should create all tables on initialization
00:11 +289 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 书架操作测试 addToBookshelf should insert novel successfully
00:12 +290 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 书架操作测试 isInBookshelf should return true for novel in bookshelf
00:12 +291 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 书架操作测试 isInBookshelf should return false for novel not in bookshelf
00:12 +292 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 书架操作测试 removeFromBookshelf should delete novel successfully
00:12 +292 ~6 -41: loading D:/myspace/novel_builder/novel_app/test/unit/services/dify_parsing_test.dart
=== 测试1: 实际Dify返回数据（嵌套结构 + 字符串格式） ===
✅ play类型: String
✅ play内容: 【云海情劫·剑影迷踪】

**世界观与情...
✅ role_strategy原始类型: String
✅ role_strategy解析后类型: List<dynamic>
✅ role_strategy数量: 1
✅ 第一个元素: {name: 孟红绚, strategy: **性格底色**：理性至上}
✅ 角色名: 孟红绚
✅ 策略: **性格底色**：理性至上...
✅ 测试1通过

=== 测试2: 数组格式（扁平结构） ===
✅ play: 测试剧本
✅ role_strategy原始类型: List<dynamic>
✅ 解析后数量: 2
✅ 角色列表: 张三, 李四
✅ 测试2通过

=== 测试3: 字符串格式（扁平结构） ===
✅ role_strategy原始类型: String
✅ 解析后数量: 1
✅ 角色名: 王五
✅ 测试3通过

=== 测试4: 错误格式测试 ===
--- 测试4.1: 空字符串 ---
❌ role_strategy字符串解析失败: FormatException: Unexpected end of input (at character 1)

^

原始字符串: 
✅ 正确捕获异常: Exception: role_strategy字符串解析失败: FormatException: Unexpected end of input (at character 1)

^


--- 测试4.2: 数字类型 ---
❌ role_strategy类型错误: int
✅ 正确捕获异常: Exception: role_strategy格式错误：不支持的类型 int

--- 测试4.3: 无效JSON字符串 ---
❌ role_strategy字符串解析失败: FormatException: Unexpected character (at character 1)
not a json
^

原始字符串: not a json
✅ 正确捕获异常: Exception: role_strategy字符串解析失败: FormatException: ...

=== 测试5: 完整的实际数据（简化版） ===
✅ 剧本长度: 106 字符
✅ role_strategy原始类型: String
✅ 解析成功，数量: 1
✅ 角色名: 孟红绚
✅ 策略长度: 79 字符
✅ 服装: 素雅道袍，青丝以玉簪束起。
✅ 测试5通过


=== 全部测试完成 ===
00:12 +293 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 书架操作测试 should update last read chapter
00:12 +294 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 章节缓存测试 cacheChapter should save chapter content
00:12 +295 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 章节缓存测试 getCachedChapter should return null for non-existent chapter
00:12 +296 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 章节缓存测试 clearNovelCache should remove cached content
00:12 +297 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 用户章节操作测试 insertUserChapter should save chapter to database
00:12 +298 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 用户章节操作测试 insertUserChapter should insert at correct index
00:12 +299 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 用户章节操作测试 deleteCustomChapter should remove user chapter
00:12 +300 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 用户章节操作测试 deleteCustomChapter should update indices after deletion
00:12 +301 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 用户章节操作测试 deleteCustomChapter should update indices after deletion
00:12 +302 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 用户章节操作测试 deleteCustomChapter should update indices after deletion
00:12 +303 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 用户章节操作测试 deleteCustomChapter should update indices after deletion
00:12 +304 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 用户章节操作测试 deleteCustomChapter should update indices after deletion
00:12 +305 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/logger_service_test.dart: LoggerService 日志记录 w()应记录WARNING级别日志
00:12 +306 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 章节列表管理测试 getChapters should return chapter list
00:12 +307 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 章节列表管理测试 getChapters should return chapter list
00:12 +308 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 章节列表管理测试 getChapters should return chapter list
00:12 +309 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 章节列表管理测试 getChapters should return chapter list
00:12 +310 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/logger_service_test.dart: LoggerService FIFO自动清理 超过1000条时应删除最旧的日志
00:12 +311 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/logger_service_test.dart: LoggerService FIFO自动清理 超过1000条时应删除最旧的日志
00:12 +312 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/logger_service_test.dart: LoggerService FIFO自动清理 超过1000条时应删除最旧的日志
00:12 +313 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/database_service_test.dart: DatabaseService - 数据清理测试 clearAllCache should remove all data
00:12 +314 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: (setUpAll)
00:12 +315 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: (setUpAll)
00:12 +316 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: (setUpAll)
00:12 +317 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: (setUpAll)
00:12 +317 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/logger_service_test.dart: LoggerService 日志过滤 getLogsByLevel(LogLevel.info)应只返回INFO级别
00:12 +318 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +319 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +320 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +321 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +322 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +323 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +324 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +325 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +326 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
test/unit/services/tts_player_service_test.dart:9:8: Error: Error when reading 'test/unit/services/tts_player_service_test.mocks.dart': 系统找不到指定的文件。

import 'tts_player_service_test.mocks.dart';
       ^
00:12 +327 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +327 ~6 -41: D:/myspace/novel_builder/novel_app/test/unit/services/logger_service_test.dart: LoggerService 导出功能 exportToFile()应创建文件并包含所有日志
  Skip: path_provider requires Widget test environment
00:12 +327 ~7 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +327 ~7 -41: D:/myspace/novel_builder/novel_app/test/unit/services/logger_service_test.dart: LoggerService 导出功能 导出文件格式应正确
  Skip: path_provider requires Widget test environment
00:12 +327 ~8 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +327 ~8 -41: D:/myspace/novel_builder/novel_app/test/unit/services/logger_service_test.dart: LoggerService 导出功能 空日志导出应创建空文件
  Skip: path_provider requires Widget test environment
00:12 +327 ~9 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +328 ~9 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +329 ~9 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +330 ~9 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +331 ~9 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +331 ~9 -41: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
⏳ 速率限制: 等待 0 秒
00:12 +332 ~9 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +333 ~9 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +334 ~9 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +335 ~9 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +336 ~9 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +337 ~9 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +338 ~9 -41: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +338 ~9 -42: loading D:/myspace/novel_builder/novel_app/test/unit/services/tts_player_service_test.dart [E]
  Failed to load "D:/myspace/novel_builder/novel_app/test/unit/services/tts_player_service_test.dart":
  Compilation failed for testPath=D:/myspace/novel_builder/novel_app/test/unit/services/tts_player_service_test.dart: test/unit/services/tts_player_service_test.dart:9:8: Error: Error when reading 'test/unit/services/tts_player_service_test.mocks.dart': 系统找不到指定的文件。
  
  import 'tts_player_service_test.mocks.dart';
         ^
  .
00:12 +338 ~9 -42: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +339 ~9 -42: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +340 ~9 -42: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +341 ~9 -42: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +342 ~9 -42: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +343 ~9 -42: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +344 ~9 -42: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +345 ~9 -42: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +346 ~9 -42: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +346 ~9 -42: D:/myspace/novel_builder/novel_app/test/unit/services/reading_chapter_log_test.dart: 阅读章节日志测试 场景1：章节内容无媒体标记 - 应该没有日志

📖 场景1：阅读无媒体标记的章节
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 内容长度: 41

00:12 +347 ~9 -42: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节
00:12 +347 ~9 -43: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:12 +347 ~9 -43: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：不再批量检查所有章节 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement:         INSERT INTO novel_chapters (novelUrl, chapterUrl, title, chapterIndex, isUserInserted)
          VALUES (?, ?, ?, ?, 0)
          ON CONFLICT(novelUrl, chapterUrl) DO UPDATE SET
            title = excluded.title,
            chapterIndex = excluded.chapterIndex
        , parameters: https://test.com/novel/perf-test, https://test.com/chapter/55, 第55章, 54}) DatabaseException(SqliteException(5): while executing statement, database is locked, database is locked (code 5)
    Causing statement:         INSERT INTO novel_chapters (novelUrl, chapterUrl, title, chapterIndex, isUserInserted)
          VALUES (?, ?, ?, ?, 0)
          ON CONFLICT(novelUrl, chapterUrl) DO UPDATE SET
            title = excluded.title,
            chapterIndex = excluded.chapterIndex
        , parameters: https://test.com/novel/perf-test, https://test.com/chapter/55, 第55章, 54) sql '        INSERT INTO novel_chapters (novelUrl, chapterUrl, title, chapterIndex, isUserInserted)
          VALUES (?, ?, ?, ?, 0)
          ON CONFLICT(novelUrl, chapterUrl) DO UPDATE SET
            title = excluded.title,
            chapterIndex = excluded.chapterIndex
        ' args [https://test.com/novel/perf-test, https://test.com/chapter/55, 第55章, 54] {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:12 +347 ~9 -44: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:12 +347 ~9 -44: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：章节列表加载不再触发清理 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
    Causing statement: DELETE FROM bookshelf, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
    Causing statement: DELETE FROM bookshelf, parameters: ) sql 'DELETE FROM bookshelf' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:12 +347 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:12 +347 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化验证 - 移除批量检查 验证：阅读章节时仍然会清理 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
    Causing statement: DELETE FROM bookshelf, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
    Causing statement: DELETE FROM bookshelf, parameters: ) sql 'DELETE FROM bookshelf' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:13 +347 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/performance_optimization_test.dart: 性能优化总结 总结报告

============================================================
📊 性能优化总结报告
============================================================

✅ 优化措施：
   1. 移除章节列表页面的并发缓存状态检查
   2. 移除书架页面的批量缓存统计
   3. 保留阅读器中的单章节清理逻辑
   4. 优化日志输出，移除"无需清理"噪音

🎯 优化效果：
   - 章节列表加载速度提升：100x+
   - 书架加载速度提升：50x+
   - 日志噪音减少：95%+
   - 用户体验改善：显著

🔍 清理逻辑变更：
   - 旧方式：每次打开章节列表检查所有章节（可能1000+次）
   - 新方式：只在用户点击阅读时检查当前章节（1次）

✅ 优化完成！
============================================================

00:13 +348 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +349 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +350 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +351 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +352 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +353 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +354 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +355 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +356 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +357 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +358 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +359 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +360 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +361 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +362 ~9 -45: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +362 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +363 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +363 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/reading_chapter_log_test.dart: 阅读章节日志测试 场景2：章节内容有有效媒体标记 - 应该看到验证日志 [E]
  SqfliteFfiException(sqlite_error: 5, , SqliteException(5): while executing, database is locked, database is locked (code 5)
    Causing statement: DELETE FROM scene_illustrations, parameters: }) DatabaseException(SqliteException(5): while executing, database is locked, database is locked (code 5)
    Causing statement: DELETE FROM scene_illustrations, parameters: ) sql 'DELETE FROM scene_illustrations' {details: {database: {path: D:\myspace\novel_builder\novel_app\.dart_tool\sqflite_common_ffi\databases\novel_reader.db, id: 1, readOnly: false, singleInstance: true}}}
  package:sqflite_common_ffi/src/method_call.dart 125:9  responseToResultOrThrow
  package:sqflite_common_ffi/src/isolate.dart 35:12      SqfliteIsolate.handle
  
00:13 +364 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +365 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +366 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +367 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +368 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +368 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/logger_service_test.dart: LoggerService LoggerService 性能测试 批量写入应减少持久化次数
批量写入100条日志耗时: 0ms
00:13 +369 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +370 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +370 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/reading_chapter_log_test.dart: 阅读章节日志测试 场景3：章节内容有无效媒体标记 - 应该看到清理日志

📖 场景3：阅读包含无效媒体标记的章节
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 第一次读取完成，内容长度: 67

📖 再次读取同一章节（验证已清理）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 第二次读取完成，内容长度: 67

⚠️ 注意：无效标记可能未被移除（取决于验证逻辑）
00:13 +371 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔内第二次 acquire() 应等待剩余时间
00:13 +372 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/reading_chapter_log_test.dart: 阅读章节日志测试 场景4：连续阅读多个章节 - 验证每次都会检查

📖 场景4：连续阅读5个章节（模拟用户连续阅读）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📚 正在读取第1章...
   ✅ 第1章读取完成，长度: 23

📚 正在读取第2章...
   ✅ 第2章读取完成，长度: 23

📚 正在读取第3章...
   ✅ 第3章读取完成，长度: 23

📚 正在读取第4章...
   ✅ 第4章读取完成，长度: 23

📚 正在读取第5章...
   ✅ 第5章读取完成，长度: 23

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 连续阅读完成

00:13 +373 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔超过指定时间后 acquire() 应立即返回
00:13 +373 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/reading_chapter_log_test.dart: 阅读章节日志测试 总结：日志输出行为

============================================================
📊 日志输出行为总结
============================================================

🔍 优化后的日志行为：

✅ 场景1：无媒体标记
   - 日志：无（已优化，不再输出"无需清理"）
   - 性能：极快（无数据库查询）

✅ 场景2：有有效媒体标记
   - 日志：🔍 检测到N个媒体标记
         🔍 验证插图标记 [id]: ✅ 有效
         ✅ 所有媒体标记均有效
   - 性能：快（需查询数据库验证）

✅ 场景3：有无效媒体标记
   - 日志：🔍 检测到N个媒体标记
         🔍 验证插图标记 [id]: ❌ 无效
         🧹 准备清理N个无效标记
         💾 章节内容已清理，正在更新数据库
         ✅ 数据库已更新
   - 性能：较慢（需验证并更新数据库）

✅ 场景4：连续阅读
   - 日志：每个章节独立输出（最多几行）
   - 性能：线性增长（每章约1ms）

📈 优化效果：
   - 旧方式：打开章节列表 = 1000+条日志
   - 新方式：阅读章节 = 0-5条日志/章
   - 日志减少：99%+

============================================================
00:13 +374 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 间隔超过指定时间后 acquire() 应立即返回
00:13 +375 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 基础功能 应使用自定义间隔时间
⏳ 速率限制: 等待 0 秒
00:13 +376 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 边界场景 零间隔应允许连续请求
00:13 +377 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 边界场景 极短间隔 (1ms) 应正确工作
00:13 +378 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 边界场景 长间隔 (60秒) 应正确计算等待时间
Error: Couldn't resolve the package 'mocktail' in 'package:mocktail/mocktail.dart'.
test/unit/services/unified_stream_manager_test.dart:4:8: Error: Not found: 'package:mocktail/mocktail.dart'
import 'package:mocktail/mocktail.dart';
       ^
test/unit/services/unified_stream_manager_test.dart:7:8: Error: Error when reading 'lib/services/unified_stream_manager.dart': 系统找不到指定的文件。

import '../../../lib/services/unified_stream_manager.dart';
       ^
test/unit/services/unified_stream_manager_test.dart:8:8: Error: Error when reading 'lib/models/stream_config.dart': 系统找不到指定的文件。

import '../../../lib/models/stream_config.dart';
       ^
test/unit/mocks/mock_dependencies.dart:7:8: Error: Not found: 'package:mocktail/mocktail.dart'
import 'package:mocktail/mocktail.dart';
       ^
00:13 +379 ~9 -46: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 边界场景 多次连续调用应依次等待
⏳ 速率限制: 等待 0 秒
test/unit/mocks/mock_dependencies.dart:11:30: Error: Type 'Mock' not found.
class MockHttpClient extends Mock implements http.Client {}
                             ^^^^
test/unit/mocks/mock_dependencies.dart:13:36: Error: Type 'Mock' not found.
class MockStreamedResponse extends Mock implements http.StreamedResponse {}
                                   ^^^^
test/unit/mocks/mock_dependencies.dart:15:41: Error: Type 'Mock' not found.
class MockStreamSubscription<T> extends Mock implements StreamSubscription<T> {}
                                        ^^^^
test/unit/mocks/mock_dependencies.dart:17:39: Error: Type 'Mock' not found.
class MockStreamController<T> extends Mock implements StreamController<T> {}
                                      ^^^^
test/unit/mocks/mock_dependencies.dart:19:27: Error: Type 'Mock' not found.
class MockRequest extends Mock implements http.Request {}
                          ^^^^
test/unit/mocks/mock_dependencies.dart:22:37: Error: Type 'Mock' not found.
class MockSharedPreferences extends Mock implements SharedPreferences {
                                    ^^^^
test/unit/mocks/mock_dependencies.dart:11:7: Error: The non-abstract class 'MockHttpClient' is missing implementations for these members:
 - Client.close
 - Client.delete
 - Client.get
 - Client.head
 - Client.patch
 - Client.post
 - Client.put
 - Client.read
 - Client.readBytes
 - Client.send
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockHttpClient extends Mock implements http.Client {}
      ^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:160:8: Context: 'Client.close' is defined here.
  void close();
       ^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:122:20: Context: 'Client.delete' is defined here.
  Future<Response> delete(Uri url,
                   ^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:52:20: Context: 'Client.get' is defined here.
  Future<Response> get(Uri url, {Map<String, String>? headers});
                   ^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:47:20: Context: 'Client.head' is defined here.
  Future<Response> head(Uri url, {Map<String, String>? headers});
                   ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:116:20: Context: 'Client.patch' is defined here.
  Future<Response> patch(Uri url,
                   ^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:74:20: Context: 'Client.post' is defined here.
  Future<Response> post(Uri url,
                   ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:95:20: Context: 'Client.put' is defined here.
  Future<Response> put(Uri url,
                   ^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:133:18: Context: 'Client.read' is defined here.
  Future<String> read(Uri url, {Map<String, String>? headers});
                 ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:144:21: Context: 'Client.readBytes' is defined here.
  Future<Uint8List> readBytes(Uri url, {Map<String, String>? headers});
                    ^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:147:28: Context: 'Client.send' is defined here.
  Future<StreamedResponse> send(BaseRequest request);
                           ^^^^
test/unit/mocks/mock_dependencies.dart:13:7: Error: The non-abstract class 'MockStreamedResponse' is missing implementations for these members:
 - BaseResponse.contentLength
 - BaseResponse.headers
 - BaseResponse.isRedirect
 - BaseResponse.persistentConnection
 - BaseResponse.reasonPhrase
 - BaseResponse.request
 - BaseResponse.statusCode
 - StreamedResponse.stream
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockStreamedResponse extends Mock implements http.StreamedResponse {}
      ^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:28:14: Context: 'BaseResponse.contentLength' is defined here.
  final int? contentLength;
             ^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:59:29: Context: 'BaseResponse.headers' is defined here.
  final Map<String, String> headers;
                            ^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:61:14: Context: 'BaseResponse.isRedirect' is defined here.
  final bool isRedirect;
             ^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:64:14: Context: 'BaseResponse.persistentConnection' is defined here.
  final bool persistentConnection;
             ^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:23:17: Context: 'BaseResponse.reasonPhrase' is defined here.
  final String? reasonPhrase;
                ^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:17:22: Context: 'BaseResponse.request' is defined here.
  final BaseRequest? request;
                     ^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:20:13: Context: 'BaseResponse.statusCode' is defined here.
  final int statusCode;
            ^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/streamed_response.dart:15:20: Context: 'StreamedResponse.stream' is defined here.
  final ByteStream stream;
                   ^^^^^^
test/unit/mocks/mock_dependencies.dart:15:7: Error: The non-abstract class 'MockStreamSubscription' is missing implementations for these members:
 - StreamSubscription.asFuture
 - StreamSubscription.cancel
 - StreamSubscription.isPaused
 - StreamSubscription.onData
 - StreamSubscription.onDone
 - StreamSubscription.onError
 - StreamSubscription.pause
 - StreamSubscription.resume
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockStreamSubscription<T> extends Mock implements StreamSubscription<T> {}
      ^^^^^^^^^^^^^^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2270:13: Context: 'StreamSubscription.asFuture' is defined here.
  Future<E> asFuture<E>([E? futureValue]);
            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2165:16: Context: 'StreamSubscription.cancel' is defined here.
  Future<void> cancel();
               ^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2254:12: Context: 'StreamSubscription.isPaused' is defined here.
  bool get isPaused;
           ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2175:8: Context: 'StreamSubscription.onData' is defined here.
  void onData(void handleData(T data)?);
       ^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2201:8: Context: 'StreamSubscription.onDone' is defined here.
  void onDone(void handleDone()?);
       ^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2192:8: Context: 'StreamSubscription.onError' is defined here.
  void onError(Function? handleError);
       ^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2233:8: Context: 'StreamSubscription.pause' is defined here.
  void pause([Future<void>? resumeSignal]);
       ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2244:8: Context: 'StreamSubscription.resume' is defined here.
  void resume();
       ^^^^^^
test/unit/mocks/mock_dependencies.dart:17:7: Error: The non-abstract class 'MockStreamController' is missing implementations for these members:
 - EventSink.add
 - EventSink.addError
 - EventSink.close
 - Sink.add
 - Sink.close
 - StreamConsumer.addStream
 - StreamConsumer.close
 - StreamController.add
 - StreamController.addError
 - StreamController.addStream
 - StreamController.close
 - StreamController.done
 - StreamController.hasListener
 - StreamController.isClosed
 - StreamController.isPaused
 - StreamController.onCancel
 - StreamController.onCancel=
 - StreamController.onListen
 - StreamController.onListen=
 - StreamController.onPause
 - StreamController.onPause=
 - StreamController.onResume
 - StreamController.onResume=
 - StreamController.sink
 - StreamController.stream
 - StreamSink.close
 - StreamSink.done
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockStreamController<T> extends Mock implements StreamController<T> {}
      ^^^^^^^^^^^^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2285:8: Context: 'EventSink.add' is defined here.
  void add(T event);
       ^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2290:8: Context: 'EventSink.addError' is defined here.
  void addError(Object error, [StackTrace? stackTrace]);
       ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2297:8: Context: 'EventSink.close' is defined here.
  void close();
       ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/core/sink.dart:17:8: Context: 'Sink.add' is defined here.
  void add(T data);
       ^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/core/sink.dart:24:8: Context: 'Sink.close' is defined here.
  void close();
       ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2354:10: Context: 'StreamConsumer.addStream' is defined here.
  Future addStream(Stream<S> stream);
         ^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2364:10: Context: 'StreamConsumer.close' is defined here.
  Future close();
         ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:244:8: Context: 'StreamController.add' is defined here.
  void add(T event);
       ^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:252:8: Context: 'StreamController.addError' is defined here.
  void addError(Object error, [StackTrace? stackTrace]);
       ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:312:10: Context: 'StreamController.addStream' is defined here.
  Future addStream(Stream<T> source, {bool? cancelOnError});
         ^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:274:10: Context: 'StreamController.close' is defined here.
  Future close();
         ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:293:14: Context: 'StreamController.done' is defined here.
  Future get done;
             ^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:232:12: Context: 'StreamController.hasListener' is defined here.
  bool get hasListener;
           ^^^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:218:12: Context: 'StreamController.isClosed' is defined here.
  bool get isClosed;
           ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:229:12: Context: 'StreamController.isPaused' is defined here.
  bool get isPaused;
           ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:204:39: Context: 'StreamController.onCancel' is defined here.
  abstract FutureOr<void> Function()? onCancel;
                                      ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:204:39: Context: 'StreamController.onCancel=' is defined here.
  abstract FutureOr<void> Function()? onCancel;
                                      ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:185:29: Context: 'StreamController.onListen' is defined here.
  abstract void Function()? onListen;
                            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:185:29: Context: 'StreamController.onListen=' is defined here.
  abstract void Function()? onListen;
                            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:192:29: Context: 'StreamController.onPause' is defined here.
  abstract void Function()? onPause;
                            ^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:192:29: Context: 'StreamController.onPause=' is defined here.
  abstract void Function()? onPause;
                            ^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:199:29: Context: 'StreamController.onResume' is defined here.
  abstract void Function()? onResume;
                            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:199:29: Context: 'StreamController.onResume=' is defined here.
  abstract void Function()? onResume;
                            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:207:21: Context: 'StreamController.sink' is defined here.
  StreamSink<T> get sink;
                    ^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:72:17: Context: 'StreamController.stream' is defined here.
  Stream<T> get stream;
                ^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2403:10: Context: 'StreamSink.close' is defined here.
  Future close();
         ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2416:14: Context: 'StreamSink.done' is defined here.
  Future get done;
             ^^^^
test/unit/mocks/mock_dependencies.dart:19:7: Error: The non-abstract class 'MockRequest' is missing implementations for these members:
 - BaseRequest.finalized
 - BaseRequest.followRedirects
 - BaseRequest.followRedirects=
 - BaseRequest.headers
 - BaseRequest.maxRedirects
 - BaseRequest.maxRedirects=
 - BaseRequest.method
 - BaseRequest.persistentConnection
 - BaseRequest.persistentConnection=
 - BaseRequest.send
 - BaseRequest.url
 - Request.body
 - Request.body=
 - Request.bodyBytes
 - Request.bodyBytes=
 - Request.bodyFields
 - Request.bodyFields=
 - Request.contentLength
 - Request.contentLength=
 - Request.encoding
 - Request.encoding=
 - Request.finalize
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockRequest extends Mock implements http.Request {}
      ^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:99:12: Context: 'BaseRequest.finalized' is defined here.
  bool get finalized => _finalized;
           ^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:67:12: Context: 'BaseRequest.followRedirects' is defined here.
  bool get followRedirects => _followRedirects;
           ^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:70:7: Context: 'BaseRequest.followRedirects=' is defined here.
  set followRedirects(bool value) {
      ^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:96:29: Context: 'BaseRequest.headers' is defined here.
  final Map<String, String> headers;
                            ^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:79:11: Context: 'BaseRequest.maxRedirects' is defined here.
  int get maxRedirects => _maxRedirects;
          ^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:82:7: Context: 'BaseRequest.maxRedirects=' is defined here.
  set maxRedirects(int value) {
      ^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:33:16: Context: 'BaseRequest.method' is defined here.
  final String method;
               ^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:56:12: Context: 'BaseRequest.persistentConnection' is defined here.
  bool get persistentConnection => _persistentConnection;
           ^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:59:7: Context: 'BaseRequest.persistentConnection=' is defined here.
  set persistentConnection(bool value) {
      ^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:140:28: Context: 'BaseRequest.send' is defined here.
  Future<StreamedResponse> send() async {
                           ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:36:13: Context: 'BaseRequest.url' is defined here.
  final Uri url;
            ^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:102:14: Context: 'Request.body' is defined here.
  String get body => encoding.decode(bodyBytes);
             ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:104:7: Context: 'Request.body=' is defined here.
  set body(String value) {
      ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:83:17: Context: 'Request.bodyBytes' is defined here.
  Uint8List get bodyBytes => _bodyBytes;
                ^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:86:7: Context: 'Request.bodyBytes=' is defined here.
  set bodyBytes(List<int> value) {
      ^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:130:27: Context: 'Request.bodyFields' is defined here.
  Map<String, String> get bodyFields {
                          ^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:141:7: Context: 'Request.bodyFields=' is defined here.
  set bodyFields(Map<String, String> fields) {
      ^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:23:11: Context: 'Request.contentLength' is defined here.
  int get contentLength => bodyBytes.length;
          ^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:26:7: Context: 'Request.contentLength=' is defined here.
  set contentLength(int? value) {
      ^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:52:16: Context: 'Request.encoding' is defined here.
  Encoding get encoding {
               ^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:60:7: Context: 'Request.encoding=' is defined here.
  set encoding(Encoding value) {
      ^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:160:14: Context: 'Request.finalize' is defined here.
  ByteStream finalize() {
             ^^^^^^^^
test/unit/mocks/mock_dependencies.dart:22:7: Error: The non-abstract class 'MockSharedPreferences' is missing implementations for these members:
 - SharedPreferences.commit
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockSharedPreferences extends Mock implements SharedPreferences {
      ^^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/shared_preferences-2.5.3/lib/src/shared_preferences_legacy.dart:193:16: Context: 'SharedPreferences.commit' is defined here.
  Future<bool> commit() async => true;
               ^^^^^^
test/unit/services/unified_stream_manager_test.dart:13:10: Error: 'UnifiedStreamManager' isn't a type.
    late UnifiedStreamManager streamManager;
         ^^^^^^^^^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:18:23: Error: Method not found: 'UnifiedStreamManager'.
      streamManager = UnifiedStreamManager();
                      ^^^^^^^^^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:23:7: Error: Method not found: 'when'.
      when(() => mockPrefs.getString('dify_url'))
      ^^^^
test/unit/services/unified_stream_manager_test.dart:25:7: Error: Method not found: 'when'.
      when(() => mockPrefs.getString('dify_flow_token'))
      ^^^^
test/unit/services/unified_stream_manager_test.dart:51:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:81:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:104:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:136:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:162:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:186:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:207:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:228:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:256:25: Error: Undefined name 'StreamConfig'.
        final config1 = StreamConfig.sceneDescription(
                        ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:260:25: Error: Undefined name 'StreamConfig'.
        final config2 = StreamConfig.custom(
                        ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:288:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:322:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:347:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:379:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.custom(
                       ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:409:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/services/unified_stream_manager_test.dart:429:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/mocks/mock_dependencies.dart:106:5: Error: Method not found: 'when'.
    when(() => response.statusCode).thenReturn(statusCode);
    ^^^^
test/unit/mocks/mock_dependencies.dart:109:7: Error: Method not found: 'when'.
      when(() => response.stream)
      ^^^^
test/unit/mocks/mock_dependencies.dart:112:7: Error: Method not found: 'when'.
      when(() => response.stream)
      ^^^^
test/unit/mocks/mock_dependencies.dart:282:3: Error: Method not found: 'registerFallbackValue'.
  registerFallbackValue(Uri());
  ^^^^^^^^^^^^^^^^^^^^^
test/unit/mocks/mock_dependencies.dart:283:3: Error: Method not found: 'registerFallbackValue'.
  registerFallbackValue(http.Request('POST', Uri()));
  ^^^^^^^^^^^^^^^^^^^^^
test/unit/mocks/mock_dependencies.dart:284:3: Error: Method not found: 'registerFallbackValue'.
  registerFallbackValue(StreamController<String>());
  ^^^^^^^^^^^^^^^^^^^^^
test/unit/mocks/mock_dependencies.dart:285:3: Error: Method not found: 'registerFallbackValue'.
  registerFallbackValue(const Duration(milliseconds: 100));
  ^^^^^^^^^^^^^^^^^^^^^
⏳ 速率限制: 等待 0 秒
00:13 +379 ~9 -47: loading D:/myspace/novel_builder/novel_app/test/unit/services/unified_stream_manager_test.dart [E]
  Failed to load "D:/myspace/novel_builder/novel_app/test/unit/services/unified_stream_manager_test.dart":
  Compilation failed for testPath=D:/myspace/novel_builder/novel_app/test/unit/services/unified_stream_manager_test.dart: Error: Couldn't resolve the package 'mocktail' in 'package:mocktail/mocktail.dart'.
  test/unit/services/unified_stream_manager_test.dart:4:8: Error: Not found: 'package:mocktail/mocktail.dart'
  import 'package:mocktail/mocktail.dart';
         ^
  test/unit/services/unified_stream_manager_test.dart:7:8: Error: Error when reading 'lib/services/unified_stream_manager.dart': 系统找不到指定的文件。
  
  import '../../../lib/services/unified_stream_manager.dart';
         ^
  test/unit/services/unified_stream_manager_test.dart:8:8: Error: Error when reading 'lib/models/stream_config.dart': 系统找不到指定的文件。
  
  import '../../../lib/models/stream_config.dart';
         ^
  test/unit/mocks/mock_dependencies.dart:7:8: Error: Not found: 'package:mocktail/mocktail.dart'
  import 'package:mocktail/mocktail.dart';
         ^
  test/unit/mocks/mock_dependencies.dart:11:30: Error: Type 'Mock' not found.
  class MockHttpClient extends Mock implements http.Client {}
                               ^^^^
  test/unit/mocks/mock_dependencies.dart:13:36: Error: Type 'Mock' not found.
  class MockStreamedResponse extends Mock implements http.StreamedResponse {}
                                     ^^^^
  test/unit/mocks/mock_dependencies.dart:15:41: Error: Type 'Mock' not found.
  class MockStreamSubscription<T> extends Mock implements StreamSubscription<T> {}
                                          ^^^^
  test/unit/mocks/mock_dependencies.dart:17:39: Error: Type 'Mock' not found.
  class MockStreamController<T> extends Mock implements StreamController<T> {}
                                        ^^^^
  test/unit/mocks/mock_dependencies.dart:19:27: Error: Type 'Mock' not found.
  class MockRequest extends Mock implements http.Request {}
                            ^^^^
  test/unit/mocks/mock_dependencies.dart:22:37: Error: Type 'Mock' not found.
  class MockSharedPreferences extends Mock implements SharedPreferences {
                                      ^^^^
  test/unit/mocks/mock_dependencies.dart:11:7: Error: The non-abstract class 'MockHttpClient' is missing implementations for these members:
   - Client.close
   - Client.delete
   - Client.get
   - Client.head
   - Client.patch
   - Client.post
   - Client.put
   - Client.read
   - Client.readBytes
   - Client.send
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockHttpClient extends Mock implements http.Client {}
        ^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:160:8: Context: 'Client.close' is defined here.
    void close();
         ^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:122:20: Context: 'Client.delete' is defined here.
    Future<Response> delete(Uri url,
                     ^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:52:20: Context: 'Client.get' is defined here.
    Future<Response> get(Uri url, {Map<String, String>? headers});
                     ^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:47:20: Context: 'Client.head' is defined here.
    Future<Response> head(Uri url, {Map<String, String>? headers});
                     ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:116:20: Context: 'Client.patch' is defined here.
    Future<Response> patch(Uri url,
                     ^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:74:20: Context: 'Client.post' is defined here.
    Future<Response> post(Uri url,
                     ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:95:20: Context: 'Client.put' is defined here.
    Future<Response> put(Uri url,
                     ^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:133:18: Context: 'Client.read' is defined here.
    Future<String> read(Uri url, {Map<String, String>? headers});
                   ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:144:21: Context: 'Client.readBytes' is defined here.
    Future<Uint8List> readBytes(Uri url, {Map<String, String>? headers});
                      ^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:147:28: Context: 'Client.send' is defined here.
    Future<StreamedResponse> send(BaseRequest request);
                             ^^^^
  test/unit/mocks/mock_dependencies.dart:13:7: Error: The non-abstract class 'MockStreamedResponse' is missing implementations for these members:
   - BaseResponse.contentLength
   - BaseResponse.headers
   - BaseResponse.isRedirect
   - BaseResponse.persistentConnection
   - BaseResponse.reasonPhrase
   - BaseResponse.request
   - BaseResponse.statusCode
   - StreamedResponse.stream
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockStreamedResponse extends Mock implements http.StreamedResponse {}
        ^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:28:14: Context: 'BaseResponse.contentLength' is defined here.
    final int? contentLength;
               ^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:59:29: Context: 'BaseResponse.headers' is defined here.
    final Map<String, String> headers;
                              ^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:61:14: Context: 'BaseResponse.isRedirect' is defined here.
    final bool isRedirect;
               ^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:64:14: Context: 'BaseResponse.persistentConnection' is defined here.
    final bool persistentConnection;
               ^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:23:17: Context: 'BaseResponse.reasonPhrase' is defined here.
    final String? reasonPhrase;
                  ^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:17:22: Context: 'BaseResponse.request' is defined here.
    final BaseRequest? request;
                       ^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:20:13: Context: 'BaseResponse.statusCode' is defined here.
    final int statusCode;
              ^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/streamed_response.dart:15:20: Context: 'StreamedResponse.stream' is defined here.
    final ByteStream stream;
                     ^^^^^^
  test/unit/mocks/mock_dependencies.dart:15:7: Error: The non-abstract class 'MockStreamSubscription' is missing implementations for these members:
   - StreamSubscription.asFuture
   - StreamSubscription.cancel
   - StreamSubscription.isPaused
   - StreamSubscription.onData
   - StreamSubscription.onDone
   - StreamSubscription.onError
   - StreamSubscription.pause
   - StreamSubscription.resume
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockStreamSubscription<T> extends Mock implements StreamSubscription<T> {}
        ^^^^^^^^^^^^^^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2270:13: Context: 'StreamSubscription.asFuture' is defined here.
    Future<E> asFuture<E>([E? futureValue]);
              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2165:16: Context: 'StreamSubscription.cancel' is defined here.
    Future<void> cancel();
                 ^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2254:12: Context: 'StreamSubscription.isPaused' is defined here.
    bool get isPaused;
             ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2175:8: Context: 'StreamSubscription.onData' is defined here.
    void onData(void handleData(T data)?);
         ^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2201:8: Context: 'StreamSubscription.onDone' is defined here.
    void onDone(void handleDone()?);
         ^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2192:8: Context: 'StreamSubscription.onError' is defined here.
    void onError(Function? handleError);
         ^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2233:8: Context: 'StreamSubscription.pause' is defined here.
    void pause([Future<void>? resumeSignal]);
         ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2244:8: Context: 'StreamSubscription.resume' is defined here.
    void resume();
         ^^^^^^
  test/unit/mocks/mock_dependencies.dart:17:7: Error: The non-abstract class 'MockStreamController' is missing implementations for these members:
   - EventSink.add
   - EventSink.addError
   - EventSink.close
   - Sink.add
   - Sink.close
   - StreamConsumer.addStream
   - StreamConsumer.close
   - StreamController.add
   - StreamController.addError
   - StreamController.addStream
   - StreamController.close
   - StreamController.done
   - StreamController.hasListener
   - StreamController.isClosed
   - StreamController.isPaused
   - StreamController.onCancel
   - StreamController.onCancel=
   - StreamController.onListen
   - StreamController.onListen=
   - StreamController.onPause
   - StreamController.onPause=
   - StreamController.onResume
   - StreamController.onResume=
   - StreamController.sink
   - StreamController.stream
   - StreamSink.close
   - StreamSink.done
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockStreamController<T> extends Mock implements StreamController<T> {}
        ^^^^^^^^^^^^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2285:8: Context: 'EventSink.add' is defined here.
    void add(T event);
         ^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2290:8: Context: 'EventSink.addError' is defined here.
    void addError(Object error, [StackTrace? stackTrace]);
         ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2297:8: Context: 'EventSink.close' is defined here.
    void close();
         ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/core/sink.dart:17:8: Context: 'Sink.add' is defined here.
    void add(T data);
         ^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/core/sink.dart:24:8: Context: 'Sink.close' is defined here.
    void close();
         ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2354:10: Context: 'StreamConsumer.addStream' is defined here.
    Future addStream(Stream<S> stream);
           ^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2364:10: Context: 'StreamConsumer.close' is defined here.
    Future close();
           ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:244:8: Context: 'StreamController.add' is defined here.
    void add(T event);
         ^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:252:8: Context: 'StreamController.addError' is defined here.
    void addError(Object error, [StackTrace? stackTrace]);
         ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:312:10: Context: 'StreamController.addStream' is defined here.
    Future addStream(Stream<T> source, {bool? cancelOnError});
           ^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:274:10: Context: 'StreamController.close' is defined here.
    Future close();
           ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:293:14: Context: 'StreamController.done' is defined here.
    Future get done;
               ^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:232:12: Context: 'StreamController.hasListener' is defined here.
    bool get hasListener;
             ^^^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:218:12: Context: 'StreamController.isClosed' is defined here.
    bool get isClosed;
             ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:229:12: Context: 'StreamController.isPaused' is defined here.
    bool get isPaused;
             ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:204:39: Context: 'StreamController.onCancel' is defined here.
    abstract FutureOr<void> Function()? onCancel;
                                        ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:204:39: Context: 'StreamController.onCancel=' is defined here.
    abstract FutureOr<void> Function()? onCancel;
                                        ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:185:29: Context: 'StreamController.onListen' is defined here.
    abstract void Function()? onListen;
                              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:185:29: Context: 'StreamController.onListen=' is defined here.
    abstract void Function()? onListen;
                              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:192:29: Context: 'StreamController.onPause' is defined here.
    abstract void Function()? onPause;
                              ^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:192:29: Context: 'StreamController.onPause=' is defined here.
    abstract void Function()? onPause;
                              ^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:199:29: Context: 'StreamController.onResume' is defined here.
    abstract void Function()? onResume;
                              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:199:29: Context: 'StreamController.onResume=' is defined here.
    abstract void Function()? onResume;
                              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:207:21: Context: 'StreamController.sink' is defined here.
    StreamSink<T> get sink;
                      ^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:72:17: Context: 'StreamController.stream' is defined here.
    Stream<T> get stream;
                  ^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2403:10: Context: 'StreamSink.close' is defined here.
    Future close();
           ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2416:14: Context: 'StreamSink.done' is defined here.
    Future get done;
               ^^^^
  test/unit/mocks/mock_dependencies.dart:19:7: Error: The non-abstract class 'MockRequest' is missing implementations for these members:
   - BaseRequest.finalized
   - BaseRequest.followRedirects
   - BaseRequest.followRedirects=
   - BaseRequest.headers
   - BaseRequest.maxRedirects
   - BaseRequest.maxRedirects=
   - BaseRequest.method
   - BaseRequest.persistentConnection
   - BaseRequest.persistentConnection=
   - BaseRequest.send
   - BaseRequest.url
   - Request.body
   - Request.body=
   - Request.bodyBytes
   - Request.bodyBytes=
   - Request.bodyFields
   - Request.bodyFields=
   - Request.contentLength
   - Request.contentLength=
   - Request.encoding
   - Request.encoding=
   - Request.finalize
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockRequest extends Mock implements http.Request {}
        ^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:99:12: Context: 'BaseRequest.finalized' is defined here.
    bool get finalized => _finalized;
             ^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:67:12: Context: 'BaseRequest.followRedirects' is defined here.
    bool get followRedirects => _followRedirects;
             ^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:70:7: Context: 'BaseRequest.followRedirects=' is defined here.
    set followRedirects(bool value) {
        ^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:96:29: Context: 'BaseRequest.headers' is defined here.
    final Map<String, String> headers;
                              ^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:79:11: Context: 'BaseRequest.maxRedirects' is defined here.
    int get maxRedirects => _maxRedirects;
            ^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:82:7: Context: 'BaseRequest.maxRedirects=' is defined here.
    set maxRedirects(int value) {
        ^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:33:16: Context: 'BaseRequest.method' is defined here.
    final String method;
                 ^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:56:12: Context: 'BaseRequest.persistentConnection' is defined here.
    bool get persistentConnection => _persistentConnection;
             ^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:59:7: Context: 'BaseRequest.persistentConnection=' is defined here.
    set persistentConnection(bool value) {
        ^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:140:28: Context: 'BaseRequest.send' is defined here.
    Future<StreamedResponse> send() async {
                             ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:36:13: Context: 'BaseRequest.url' is defined here.
    final Uri url;
              ^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:102:14: Context: 'Request.body' is defined here.
    String get body => encoding.decode(bodyBytes);
               ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:104:7: Context: 'Request.body=' is defined here.
    set body(String value) {
        ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:83:17: Context: 'Request.bodyBytes' is defined here.
    Uint8List get bodyBytes => _bodyBytes;
                  ^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:86:7: Context: 'Request.bodyBytes=' is defined here.
    set bodyBytes(List<int> value) {
        ^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:130:27: Context: 'Request.bodyFields' is defined here.
    Map<String, String> get bodyFields {
                            ^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:141:7: Context: 'Request.bodyFields=' is defined here.
    set bodyFields(Map<String, String> fields) {
        ^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:23:11: Context: 'Request.contentLength' is defined here.
    int get contentLength => bodyBytes.length;
            ^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:26:7: Context: 'Request.contentLength=' is defined here.
    set contentLength(int? value) {
        ^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:52:16: Context: 'Request.encoding' is defined here.
    Encoding get encoding {
                 ^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:60:7: Context: 'Request.encoding=' is defined here.
    set encoding(Encoding value) {
        ^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:160:14: Context: 'Request.finalize' is defined here.
    ByteStream finalize() {
               ^^^^^^^^
  test/unit/mocks/mock_dependencies.dart:22:7: Error: The non-abstract class 'MockSharedPreferences' is missing implementations for these members:
   - SharedPreferences.commit
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockSharedPreferences extends Mock implements SharedPreferences {
        ^^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/shared_preferences-2.5.3/lib/src/shared_preferences_legacy.dart:193:16: Context: 'SharedPreferences.commit' is defined here.
    Future<bool> commit() async => true;
                 ^^^^^^
  test/unit/services/unified_stream_manager_test.dart:13:10: Error: 'UnifiedStreamManager' isn't a type.
      late UnifiedStreamManager streamManager;
           ^^^^^^^^^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:18:23: Error: Method not found: 'UnifiedStreamManager'.
        streamManager = UnifiedStreamManager();
                        ^^^^^^^^^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:23:7: Error: Method not found: 'when'.
        when(() => mockPrefs.getString('dify_url'))
        ^^^^
  test/unit/services/unified_stream_manager_test.dart:25:7: Error: Method not found: 'when'.
        when(() => mockPrefs.getString('dify_flow_token'))
        ^^^^
  test/unit/services/unified_stream_manager_test.dart:51:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:81:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:104:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:136:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:162:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:186:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:207:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:228:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:256:25: Error: Undefined name 'StreamConfig'.
          final config1 = StreamConfig.sceneDescription(
                          ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:260:25: Error: Undefined name 'StreamConfig'.
          final config2 = StreamConfig.custom(
                          ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:288:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:322:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:347:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:379:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.custom(
                         ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:409:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/services/unified_stream_manager_test.dart:429:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/mocks/mock_dependencies.dart:106:5: Error: Method not found: 'when'.
      when(() => response.statusCode).thenReturn(statusCode);
      ^^^^
  test/unit/mocks/mock_dependencies.dart:109:7: Error: Method not found: 'when'.
        when(() => response.stream)
        ^^^^
  test/unit/mocks/mock_dependencies.dart:112:7: Error: Method not found: 'when'.
        when(() => response.stream)
        ^^^^
  test/unit/mocks/mock_dependencies.dart:282:3: Error: Method not found: 'registerFallbackValue'.
    registerFallbackValue(Uri());
    ^^^^^^^^^^^^^^^^^^^^^
  test/unit/mocks/mock_dependencies.dart:283:3: Error: Method not found: 'registerFallbackValue'.
    registerFallbackValue(http.Request('POST', Uri()));
    ^^^^^^^^^^^^^^^^^^^^^
  test/unit/mocks/mock_dependencies.dart:284:3: Error: Method not found: 'registerFallbackValue'.
    registerFallbackValue(StreamController<String>());
    ^^^^^^^^^^^^^^^^^^^^^
  test/unit/mocks/mock_dependencies.dart:285:3: Error: Method not found: 'registerFallbackValue'.
    registerFallbackValue(const Duration(milliseconds: 100));
    ^^^^^^^^^^^^^^^^^^^^^
  .
00:13 +380 ~9 -47: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 重置功能 reset() 后应清除等待时间
🔄 速率限制器已重置
00:13 +381 ~9 -47: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 重置功能 reset() 多次调用应安全
🔄 速率限制器已重置
🔄 速率限制器已重置
🔄 速率限制器已重置
00:13 +382 ~9 -47: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 重置功能 reset() 后状态查询应返回初始值
🔄 速率限制器已重置
00:13 +383 ~9 -47: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 状态查询 首次调用前 canRequestImmediately 应返回 true
00:13 +384 ~9 -47: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 状态查询 首次调用后 canRequestImmediately 应返回 false
00:13 +385 ~9 -47: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 状态查询 间隔超过后 canRequestImmediately 应返回 true
00:13 +386 ~9 -47: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 状态查询 timeUntilNextRequest 首次调用前应返回 zero
00:13 +387 ~9 -47: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 状态查询 timeUntilNextRequest 应正确计算剩余时间
00:13 +388 ~9 -47: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 状态查询 timeUntilNextRequest 间隔超过后应返回 zero
00:14 +389 ~9 -47: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 并发场景 并发调用 acquire() 会同时启动但等待时间不同
⏳ 速率限制: 等待 0 秒
⏳ 速率限制: 等待 0 秒
00:14 +390 ~9 -47: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 并发场景 并发调用时状态查询应正确
⏳ 速率限制: 等待 0 秒
00:14 +391 ~9 -47: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 并发场景 并发场景下 reset() 应影响所有等待的请求
⏳ 速率限制: 等待 1 秒
Error: Couldn't resolve the package 'mocktail' in 'package:mocktail/mocktail.dart'.
test/unit/stream_processing_basic_test.dart:2:8: Error: Not found: 'package:mocktail/mocktail.dart'
import 'package:mocktail/mocktail.dart';
       ^
test/unit/mocks/mock_dependencies.dart:7:8: Error: Not found: 'package:mocktail/mocktail.dart'
import 'package:mocktail/mocktail.dart';
       ^
test/unit/mocks/mock_dependencies.dart:11:30: Error: Type 'Mock' not found.
class MockHttpClient extends Mock implements http.Client {}
                             ^^^^
test/unit/mocks/mock_dependencies.dart:13:36: Error: Type 'Mock' not found.
class MockStreamedResponse extends Mock implements http.StreamedResponse {}
                                   ^^^^
test/unit/mocks/mock_dependencies.dart:15:41: Error: Type 'Mock' not found.
class MockStreamSubscription<T> extends Mock implements StreamSubscription<T> {}
                                        ^^^^
test/unit/mocks/mock_dependencies.dart:17:39: Error: Type 'Mock' not found.
class MockStreamController<T> extends Mock implements StreamController<T> {}
                                      ^^^^
test/unit/mocks/mock_dependencies.dart:19:27: Error: Type 'Mock' not found.
class MockRequest extends Mock implements http.Request {}
                          ^^^^
test/unit/mocks/mock_dependencies.dart:22:37: Error: Type 'Mock' not found.
class MockSharedPreferences extends Mock implements SharedPreferences {
                                    ^^^^
test/unit/mocks/mock_dependencies.dart:11:7: Error: The non-abstract class 'MockHttpClient' is missing implementations for these members:
 - Client.close
 - Client.delete
 - Client.get
 - Client.head
 - Client.patch
 - Client.post
 - Client.put
 - Client.read
 - Client.readBytes
 - Client.send
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockHttpClient extends Mock implements http.Client {}
      ^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:160:8: Context: 'Client.close' is defined here.
  void close();
       ^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:122:20: Context: 'Client.delete' is defined here.
  Future<Response> delete(Uri url,
                   ^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:52:20: Context: 'Client.get' is defined here.
  Future<Response> get(Uri url, {Map<String, String>? headers});
                   ^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:47:20: Context: 'Client.head' is defined here.
  Future<Response> head(Uri url, {Map<String, String>? headers});
                   ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:116:20: Context: 'Client.patch' is defined here.
  Future<Response> patch(Uri url,
                   ^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:74:20: Context: 'Client.post' is defined here.
  Future<Response> post(Uri url,
                   ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:95:20: Context: 'Client.put' is defined here.
  Future<Response> put(Uri url,
                   ^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:133:18: Context: 'Client.read' is defined here.
  Future<String> read(Uri url, {Map<String, String>? headers});
                 ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:144:21: Context: 'Client.readBytes' is defined here.
  Future<Uint8List> readBytes(Uri url, {Map<String, String>? headers});
                    ^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:147:28: Context: 'Client.send' is defined here.
  Future<StreamedResponse> send(BaseRequest request);
                           ^^^^
test/unit/mocks/mock_dependencies.dart:13:7: Error: The non-abstract class 'MockStreamedResponse' is missing implementations for these members:
 - BaseResponse.contentLength
 - BaseResponse.headers
 - BaseResponse.isRedirect
 - BaseResponse.persistentConnection
 - BaseResponse.reasonPhrase
 - BaseResponse.request
 - BaseResponse.statusCode
 - StreamedResponse.stream
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockStreamedResponse extends Mock implements http.StreamedResponse {}
      ^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:28:14: Context: 'BaseResponse.contentLength' is defined here.
  final int? contentLength;
             ^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:59:29: Context: 'BaseResponse.headers' is defined here.
  final Map<String, String> headers;
                            ^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:61:14: Context: 'BaseResponse.isRedirect' is defined here.
  final bool isRedirect;
             ^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:64:14: Context: 'BaseResponse.persistentConnection' is defined here.
  final bool persistentConnection;
             ^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:23:17: Context: 'BaseResponse.reasonPhrase' is defined here.
  final String? reasonPhrase;
                ^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:17:22: Context: 'BaseResponse.request' is defined here.
  final BaseRequest? request;
                     ^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:20:13: Context: 'BaseResponse.statusCode' is defined here.
  final int statusCode;
            ^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/streamed_response.dart:15:20: Context: 'StreamedResponse.stream' is defined here.
  final ByteStream stream;
                   ^^^^^^
test/unit/mocks/mock_dependencies.dart:15:7: Error: The non-abstract class 'MockStreamSubscription' is missing implementations for these members:
 - StreamSubscription.asFuture
 - StreamSubscription.cancel
 - StreamSubscription.isPaused
 - StreamSubscription.onData
 - StreamSubscription.onDone
 - StreamSubscription.onError
 - StreamSubscription.pause
 - StreamSubscription.resume
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockStreamSubscription<T> extends Mock implements StreamSubscription<T> {}
      ^^^^^^^^^^^^^^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2270:13: Context: 'StreamSubscription.asFuture' is defined here.
  Future<E> asFuture<E>([E? futureValue]);
            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2165:16: Context: 'StreamSubscription.cancel' is defined here.
  Future<void> cancel();
               ^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2254:12: Context: 'StreamSubscription.isPaused' is defined here.
  bool get isPaused;
           ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2175:8: Context: 'StreamSubscription.onData' is defined here.
  void onData(void handleData(T data)?);
       ^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2201:8: Context: 'StreamSubscription.onDone' is defined here.
  void onDone(void handleDone()?);
       ^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2192:8: Context: 'StreamSubscription.onError' is defined here.
  void onError(Function? handleError);
       ^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2233:8: Context: 'StreamSubscription.pause' is defined here.
  void pause([Future<void>? resumeSignal]);
       ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2244:8: Context: 'StreamSubscription.resume' is defined here.
  void resume();
       ^^^^^^
test/unit/mocks/mock_dependencies.dart:17:7: Error: The non-abstract class 'MockStreamController' is missing implementations for these members:
 - EventSink.add
 - EventSink.addError
 - EventSink.close
 - Sink.add
 - Sink.close
 - StreamConsumer.addStream
 - StreamConsumer.close
 - StreamController.add
 - StreamController.addError
 - StreamController.addStream
 - StreamController.close
 - StreamController.done
 - StreamController.hasListener
 - StreamController.isClosed
 - StreamController.isPaused
 - StreamController.onCancel
 - StreamController.onCancel=
 - StreamController.onListen
 - StreamController.onListen=
 - StreamController.onPause
 - StreamController.onPause=
 - StreamController.onResume
 - StreamController.onResume=
 - StreamController.sink
 - StreamController.stream
 - StreamSink.close
 - StreamSink.done
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockStreamController<T> extends Mock implements StreamController<T> {}
      ^^^^^^^^^^^^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2285:8: Context: 'EventSink.add' is defined here.
  void add(T event);
       ^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2290:8: Context: 'EventSink.addError' is defined here.
  void addError(Object error, [StackTrace? stackTrace]);
       ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2297:8: Context: 'EventSink.close' is defined here.
  void close();
       ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/core/sink.dart:17:8: Context: 'Sink.add' is defined here.
  void add(T data);
       ^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/core/sink.dart:24:8: Context: 'Sink.close' is defined here.
  void close();
       ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2354:10: Context: 'StreamConsumer.addStream' is defined here.
  Future addStream(Stream<S> stream);
         ^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2364:10: Context: 'StreamConsumer.close' is defined here.
  Future close();
         ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:244:8: Context: 'StreamController.add' is defined here.
  void add(T event);
       ^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:252:8: Context: 'StreamController.addError' is defined here.
  void addError(Object error, [StackTrace? stackTrace]);
       ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:312:10: Context: 'StreamController.addStream' is defined here.
  Future addStream(Stream<T> source, {bool? cancelOnError});
         ^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:274:10: Context: 'StreamController.close' is defined here.
  Future close();
         ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:293:14: Context: 'StreamController.done' is defined here.
  Future get done;
             ^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:232:12: Context: 'StreamController.hasListener' is defined here.
  bool get hasListener;
           ^^^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:218:12: Context: 'StreamController.isClosed' is defined here.
  bool get isClosed;
           ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:229:12: Context: 'StreamController.isPaused' is defined here.
  bool get isPaused;
           ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:204:39: Context: 'StreamController.onCancel' is defined here.
  abstract FutureOr<void> Function()? onCancel;
                                      ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:204:39: Context: 'StreamController.onCancel=' is defined here.
  abstract FutureOr<void> Function()? onCancel;
                                      ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:185:29: Context: 'StreamController.onListen' is defined here.
  abstract void Function()? onListen;
                            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:185:29: Context: 'StreamController.onListen=' is defined here.
  abstract void Function()? onListen;
                            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:192:29: Context: 'StreamController.onPause' is defined here.
  abstract void Function()? onPause;
                            ^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:192:29: Context: 'StreamController.onPause=' is defined here.
  abstract void Function()? onPause;
                            ^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:199:29: Context: 'StreamController.onResume' is defined here.
  abstract void Function()? onResume;
                            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:199:29: Context: 'StreamController.onResume=' is defined here.
  abstract void Function()? onResume;
                            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:207:21: Context: 'StreamController.sink' is defined here.
  StreamSink<T> get sink;
                    ^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:72:17: Context: 'StreamController.stream' is defined here.
  Stream<T> get stream;
                ^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2403:10: Context: 'StreamSink.close' is defined here.
  Future close();
         ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2416:14: Context: 'StreamSink.done' is defined here.
  Future get done;
             ^^^^
test/unit/mocks/mock_dependencies.dart:19:7: Error: The non-abstract class 'MockRequest' is missing implementations for these members:
 - BaseRequest.finalized
 - BaseRequest.followRedirects
 - BaseRequest.followRedirects=
 - BaseRequest.headers
 - BaseRequest.maxRedirects
 - BaseRequest.maxRedirects=
 - BaseRequest.method
 - BaseRequest.persistentConnection
 - BaseRequest.persistentConnection=
 - BaseRequest.send
 - BaseRequest.url
 - Request.body
 - Request.body=
 - Request.bodyBytes
 - Request.bodyBytes=
 - Request.bodyFields
 - Request.bodyFields=
 - Request.contentLength
 - Request.contentLength=
 - Request.encoding
 - Request.encoding=
 - Request.finalize
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockRequest extends Mock implements http.Request {}
      ^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:99:12: Context: 'BaseRequest.finalized' is defined here.
  bool get finalized => _finalized;
           ^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:67:12: Context: 'BaseRequest.followRedirects' is defined here.
  bool get followRedirects => _followRedirects;
           ^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:70:7: Context: 'BaseRequest.followRedirects=' is defined here.
  set followRedirects(bool value) {
      ^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:96:29: Context: 'BaseRequest.headers' is defined here.
  final Map<String, String> headers;
                            ^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:79:11: Context: 'BaseRequest.maxRedirects' is defined here.
  int get maxRedirects => _maxRedirects;
          ^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:82:7: Context: 'BaseRequest.maxRedirects=' is defined here.
  set maxRedirects(int value) {
      ^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:33:16: Context: 'BaseRequest.method' is defined here.
  final String method;
               ^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:56:12: Context: 'BaseRequest.persistentConnection' is defined here.
  bool get persistentConnection => _persistentConnection;
           ^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:59:7: Context: 'BaseRequest.persistentConnection=' is defined here.
  set persistentConnection(bool value) {
      ^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:140:28: Context: 'BaseRequest.send' is defined here.
  Future<StreamedResponse> send() async {
                           ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:36:13: Context: 'BaseRequest.url' is defined here.
  final Uri url;
            ^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:102:14: Context: 'Request.body' is defined here.
  String get body => encoding.decode(bodyBytes);
             ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:104:7: Context: 'Request.body=' is defined here.
  set body(String value) {
      ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:83:17: Context: 'Request.bodyBytes' is defined here.
  Uint8List get bodyBytes => _bodyBytes;
                ^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:86:7: Context: 'Request.bodyBytes=' is defined here.
  set bodyBytes(List<int> value) {
      ^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:130:27: Context: 'Request.bodyFields' is defined here.
  Map<String, String> get bodyFields {
                          ^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:141:7: Context: 'Request.bodyFields=' is defined here.
  set bodyFields(Map<String, String> fields) {
      ^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:23:11: Context: 'Request.contentLength' is defined here.
  int get contentLength => bodyBytes.length;
          ^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:26:7: Context: 'Request.contentLength=' is defined here.
  set contentLength(int? value) {
      ^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:52:16: Context: 'Request.encoding' is defined here.
  Encoding get encoding {
               ^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:60:7: Context: 'Request.encoding=' is defined here.
  set encoding(Encoding value) {
      ^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:160:14: Context: 'Request.finalize' is defined here.
  ByteStream finalize() {
             ^^^^^^^^
test/unit/mocks/mock_dependencies.dart:22:7: Error: The non-abstract class 'MockSharedPreferences' is missing implementations for these members:
 - SharedPreferences.commit
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockSharedPreferences extends Mock implements SharedPreferences {
      ^^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/shared_preferences-2.5.3/lib/src/shared_preferences_legacy.dart:193:16: Context: 'SharedPreferences.commit' is defined here.
  Future<bool> commit() async => true;
               ^^^^^^
test/unit/mocks/mock_dependencies.dart:106:5: Error: Method not found: 'when'.
    when(() => response.statusCode).thenReturn(statusCode);
    ^^^^
test/unit/mocks/mock_dependencies.dart:109:7: Error: Method not found: 'when'.
      when(() => response.stream)
      ^^^^
test/unit/mocks/mock_dependencies.dart:112:7: Error: Method not found: 'when'.
      when(() => response.stream)
      ^^^^
test/unit/mocks/mock_dependencies.dart:282:3: Error: Method not found: 'registerFallbackValue'.
  registerFallbackValue(Uri());
  ^^^^^^^^^^^^^^^^^^^^^
test/unit/mocks/mock_dependencies.dart:283:3: Error: Method not found: 'registerFallbackValue'.
  registerFallbackValue(http.Request('POST', Uri()));
  ^^^^^^^^^^^^^^^^^^^^^
test/unit/mocks/mock_dependencies.dart:284:3: Error: Method not found: 'registerFallbackValue'.
  registerFallbackValue(StreamController<String>());
  ^^^^^^^^^^^^^^^^^^^^^
test/unit/mocks/mock_dependencies.dart:285:3: Error: Method not found: 'registerFallbackValue'.
  registerFallbackValue(const Duration(milliseconds: 100));
  ^^^^^^^^^^^^^^^^^^^^^
🔄 速率限制器已重置
00:14 +391 ~9 -48: loading D:/myspace/novel_builder/novel_app/test/unit/stream_processing_basic_test.dart [E]
  Failed to load "D:/myspace/novel_builder/novel_app/test/unit/stream_processing_basic_test.dart":
  Compilation failed for testPath=D:/myspace/novel_builder/novel_app/test/unit/stream_processing_basic_test.dart: Error: Couldn't resolve the package 'mocktail' in 'package:mocktail/mocktail.dart'.
  test/unit/stream_processing_basic_test.dart:2:8: Error: Not found: 'package:mocktail/mocktail.dart'
  import 'package:mocktail/mocktail.dart';
         ^
  test/unit/mocks/mock_dependencies.dart:7:8: Error: Not found: 'package:mocktail/mocktail.dart'
  import 'package:mocktail/mocktail.dart';
         ^
  test/unit/mocks/mock_dependencies.dart:11:30: Error: Type 'Mock' not found.
  class MockHttpClient extends Mock implements http.Client {}
                               ^^^^
  test/unit/mocks/mock_dependencies.dart:13:36: Error: Type 'Mock' not found.
  class MockStreamedResponse extends Mock implements http.StreamedResponse {}
                                     ^^^^
  test/unit/mocks/mock_dependencies.dart:15:41: Error: Type 'Mock' not found.
  class MockStreamSubscription<T> extends Mock implements StreamSubscription<T> {}
                                          ^^^^
  test/unit/mocks/mock_dependencies.dart:17:39: Error: Type 'Mock' not found.
  class MockStreamController<T> extends Mock implements StreamController<T> {}
                                        ^^^^
  test/unit/mocks/mock_dependencies.dart:19:27: Error: Type 'Mock' not found.
  class MockRequest extends Mock implements http.Request {}
                            ^^^^
  test/unit/mocks/mock_dependencies.dart:22:37: Error: Type 'Mock' not found.
  class MockSharedPreferences extends Mock implements SharedPreferences {
                                      ^^^^
  test/unit/mocks/mock_dependencies.dart:11:7: Error: The non-abstract class 'MockHttpClient' is missing implementations for these members:
   - Client.close
   - Client.delete
   - Client.get
   - Client.head
   - Client.patch
   - Client.post
   - Client.put
   - Client.read
   - Client.readBytes
   - Client.send
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockHttpClient extends Mock implements http.Client {}
        ^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:160:8: Context: 'Client.close' is defined here.
    void close();
         ^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:122:20: Context: 'Client.delete' is defined here.
    Future<Response> delete(Uri url,
                     ^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:52:20: Context: 'Client.get' is defined here.
    Future<Response> get(Uri url, {Map<String, String>? headers});
                     ^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:47:20: Context: 'Client.head' is defined here.
    Future<Response> head(Uri url, {Map<String, String>? headers});
                     ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:116:20: Context: 'Client.patch' is defined here.
    Future<Response> patch(Uri url,
                     ^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:74:20: Context: 'Client.post' is defined here.
    Future<Response> post(Uri url,
                     ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:95:20: Context: 'Client.put' is defined here.
    Future<Response> put(Uri url,
                     ^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:133:18: Context: 'Client.read' is defined here.
    Future<String> read(Uri url, {Map<String, String>? headers});
                   ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:144:21: Context: 'Client.readBytes' is defined here.
    Future<Uint8List> readBytes(Uri url, {Map<String, String>? headers});
                      ^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:147:28: Context: 'Client.send' is defined here.
    Future<StreamedResponse> send(BaseRequest request);
                             ^^^^
  test/unit/mocks/mock_dependencies.dart:13:7: Error: The non-abstract class 'MockStreamedResponse' is missing implementations for these members:
   - BaseResponse.contentLength
   - BaseResponse.headers
   - BaseResponse.isRedirect
   - BaseResponse.persistentConnection
   - BaseResponse.reasonPhrase
   - BaseResponse.request
   - BaseResponse.statusCode
   - StreamedResponse.stream
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockStreamedResponse extends Mock implements http.StreamedResponse {}
        ^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:28:14: Context: 'BaseResponse.contentLength' is defined here.
    final int? contentLength;
               ^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:59:29: Context: 'BaseResponse.headers' is defined here.
    final Map<String, String> headers;
                              ^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:61:14: Context: 'BaseResponse.isRedirect' is defined here.
    final bool isRedirect;
               ^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:64:14: Context: 'BaseResponse.persistentConnection' is defined here.
    final bool persistentConnection;
               ^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:23:17: Context: 'BaseResponse.reasonPhrase' is defined here.
    final String? reasonPhrase;
                  ^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:17:22: Context: 'BaseResponse.request' is defined here.
    final BaseRequest? request;
                       ^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:20:13: Context: 'BaseResponse.statusCode' is defined here.
    final int statusCode;
              ^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/streamed_response.dart:15:20: Context: 'StreamedResponse.stream' is defined here.
    final ByteStream stream;
                     ^^^^^^
  test/unit/mocks/mock_dependencies.dart:15:7: Error: The non-abstract class 'MockStreamSubscription' is missing implementations for these members:
   - StreamSubscription.asFuture
   - StreamSubscription.cancel
   - StreamSubscription.isPaused
   - StreamSubscription.onData
   - StreamSubscription.onDone
   - StreamSubscription.onError
   - StreamSubscription.pause
   - StreamSubscription.resume
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockStreamSubscription<T> extends Mock implements StreamSubscription<T> {}
        ^^^^^^^^^^^^^^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2270:13: Context: 'StreamSubscription.asFuture' is defined here.
    Future<E> asFuture<E>([E? futureValue]);
              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2165:16: Context: 'StreamSubscription.cancel' is defined here.
    Future<void> cancel();
                 ^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2254:12: Context: 'StreamSubscription.isPaused' is defined here.
    bool get isPaused;
             ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2175:8: Context: 'StreamSubscription.onData' is defined here.
    void onData(void handleData(T data)?);
         ^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2201:8: Context: 'StreamSubscription.onDone' is defined here.
    void onDone(void handleDone()?);
         ^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2192:8: Context: 'StreamSubscription.onError' is defined here.
    void onError(Function? handleError);
         ^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2233:8: Context: 'StreamSubscription.pause' is defined here.
    void pause([Future<void>? resumeSignal]);
         ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2244:8: Context: 'StreamSubscription.resume' is defined here.
    void resume();
         ^^^^^^
  test/unit/mocks/mock_dependencies.dart:17:7: Error: The non-abstract class 'MockStreamController' is missing implementations for these members:
   - EventSink.add
   - EventSink.addError
   - EventSink.close
   - Sink.add
   - Sink.close
   - StreamConsumer.addStream
   - StreamConsumer.close
   - StreamController.add
   - StreamController.addError
   - StreamController.addStream
   - StreamController.close
   - StreamController.done
   - StreamController.hasListener
   - StreamController.isClosed
   - StreamController.isPaused
   - StreamController.onCancel
   - StreamController.onCancel=
   - StreamController.onListen
   - StreamController.onListen=
   - StreamController.onPause
   - StreamController.onPause=
   - StreamController.onResume
   - StreamController.onResume=
   - StreamController.sink
   - StreamController.stream
   - StreamSink.close
   - StreamSink.done
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockStreamController<T> extends Mock implements StreamController<T> {}
        ^^^^^^^^^^^^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2285:8: Context: 'EventSink.add' is defined here.
    void add(T event);
         ^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2290:8: Context: 'EventSink.addError' is defined here.
    void addError(Object error, [StackTrace? stackTrace]);
         ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2297:8: Context: 'EventSink.close' is defined here.
    void close();
         ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/core/sink.dart:17:8: Context: 'Sink.add' is defined here.
    void add(T data);
         ^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/core/sink.dart:24:8: Context: 'Sink.close' is defined here.
    void close();
         ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2354:10: Context: 'StreamConsumer.addStream' is defined here.
    Future addStream(Stream<S> stream);
           ^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2364:10: Context: 'StreamConsumer.close' is defined here.
    Future close();
           ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:244:8: Context: 'StreamController.add' is defined here.
    void add(T event);
         ^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:252:8: Context: 'StreamController.addError' is defined here.
    void addError(Object error, [StackTrace? stackTrace]);
         ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:312:10: Context: 'StreamController.addStream' is defined here.
    Future addStream(Stream<T> source, {bool? cancelOnError});
           ^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:274:10: Context: 'StreamController.close' is defined here.
    Future close();
           ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:293:14: Context: 'StreamController.done' is defined here.
    Future get done;
               ^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:232:12: Context: 'StreamController.hasListener' is defined here.
    bool get hasListener;
             ^^^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:218:12: Context: 'StreamController.isClosed' is defined here.
    bool get isClosed;
             ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:229:12: Context: 'StreamController.isPaused' is defined here.
    bool get isPaused;
             ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:204:39: Context: 'StreamController.onCancel' is defined here.
    abstract FutureOr<void> Function()? onCancel;
                                        ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:204:39: Context: 'StreamController.onCancel=' is defined here.
    abstract FutureOr<void> Function()? onCancel;
                                        ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:185:29: Context: 'StreamController.onListen' is defined here.
    abstract void Function()? onListen;
                              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:185:29: Context: 'StreamController.onListen=' is defined here.
    abstract void Function()? onListen;
                              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:192:29: Context: 'StreamController.onPause' is defined here.
    abstract void Function()? onPause;
                              ^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:192:29: Context: 'StreamController.onPause=' is defined here.
    abstract void Function()? onPause;
                              ^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:199:29: Context: 'StreamController.onResume' is defined here.
    abstract void Function()? onResume;
                              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:199:29: Context: 'StreamController.onResume=' is defined here.
    abstract void Function()? onResume;
                              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:207:21: Context: 'StreamController.sink' is defined here.
    StreamSink<T> get sink;
                      ^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:72:17: Context: 'StreamController.stream' is defined here.
    Stream<T> get stream;
                  ^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2403:10: Context: 'StreamSink.close' is defined here.
    Future close();
           ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2416:14: Context: 'StreamSink.done' is defined here.
    Future get done;
               ^^^^
  test/unit/mocks/mock_dependencies.dart:19:7: Error: The non-abstract class 'MockRequest' is missing implementations for these members:
   - BaseRequest.finalized
   - BaseRequest.followRedirects
   - BaseRequest.followRedirects=
   - BaseRequest.headers
   - BaseRequest.maxRedirects
   - BaseRequest.maxRedirects=
   - BaseRequest.method
   - BaseRequest.persistentConnection
   - BaseRequest.persistentConnection=
   - BaseRequest.send
   - BaseRequest.url
   - Request.body
   - Request.body=
   - Request.bodyBytes
   - Request.bodyBytes=
   - Request.bodyFields
   - Request.bodyFields=
   - Request.contentLength
   - Request.contentLength=
   - Request.encoding
   - Request.encoding=
   - Request.finalize
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockRequest extends Mock implements http.Request {}
        ^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:99:12: Context: 'BaseRequest.finalized' is defined here.
    bool get finalized => _finalized;
             ^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:67:12: Context: 'BaseRequest.followRedirects' is defined here.
    bool get followRedirects => _followRedirects;
             ^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:70:7: Context: 'BaseRequest.followRedirects=' is defined here.
    set followRedirects(bool value) {
        ^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:96:29: Context: 'BaseRequest.headers' is defined here.
    final Map<String, String> headers;
                              ^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:79:11: Context: 'BaseRequest.maxRedirects' is defined here.
    int get maxRedirects => _maxRedirects;
            ^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:82:7: Context: 'BaseRequest.maxRedirects=' is defined here.
    set maxRedirects(int value) {
        ^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:33:16: Context: 'BaseRequest.method' is defined here.
    final String method;
                 ^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:56:12: Context: 'BaseRequest.persistentConnection' is defined here.
    bool get persistentConnection => _persistentConnection;
             ^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:59:7: Context: 'BaseRequest.persistentConnection=' is defined here.
    set persistentConnection(bool value) {
        ^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:140:28: Context: 'BaseRequest.send' is defined here.
    Future<StreamedResponse> send() async {
                             ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:36:13: Context: 'BaseRequest.url' is defined here.
    final Uri url;
              ^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:102:14: Context: 'Request.body' is defined here.
    String get body => encoding.decode(bodyBytes);
               ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:104:7: Context: 'Request.body=' is defined here.
    set body(String value) {
        ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:83:17: Context: 'Request.bodyBytes' is defined here.
    Uint8List get bodyBytes => _bodyBytes;
                  ^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:86:7: Context: 'Request.bodyBytes=' is defined here.
    set bodyBytes(List<int> value) {
        ^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:130:27: Context: 'Request.bodyFields' is defined here.
    Map<String, String> get bodyFields {
                            ^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:141:7: Context: 'Request.bodyFields=' is defined here.
    set bodyFields(Map<String, String> fields) {
        ^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:23:11: Context: 'Request.contentLength' is defined here.
    int get contentLength => bodyBytes.length;
            ^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:26:7: Context: 'Request.contentLength=' is defined here.
    set contentLength(int? value) {
        ^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:52:16: Context: 'Request.encoding' is defined here.
    Encoding get encoding {
                 ^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:60:7: Context: 'Request.encoding=' is defined here.
    set encoding(Encoding value) {
        ^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:160:14: Context: 'Request.finalize' is defined here.
    ByteStream finalize() {
               ^^^^^^^^
  test/unit/mocks/mock_dependencies.dart:22:7: Error: The non-abstract class 'MockSharedPreferences' is missing implementations for these members:
   - SharedPreferences.commit
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockSharedPreferences extends Mock implements SharedPreferences {
        ^^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/shared_preferences-2.5.3/lib/src/shared_preferences_legacy.dart:193:16: Context: 'SharedPreferences.commit' is defined here.
    Future<bool> commit() async => true;
                 ^^^^^^
  test/unit/mocks/mock_dependencies.dart:106:5: Error: Method not found: 'when'.
      when(() => response.statusCode).thenReturn(statusCode);
      ^^^^
  test/unit/mocks/mock_dependencies.dart:109:7: Error: Method not found: 'when'.
        when(() => response.stream)
        ^^^^
  test/unit/mocks/mock_dependencies.dart:112:7: Error: Method not found: 'when'.
        when(() => response.stream)
        ^^^^
  test/unit/mocks/mock_dependencies.dart:282:3: Error: Method not found: 'registerFallbackValue'.
    registerFallbackValue(Uri());
    ^^^^^^^^^^^^^^^^^^^^^
  test/unit/mocks/mock_dependencies.dart:283:3: Error: Method not found: 'registerFallbackValue'.
    registerFallbackValue(http.Request('POST', Uri()));
    ^^^^^^^^^^^^^^^^^^^^^
  test/unit/mocks/mock_dependencies.dart:284:3: Error: Method not found: 'registerFallbackValue'.
    registerFallbackValue(StreamController<String>());
    ^^^^^^^^^^^^^^^^^^^^^
  test/unit/mocks/mock_dependencies.dart:285:3: Error: Method not found: 'registerFallbackValue'.
    registerFallbackValue(const Duration(milliseconds: 100));
    ^^^^^^^^^^^^^^^^^^^^^
  .
00:15 +392 ~9 -48: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 默认参数 默认间隔应为30秒
00:15 +393 ~9 -48: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 默认参数 默认构造函数应正常工作
00:15 +394 ~9 -48: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 时间精度 短间隔 (50ms) 应精确控制
⏳ 速率限制: 等待 0 秒
00:15 +395 ~9 -48: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 时间精度 中等间隔 (500ms) 应精确控制
⏳ 速率限制: 等待 0 秒
00:15 +396 ~9 -48: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 特殊场景 连续 acquire() 不应累积等待时间
00:15 +396 ~9 -48: loading D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart
✅ 测试环境初始化完成 (SQLite FFI)
00:16 +396 ~9 -48: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 特殊场景 连续 acquire() 不应累积等待时间
⏳ 速率限制: 等待 0 秒
00:16 +396 ~9 -49: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 特殊场景 连续 acquire() 不应累积等待时间
00:16 +396 ~9 -49: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 加载状态 初始应该显示Loading Indicator [E]
  type 'Null' is not a subtype of type 'Future<List<CharacterRelationship>>'
  test\unit\widgets\character_relationship_screen_test.dart 12:7   MockDatabaseService.getOutgoingRelationships
  test\unit\widgets\character_relationship_screen_test.dart 29:19  main.<fn>.<fn>
  
00:16 +396 ~9 -50: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 特殊场景 连续 acquire() 不应累积等待时间
00:16 +396 ~9 -50: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 加载状态 加载完成后应该显示内容 [E]
  Bad state: Cannot call `when` within a stub response
  package:mockito/src/mock.dart 1299:5                            when
  test\unit\widgets\character_relationship_screen_test.dart 29:7  main.<fn>.<fn>
  
00:16 +396 ~9 -51: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 特殊场景 连续 acquire() 不应累积等待时间
00:16 +396 ~9 -51: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 加载状态 加载失败应该显示错误信息 [E]
  Bad state: Cannot call `when` within a stub response
  package:mockito/src/mock.dart 1299:5                            when
  test\unit\widgets\character_relationship_screen_test.dart 29:7  main.<fn>.<fn>
  
00:16 +396 ~9 -52: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 特殊场景 连续 acquire() 不应累积等待时间
00:16 +396 ~9 -52: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 空状态渲染 无出度关系时显示空状态 [E]
  Bad state: Cannot call `when` within a stub response
  package:mockito/src/mock.dart 1299:5                             when
  test\unit\widgets\character_relationship_screen_test.dart 129:7  main.<fn>.<fn>
  
00:16 +396 ~9 -52: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 特殊场景 连续 acquire() 不应累积等待时间
⏳ 速率限制: 等待 0 秒
00:16 +396 ~9 -53: D:/myspace/novel_builder/novel_app/test/unit/services/rate_limiter_test.dart: RateLimiter 特殊场景 连续 acquire() 不应累积等待时间
00:16 +396 ~9 -53: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 空状态渲染 无入度关系时显示空状态 [E]
  Bad state: Cannot call `when` within a stub response
  package:mockito/src/mock.dart 1299:5                             when
  test\unit\widgets\character_relationship_screen_test.dart 129:7  main.<fn>.<fn>
  
00:16 +397 ~9 -53: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 关系列表渲染 应该显示TabBar
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following StateError was thrown running a test:
Bad state: Cannot call `when` within a stub response

When the exception was thrown, this was the stack:
#0      when (package:mockito/src/mock.dart:1299:5)
#1      main.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart:204:7)
#2      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:29)
<asynchronous suspension>
#3      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided one frame from package:stack_trace)

The test description was:
  应该显示TabBar
════════════════════════════════════════════════════════════════════════════════════════════════════
00:16 +397 ~9 -54: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_dialog_test.dart: LogViewerScreen 对话框 点击堆栈信息链接应显示对话框
00:16 +397 ~9 -54: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 关系列表渲染 应该显示TabBar [E]
  Test failed. See exception logs above.
  The test description was: 应该显示TabBar
  
00:16 +397 ~9 -54: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 关系列表渲染 应该渲染出度关系列表
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following StateError was thrown running a test:
Bad state: Cannot call `when` within a stub response

When the exception was thrown, this was the stack:
#0      when (package:mockito/src/mock.dart:1299:5)
#1      main.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart:231:7)
#2      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:29)
<asynchronous suspension>
#3      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided one frame from package:stack_trace)

The test description was:
  应该渲染出度关系列表
════════════════════════════════════════════════════════════════════════════════════════════════════
00:16 +397 ~9 -55: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_dialog_test.dart: LogViewerScreen 对话框 点击堆栈信息链接应显示对话框
00:16 +397 ~9 -55: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 关系列表渲染 应该渲染出度关系列表 [E]
  Test failed. See exception logs above.
  The test description was: 应该渲染出度关系列表
  
00:16 +397 ~9 -55: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 关系列表渲染 应该渲染入度关系列表
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following StateError was thrown running a test:
Bad state: Cannot call `when` within a stub response

When the exception was thrown, this was the stack:
#0      when (package:mockito/src/mock.dart:1299:5)
#1      main.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart:277:7)
#2      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:29)
<asynchronous suspension>
#3      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided one frame from package:stack_trace)

The test description was:
  应该渲染入度关系列表
════════════════════════════════════════════════════════════════════════════════════════════════════
00:16 +397 ~9 -56: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_dialog_test.dart: LogViewerScreen 对话框 点击堆栈信息链接应显示对话框
00:16 +397 ~9 -56: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 关系列表渲染 应该渲染入度关系列表 [E]
  Test failed. See exception logs above.
  The test description was: 应该渲染入度关系列表
  
00:16 +397 ~9 -56: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 关系列表渲染 关系卡片应该显示描述信息
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following StateError was thrown running a test:
Bad state: Cannot call `when` within a stub response

When the exception was thrown, this was the stack:
#0      when (package:mockito/src/mock.dart:1299:5)
#1      main.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart:333:7)
#2      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:29)
<asynchronous suspension>
#3      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided one frame from package:stack_trace)

The test description was:
  关系卡片应该显示描述信息
════════════════════════════════════════════════════════════════════════════════════════════════════
00:16 +397 ~9 -57: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_dialog_test.dart: LogViewerScreen 对话框 点击堆栈信息链接应显示对话框
00:16 +397 ~9 -57: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 关系列表渲染 关系卡片应该显示描述信息 [E]
  Test failed. See exception logs above.
  The test description was: 关系卡片应该显示描述信息
  
00:16 +398 ~9 -57: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_dialog_test.dart: LogViewerScreen 对话框 点击堆栈信息链接应显示对话框
00:16 +398 ~9 -57: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 关系列表渲染 出度关系应该显示向右箭头
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following StateError was thrown running a test:
Bad state: Cannot call `when` within a stub response

When the exception was thrown, this was the stack:
#0      when (package:mockito/src/mock.dart:1299:5)
#1      main.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart:371:7)
#2      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:29)
<asynchronous suspension>
#3      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided one frame from package:stack_trace)

The test description was:
  出度关系应该显示向右箭头
════════════════════════════════════════════════════════════════════════════════════════════════════
00:16 +398 ~9 -58: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_dialog_test.dart: LogViewerScreen 对话框 点击堆栈信息链接应显示对话框
00:16 +398 ~9 -58: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 关系列表渲染 出度关系应该显示向右箭头 [E]
  Test failed. See exception logs above.
  The test description was: 出度关系应该显示向右箭头
  
00:16 +398 ~9 -58: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 关系列表渲染 入度关系应该显示向左箭头
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following StateError was thrown running a test:
Bad state: Cannot call `when` within a stub response

When the exception was thrown, this was the stack:
#0      when (package:mockito/src/mock.dart:1299:5)
#1      main.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart:408:7)
#2      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:29)
<asynchronous suspension>
#3      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided one frame from package:stack_trace)

The test description was:
  入度关系应该显示向左箭头
════════════════════════════════════════════════════════════════════════════════════════════════════
00:16 +398 ~9 -59: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_dialog_test.dart: LogViewerScreen 对话框 点击堆栈信息链接应显示对话框
00:16 +398 ~9 -59: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 关系列表渲染 入度关系应该显示向左箭头 [E]
  Test failed. See exception logs above.
  The test description was: 入度关系应该显示向左箭头
  
00:16 +398 ~9 -60: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_dialog_test.dart: LogViewerScreen 对话框 点击堆栈信息链接应显示对话框
00:16 +398 ~9 -60: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 交互测试 应该有添加关系按钮 [E]
  Bad state: Cannot call `when` within a stub response
  package:mockito/src/mock.dart 1299:5                             when
  test\unit\widgets\character_relationship_screen_test.dart 455:7  main.<fn>.<fn>
  
00:16 +398 ~9 -61: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_dialog_test.dart: LogViewerScreen 对话框 点击堆栈信息链接应显示对话框
00:16 +398 ~9 -61: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 交互测试 应该有查看关系图按钮 [E]
  Bad state: Cannot call `when` within a stub response
  package:mockito/src/mock.dart 1299:5                             when
  test\unit\widgets\character_relationship_screen_test.dart 455:7  main.<fn>.<fn>
  
00:16 +398 ~9 -62: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_dialog_test.dart: LogViewerScreen 对话框 点击堆栈信息链接应显示对话框
00:16 +398 ~9 -62: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 交互测试 关系卡片应该有编辑按钮 [E]
  Bad state: Cannot call `when` within a stub response
  package:mockito/src/mock.dart 1299:5                             when
  test\unit\widgets\character_relationship_screen_test.dart 455:7  main.<fn>.<fn>
  
00:16 +398 ~9 -63: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_dialog_test.dart: LogViewerScreen 对话框 点击堆栈信息链接应显示对话框
00:16 +398 ~9 -63: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - 交互测试 关系卡片应该有删除按钮 [E]
  Bad state: Cannot call `when` within a stub response
  package:mockito/src/mock.dart 1299:5                             when
  test\unit\widgets\character_relationship_screen_test.dart 455:7  main.<fn>.<fn>
  
00:16 +398 ~9 -64: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_dialog_test.dart: LogViewerScreen 对话框 点击堆栈信息链接应显示对话框
00:16 +398 ~9 -64: D:/myspace/novel_builder/novel_app/test/unit/widgets/character_relationship_screen_test.dart: CharacterRelationshipScreen - Tab切换 Tab切换应该正确显示不同列表 [E]
  Bad state: Cannot call `when` within a stub response
  package:mockito/src/mock.dart 1299:5                             when
  test\unit\widgets\character_relationship_screen_test.dart 539:7  main.<fn>.<fn>
  
00:16 +399 ~9 -64: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_dialog_test.dart: LogViewerScreen 对话框 点击堆栈信息链接应显示对话框
Error: Couldn't resolve the package 'mocktail' in 'package:mocktail/mocktail.dart'.
test/unit/widgets/stream_content_widget_test.dart:3:8: Error: Not found: 'package:mocktail/mocktail.dart'
import 'package:mocktail/mocktail.dart';
       ^
test/unit/widgets/stream_content_widget_test.dart:5:8: Error: Error when reading 'lib/widgets/stream_content_widget.dart': 系统找不到指定的文件。

import '../../../lib/widgets/stream_content_widget.dart';
       ^
test/unit/widgets/stream_content_widget_test.dart:6:8: Error: Error when reading 'lib/models/stream_config.dart': 系统找不到指定的文件。

import '../../../lib/models/stream_config.dart';
       ^
test/unit/mocks/mock_dependencies.dart:7:8: Error: Not found: 'package:mocktail/mocktail.dart'
import 'package:mocktail/mocktail.dart';
       ^
test/unit/mocks/mock_dependencies.dart:11:30: Error: Type 'Mock' not found.
class MockHttpClient extends Mock implements http.Client {}
                             ^^^^
test/unit/mocks/mock_dependencies.dart:13:36: Error: Type 'Mock' not found.
class MockStreamedResponse extends Mock implements http.StreamedResponse {}
                                   ^^^^
test/unit/mocks/mock_dependencies.dart:15:41: Error: Type 'Mock' not found.
class MockStreamSubscription<T> extends Mock implements StreamSubscription<T> {}
                                        ^^^^
test/unit/mocks/mock_dependencies.dart:17:39: Error: Type 'Mock' not found.
class MockStreamController<T> extends Mock implements StreamController<T> {}
                                      ^^^^
test/unit/mocks/mock_dependencies.dart:19:27: Error: Type 'Mock' not found.
class MockRequest extends Mock implements http.Request {}
                          ^^^^
test/unit/mocks/mock_dependencies.dart:22:37: Error: Type 'Mock' not found.
class MockSharedPreferences extends Mock implements SharedPreferences {
                                    ^^^^
test/unit/mocks/mock_dependencies.dart:11:7: Error: The non-abstract class 'MockHttpClient' is missing implementations for these members:
 - Client.close
 - Client.delete
 - Client.get
 - Client.head
 - Client.patch
 - Client.post
 - Client.put
 - Client.read
 - Client.readBytes
 - Client.send
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockHttpClient extends Mock implements http.Client {}
      ^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:160:8: Context: 'Client.close' is defined here.
  void close();
       ^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:122:20: Context: 'Client.delete' is defined here.
  Future<Response> delete(Uri url,
                   ^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:52:20: Context: 'Client.get' is defined here.
  Future<Response> get(Uri url, {Map<String, String>? headers});
                   ^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:47:20: Context: 'Client.head' is defined here.
  Future<Response> head(Uri url, {Map<String, String>? headers});
                   ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:116:20: Context: 'Client.patch' is defined here.
  Future<Response> patch(Uri url,
                   ^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:74:20: Context: 'Client.post' is defined here.
  Future<Response> post(Uri url,
                   ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:95:20: Context: 'Client.put' is defined here.
  Future<Response> put(Uri url,
                   ^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:133:18: Context: 'Client.read' is defined here.
  Future<String> read(Uri url, {Map<String, String>? headers});
                 ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:144:21: Context: 'Client.readBytes' is defined here.
  Future<Uint8List> readBytes(Uri url, {Map<String, String>? headers});
                    ^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:147:28: Context: 'Client.send' is defined here.
  Future<StreamedResponse> send(BaseRequest request);
                           ^^^^
test/unit/mocks/mock_dependencies.dart:13:7: Error: The non-abstract class 'MockStreamedResponse' is missing implementations for these members:
 - BaseResponse.contentLength
 - BaseResponse.headers
 - BaseResponse.isRedirect
 - BaseResponse.persistentConnection
 - BaseResponse.reasonPhrase
 - BaseResponse.request
 - BaseResponse.statusCode
 - StreamedResponse.stream
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockStreamedResponse extends Mock implements http.StreamedResponse {}
      ^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:28:14: Context: 'BaseResponse.contentLength' is defined here.
  final int? contentLength;
             ^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:59:29: Context: 'BaseResponse.headers' is defined here.
  final Map<String, String> headers;
                            ^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:61:14: Context: 'BaseResponse.isRedirect' is defined here.
  final bool isRedirect;
             ^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:64:14: Context: 'BaseResponse.persistentConnection' is defined here.
  final bool persistentConnection;
             ^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:23:17: Context: 'BaseResponse.reasonPhrase' is defined here.
  final String? reasonPhrase;
                ^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:17:22: Context: 'BaseResponse.request' is defined here.
  final BaseRequest? request;
                     ^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:20:13: Context: 'BaseResponse.statusCode' is defined here.
  final int statusCode;
            ^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/streamed_response.dart:15:20: Context: 'StreamedResponse.stream' is defined here.
  final ByteStream stream;
                   ^^^^^^
test/unit/mocks/mock_dependencies.dart:15:7: Error: The non-abstract class 'MockStreamSubscription' is missing implementations for these members:
 - StreamSubscription.asFuture
 - StreamSubscription.cancel
 - StreamSubscription.isPaused
 - StreamSubscription.onData
 - StreamSubscription.onDone
 - StreamSubscription.onError
 - StreamSubscription.pause
 - StreamSubscription.resume
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockStreamSubscription<T> extends Mock implements StreamSubscription<T> {}
      ^^^^^^^^^^^^^^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2270:13: Context: 'StreamSubscription.asFuture' is defined here.
  Future<E> asFuture<E>([E? futureValue]);
            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2165:16: Context: 'StreamSubscription.cancel' is defined here.
  Future<void> cancel();
               ^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2254:12: Context: 'StreamSubscription.isPaused' is defined here.
  bool get isPaused;
           ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2175:8: Context: 'StreamSubscription.onData' is defined here.
  void onData(void handleData(T data)?);
       ^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2201:8: Context: 'StreamSubscription.onDone' is defined here.
  void onDone(void handleDone()?);
       ^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2192:8: Context: 'StreamSubscription.onError' is defined here.
  void onError(Function? handleError);
       ^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2233:8: Context: 'StreamSubscription.pause' is defined here.
  void pause([Future<void>? resumeSignal]);
       ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2244:8: Context: 'StreamSubscription.resume' is defined here.
  void resume();
       ^^^^^^
test/unit/mocks/mock_dependencies.dart:17:7: Error: The non-abstract class 'MockStreamController' is missing implementations for these members:
 - EventSink.add
 - EventSink.addError
 - EventSink.close
 - Sink.add
 - Sink.close
 - StreamConsumer.addStream
 - StreamConsumer.close
 - StreamController.add
 - StreamController.addError
 - StreamController.addStream
 - StreamController.close
 - StreamController.done
 - StreamController.hasListener
 - StreamController.isClosed
 - StreamController.isPaused
 - StreamController.onCancel
 - StreamController.onCancel=
 - StreamController.onListen
 - StreamController.onListen=
 - StreamController.onPause
 - StreamController.onPause=
 - StreamController.onResume
 - StreamController.onResume=
 - StreamController.sink
 - StreamController.stream
 - StreamSink.close
 - StreamSink.done
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockStreamController<T> extends Mock implements StreamController<T> {}
      ^^^^^^^^^^^^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2285:8: Context: 'EventSink.add' is defined here.
  void add(T event);
       ^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2290:8: Context: 'EventSink.addError' is defined here.
  void addError(Object error, [StackTrace? stackTrace]);
       ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2297:8: Context: 'EventSink.close' is defined here.
  void close();
       ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/core/sink.dart:17:8: Context: 'Sink.add' is defined here.
  void add(T data);
       ^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/core/sink.dart:24:8: Context: 'Sink.close' is defined here.
  void close();
       ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2354:10: Context: 'StreamConsumer.addStream' is defined here.
  Future addStream(Stream<S> stream);
         ^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2364:10: Context: 'StreamConsumer.close' is defined here.
  Future close();
         ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:244:8: Context: 'StreamController.add' is defined here.
  void add(T event);
       ^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:252:8: Context: 'StreamController.addError' is defined here.
  void addError(Object error, [StackTrace? stackTrace]);
       ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:312:10: Context: 'StreamController.addStream' is defined here.
  Future addStream(Stream<T> source, {bool? cancelOnError});
         ^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:274:10: Context: 'StreamController.close' is defined here.
  Future close();
         ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:293:14: Context: 'StreamController.done' is defined here.
  Future get done;
             ^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:232:12: Context: 'StreamController.hasListener' is defined here.
  bool get hasListener;
           ^^^^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:218:12: Context: 'StreamController.isClosed' is defined here.
  bool get isClosed;
           ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:229:12: Context: 'StreamController.isPaused' is defined here.
  bool get isPaused;
           ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:204:39: Context: 'StreamController.onCancel' is defined here.
  abstract FutureOr<void> Function()? onCancel;
                                      ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:204:39: Context: 'StreamController.onCancel=' is defined here.
  abstract FutureOr<void> Function()? onCancel;
                                      ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:185:29: Context: 'StreamController.onListen' is defined here.
  abstract void Function()? onListen;
                            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:185:29: Context: 'StreamController.onListen=' is defined here.
  abstract void Function()? onListen;
                            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:192:29: Context: 'StreamController.onPause' is defined here.
  abstract void Function()? onPause;
                            ^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:192:29: Context: 'StreamController.onPause=' is defined here.
  abstract void Function()? onPause;
                            ^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:199:29: Context: 'StreamController.onResume' is defined here.
  abstract void Function()? onResume;
                            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:199:29: Context: 'StreamController.onResume=' is defined here.
  abstract void Function()? onResume;
                            ^^^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:207:21: Context: 'StreamController.sink' is defined here.
  StreamSink<T> get sink;
                    ^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:72:17: Context: 'StreamController.stream' is defined here.
  Stream<T> get stream;
                ^^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2403:10: Context: 'StreamSink.close' is defined here.
  Future close();
         ^^^^^
org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2416:14: Context: 'StreamSink.done' is defined here.
  Future get done;
             ^^^^
test/unit/mocks/mock_dependencies.dart:19:7: Error: The non-abstract class 'MockRequest' is missing implementations for these members:
 - BaseRequest.finalized
 - BaseRequest.followRedirects
 - BaseRequest.followRedirects=
 - BaseRequest.headers
 - BaseRequest.maxRedirects
 - BaseRequest.maxRedirects=
 - BaseRequest.method
 - BaseRequest.persistentConnection
 - BaseRequest.persistentConnection=
 - BaseRequest.send
 - BaseRequest.url
 - Request.body
 - Request.body=
 - Request.bodyBytes
 - Request.bodyBytes=
 - Request.bodyFields
 - Request.bodyFields=
 - Request.contentLength
 - Request.contentLength=
 - Request.encoding
 - Request.encoding=
 - Request.finalize
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockRequest extends Mock implements http.Request {}
      ^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:99:12: Context: 'BaseRequest.finalized' is defined here.
  bool get finalized => _finalized;
           ^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:67:12: Context: 'BaseRequest.followRedirects' is defined here.
  bool get followRedirects => _followRedirects;
           ^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:70:7: Context: 'BaseRequest.followRedirects=' is defined here.
  set followRedirects(bool value) {
      ^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:96:29: Context: 'BaseRequest.headers' is defined here.
  final Map<String, String> headers;
                            ^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:79:11: Context: 'BaseRequest.maxRedirects' is defined here.
  int get maxRedirects => _maxRedirects;
          ^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:82:7: Context: 'BaseRequest.maxRedirects=' is defined here.
  set maxRedirects(int value) {
      ^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:33:16: Context: 'BaseRequest.method' is defined here.
  final String method;
               ^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:56:12: Context: 'BaseRequest.persistentConnection' is defined here.
  bool get persistentConnection => _persistentConnection;
           ^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:59:7: Context: 'BaseRequest.persistentConnection=' is defined here.
  set persistentConnection(bool value) {
      ^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:140:28: Context: 'BaseRequest.send' is defined here.
  Future<StreamedResponse> send() async {
                           ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:36:13: Context: 'BaseRequest.url' is defined here.
  final Uri url;
            ^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:102:14: Context: 'Request.body' is defined here.
  String get body => encoding.decode(bodyBytes);
             ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:104:7: Context: 'Request.body=' is defined here.
  set body(String value) {
      ^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:83:17: Context: 'Request.bodyBytes' is defined here.
  Uint8List get bodyBytes => _bodyBytes;
                ^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:86:7: Context: 'Request.bodyBytes=' is defined here.
  set bodyBytes(List<int> value) {
      ^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:130:27: Context: 'Request.bodyFields' is defined here.
  Map<String, String> get bodyFields {
                          ^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:141:7: Context: 'Request.bodyFields=' is defined here.
  set bodyFields(Map<String, String> fields) {
      ^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:23:11: Context: 'Request.contentLength' is defined here.
  int get contentLength => bodyBytes.length;
          ^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:26:7: Context: 'Request.contentLength=' is defined here.
  set contentLength(int? value) {
      ^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:52:16: Context: 'Request.encoding' is defined here.
  Encoding get encoding {
               ^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:60:7: Context: 'Request.encoding=' is defined here.
  set encoding(Encoding value) {
      ^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:160:14: Context: 'Request.finalize' is defined here.
  ByteStream finalize() {
             ^^^^^^^^
test/unit/mocks/mock_dependencies.dart:22:7: Error: The non-abstract class 'MockSharedPreferences' is missing implementations for these members:
 - SharedPreferences.commit
Try to either
 - provide an implementation,
 - inherit an implementation from a superclass or mixin,
 - mark the class as abstract, or
 - provide a 'noSuchMethod' implementation.

class MockSharedPreferences extends Mock implements SharedPreferences {
      ^^^^^^^^^^^^^^^^^^^^^
/C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/shared_preferences-2.5.3/lib/src/shared_preferences_legacy.dart:193:16: Context: 'SharedPreferences.commit' is defined here.
  Future<bool> commit() async => true;
               ^^^^^^
test/unit/widgets/stream_content_widget_test.dart:11:10: Error: 'StreamConfig' isn't a type.
    late StreamConfig testConfig;
         ^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:15:20: Error: Undefined name 'StreamConfig'.
      testConfig = StreamConfig.sceneDescription(
                   ^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:34:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:43:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:51:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:58:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:67:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:94:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:108:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:117:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:130:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:139:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:153:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:162:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:170:50: Error: Undefined name 'StreamContentWidget'.
        final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                 ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:170:75: Error: 'StreamContentWidget' isn't a type.
        final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                                          ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:182:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:204:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:217:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:228:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:238:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:247:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:260:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:267:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:277:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:288:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:301:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:308:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:316:50: Error: Undefined name 'StreamContentWidget'.
        final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                 ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:316:75: Error: 'StreamContentWidget' isn't a type.
        final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                                          ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:324:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:333:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:359:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:367:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:373:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsNothing);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:377:9: Error: 'StreamConfig' isn't a type.
        StreamConfig? capturedConfig;
        ^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:385:26: Error: Method not found: 'StreamContentWidget'.
                  return StreamContentWidget(
                         ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:398:50: Error: Undefined name 'StreamContentWidget'.
        final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                 ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:398:75: Error: 'StreamContentWidget' isn't a type.
        final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                                          ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:407:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsNothing);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:417:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:439:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:448:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:455:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:459:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:468:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:481:24: Error: Undefined name 'StreamConfig'.
        final config = StreamConfig.sceneDescription(
                       ^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:489:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:510:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:522:50: Error: Undefined name 'StreamContentWidget'.
        final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                 ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:522:75: Error: 'StreamContentWidget' isn't a type.
        final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                                          ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:523:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:532:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:556:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:568:28: Error: Undefined name 'StreamContentWidget'.
        expect(find.byType(StreamContentWidget), findsOneWidget);
                           ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:583:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/widgets/stream_content_widget_test.dart:609:21: Error: Method not found: 'StreamContentWidget'.
              body: StreamContentWidget(
                    ^^^^^^^^^^^^^^^^^^^
test/unit/mocks/mock_dependencies.dart:106:5: Error: Method not found: 'when'.
    when(() => response.statusCode).thenReturn(statusCode);
    ^^^^
test/unit/mocks/mock_dependencies.dart:109:7: Error: Method not found: 'when'.
      when(() => response.stream)
      ^^^^
test/unit/mocks/mock_dependencies.dart:112:7: Error: Method not found: 'when'.
      when(() => response.stream)
      ^^^^
test/unit/mocks/mock_dependencies.dart:282:3: Error: Method not found: 'registerFallbackValue'.
  registerFallbackValue(Uri());
  ^^^^^^^^^^^^^^^^^^^^^
test/unit/mocks/mock_dependencies.dart:283:3: Error: Method not found: 'registerFallbackValue'.
  registerFallbackValue(http.Request('POST', Uri()));
  ^^^^^^^^^^^^^^^^^^^^^
test/unit/mocks/mock_dependencies.dart:284:3: Error: Method not found: 'registerFallbackValue'.
  registerFallbackValue(StreamController<String>());
  ^^^^^^^^^^^^^^^^^^^^^
test/unit/mocks/mock_dependencies.dart:285:3: Error: Method not found: 'registerFallbackValue'.
  registerFallbackValue(const Duration(milliseconds: 100));
  ^^^^^^^^^^^^^^^^^^^^^
00:17 +400 ~9 -64: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart: LogViewerScreen 边界测试 大量日志场景 应处理100条日志
00:17 +400 ~9 -65: loading D:/myspace/novel_builder/novel_app/test/unit/widgets/stream_content_widget_test.dart [E]
  Failed to load "D:/myspace/novel_builder/novel_app/test/unit/widgets/stream_content_widget_test.dart":
  Compilation failed for testPath=D:/myspace/novel_builder/novel_app/test/unit/widgets/stream_content_widget_test.dart: Error: Couldn't resolve the package 'mocktail' in 'package:mocktail/mocktail.dart'.
  test/unit/widgets/stream_content_widget_test.dart:3:8: Error: Not found: 'package:mocktail/mocktail.dart'
  import 'package:mocktail/mocktail.dart';
         ^
  test/unit/widgets/stream_content_widget_test.dart:5:8: Error: Error when reading 'lib/widgets/stream_content_widget.dart': 系统找不到指定的文件。
  
  import '../../../lib/widgets/stream_content_widget.dart';
         ^
  test/unit/widgets/stream_content_widget_test.dart:6:8: Error: Error when reading 'lib/models/stream_config.dart': 系统找不到指定的文件。
  
  import '../../../lib/models/stream_config.dart';
         ^
  test/unit/mocks/mock_dependencies.dart:7:8: Error: Not found: 'package:mocktail/mocktail.dart'
  import 'package:mocktail/mocktail.dart';
         ^
  test/unit/mocks/mock_dependencies.dart:11:30: Error: Type 'Mock' not found.
  class MockHttpClient extends Mock implements http.Client {}
                               ^^^^
  test/unit/mocks/mock_dependencies.dart:13:36: Error: Type 'Mock' not found.
  class MockStreamedResponse extends Mock implements http.StreamedResponse {}
                                     ^^^^
  test/unit/mocks/mock_dependencies.dart:15:41: Error: Type 'Mock' not found.
  class MockStreamSubscription<T> extends Mock implements StreamSubscription<T> {}
                                          ^^^^
  test/unit/mocks/mock_dependencies.dart:17:39: Error: Type 'Mock' not found.
  class MockStreamController<T> extends Mock implements StreamController<T> {}
                                        ^^^^
  test/unit/mocks/mock_dependencies.dart:19:27: Error: Type 'Mock' not found.
  class MockRequest extends Mock implements http.Request {}
                            ^^^^
  test/unit/mocks/mock_dependencies.dart:22:37: Error: Type 'Mock' not found.
  class MockSharedPreferences extends Mock implements SharedPreferences {
                                      ^^^^
  test/unit/mocks/mock_dependencies.dart:11:7: Error: The non-abstract class 'MockHttpClient' is missing implementations for these members:
   - Client.close
   - Client.delete
   - Client.get
   - Client.head
   - Client.patch
   - Client.post
   - Client.put
   - Client.read
   - Client.readBytes
   - Client.send
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockHttpClient extends Mock implements http.Client {}
        ^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:160:8: Context: 'Client.close' is defined here.
    void close();
         ^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:122:20: Context: 'Client.delete' is defined here.
    Future<Response> delete(Uri url,
                     ^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:52:20: Context: 'Client.get' is defined here.
    Future<Response> get(Uri url, {Map<String, String>? headers});
                     ^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:47:20: Context: 'Client.head' is defined here.
    Future<Response> head(Uri url, {Map<String, String>? headers});
                     ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:116:20: Context: 'Client.patch' is defined here.
    Future<Response> patch(Uri url,
                     ^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:74:20: Context: 'Client.post' is defined here.
    Future<Response> post(Uri url,
                     ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:95:20: Context: 'Client.put' is defined here.
    Future<Response> put(Uri url,
                     ^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:133:18: Context: 'Client.read' is defined here.
    Future<String> read(Uri url, {Map<String, String>? headers});
                   ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:144:21: Context: 'Client.readBytes' is defined here.
    Future<Uint8List> readBytes(Uri url, {Map<String, String>? headers});
                      ^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/client.dart:147:28: Context: 'Client.send' is defined here.
    Future<StreamedResponse> send(BaseRequest request);
                             ^^^^
  test/unit/mocks/mock_dependencies.dart:13:7: Error: The non-abstract class 'MockStreamedResponse' is missing implementations for these members:
   - BaseResponse.contentLength
   - BaseResponse.headers
   - BaseResponse.isRedirect
   - BaseResponse.persistentConnection
   - BaseResponse.reasonPhrase
   - BaseResponse.request
   - BaseResponse.statusCode
   - StreamedResponse.stream
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockStreamedResponse extends Mock implements http.StreamedResponse {}
        ^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:28:14: Context: 'BaseResponse.contentLength' is defined here.
    final int? contentLength;
               ^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:59:29: Context: 'BaseResponse.headers' is defined here.
    final Map<String, String> headers;
                              ^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:61:14: Context: 'BaseResponse.isRedirect' is defined here.
    final bool isRedirect;
               ^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:64:14: Context: 'BaseResponse.persistentConnection' is defined here.
    final bool persistentConnection;
               ^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:23:17: Context: 'BaseResponse.reasonPhrase' is defined here.
    final String? reasonPhrase;
                  ^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:17:22: Context: 'BaseResponse.request' is defined here.
    final BaseRequest? request;
                       ^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_response.dart:20:13: Context: 'BaseResponse.statusCode' is defined here.
    final int statusCode;
              ^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/streamed_response.dart:15:20: Context: 'StreamedResponse.stream' is defined here.
    final ByteStream stream;
                     ^^^^^^
  test/unit/mocks/mock_dependencies.dart:15:7: Error: The non-abstract class 'MockStreamSubscription' is missing implementations for these members:
   - StreamSubscription.asFuture
   - StreamSubscription.cancel
   - StreamSubscription.isPaused
   - StreamSubscription.onData
   - StreamSubscription.onDone
   - StreamSubscription.onError
   - StreamSubscription.pause
   - StreamSubscription.resume
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockStreamSubscription<T> extends Mock implements StreamSubscription<T> {}
        ^^^^^^^^^^^^^^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2270:13: Context: 'StreamSubscription.asFuture' is defined here.
    Future<E> asFuture<E>([E? futureValue]);
              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2165:16: Context: 'StreamSubscription.cancel' is defined here.
    Future<void> cancel();
                 ^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2254:12: Context: 'StreamSubscription.isPaused' is defined here.
    bool get isPaused;
             ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2175:8: Context: 'StreamSubscription.onData' is defined here.
    void onData(void handleData(T data)?);
         ^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2201:8: Context: 'StreamSubscription.onDone' is defined here.
    void onDone(void handleDone()?);
         ^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2192:8: Context: 'StreamSubscription.onError' is defined here.
    void onError(Function? handleError);
         ^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2233:8: Context: 'StreamSubscription.pause' is defined here.
    void pause([Future<void>? resumeSignal]);
         ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2244:8: Context: 'StreamSubscription.resume' is defined here.
    void resume();
         ^^^^^^
  test/unit/mocks/mock_dependencies.dart:17:7: Error: The non-abstract class 'MockStreamController' is missing implementations for these members:
   - EventSink.add
   - EventSink.addError
   - EventSink.close
   - Sink.add
   - Sink.close
   - StreamConsumer.addStream
   - StreamConsumer.close
   - StreamController.add
   - StreamController.addError
   - StreamController.addStream
   - StreamController.close
   - StreamController.done
   - StreamController.hasListener
   - StreamController.isClosed
   - StreamController.isPaused
   - StreamController.onCancel
   - StreamController.onCancel=
   - StreamController.onListen
   - StreamController.onListen=
   - StreamController.onPause
   - StreamController.onPause=
   - StreamController.onResume
   - StreamController.onResume=
   - StreamController.sink
   - StreamController.stream
   - StreamSink.close
   - StreamSink.done
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockStreamController<T> extends Mock implements StreamController<T> {}
        ^^^^^^^^^^^^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2285:8: Context: 'EventSink.add' is defined here.
    void add(T event);
         ^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2290:8: Context: 'EventSink.addError' is defined here.
    void addError(Object error, [StackTrace? stackTrace]);
         ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2297:8: Context: 'EventSink.close' is defined here.
    void close();
         ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/core/sink.dart:17:8: Context: 'Sink.add' is defined here.
    void add(T data);
         ^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/core/sink.dart:24:8: Context: 'Sink.close' is defined here.
    void close();
         ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2354:10: Context: 'StreamConsumer.addStream' is defined here.
    Future addStream(Stream<S> stream);
           ^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2364:10: Context: 'StreamConsumer.close' is defined here.
    Future close();
           ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:244:8: Context: 'StreamController.add' is defined here.
    void add(T event);
         ^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:252:8: Context: 'StreamController.addError' is defined here.
    void addError(Object error, [StackTrace? stackTrace]);
         ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:312:10: Context: 'StreamController.addStream' is defined here.
    Future addStream(Stream<T> source, {bool? cancelOnError});
           ^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:274:10: Context: 'StreamController.close' is defined here.
    Future close();
           ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:293:14: Context: 'StreamController.done' is defined here.
    Future get done;
               ^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:232:12: Context: 'StreamController.hasListener' is defined here.
    bool get hasListener;
             ^^^^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:218:12: Context: 'StreamController.isClosed' is defined here.
    bool get isClosed;
             ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:229:12: Context: 'StreamController.isPaused' is defined here.
    bool get isPaused;
             ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:204:39: Context: 'StreamController.onCancel' is defined here.
    abstract FutureOr<void> Function()? onCancel;
                                        ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:204:39: Context: 'StreamController.onCancel=' is defined here.
    abstract FutureOr<void> Function()? onCancel;
                                        ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:185:29: Context: 'StreamController.onListen' is defined here.
    abstract void Function()? onListen;
                              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:185:29: Context: 'StreamController.onListen=' is defined here.
    abstract void Function()? onListen;
                              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:192:29: Context: 'StreamController.onPause' is defined here.
    abstract void Function()? onPause;
                              ^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:192:29: Context: 'StreamController.onPause=' is defined here.
    abstract void Function()? onPause;
                              ^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:199:29: Context: 'StreamController.onResume' is defined here.
    abstract void Function()? onResume;
                              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:199:29: Context: 'StreamController.onResume=' is defined here.
    abstract void Function()? onResume;
                              ^^^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:207:21: Context: 'StreamController.sink' is defined here.
    StreamSink<T> get sink;
                      ^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream_controller.dart:72:17: Context: 'StreamController.stream' is defined here.
    Stream<T> get stream;
                  ^^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2403:10: Context: 'StreamSink.close' is defined here.
    Future close();
           ^^^^^
  org-dartlang-sdk:///flutter/third_party/dart/sdk/lib/async/stream.dart:2416:14: Context: 'StreamSink.done' is defined here.
    Future get done;
               ^^^^
  test/unit/mocks/mock_dependencies.dart:19:7: Error: The non-abstract class 'MockRequest' is missing implementations for these members:
   - BaseRequest.finalized
   - BaseRequest.followRedirects
   - BaseRequest.followRedirects=
   - BaseRequest.headers
   - BaseRequest.maxRedirects
   - BaseRequest.maxRedirects=
   - BaseRequest.method
   - BaseRequest.persistentConnection
   - BaseRequest.persistentConnection=
   - BaseRequest.send
   - BaseRequest.url
   - Request.body
   - Request.body=
   - Request.bodyBytes
   - Request.bodyBytes=
   - Request.bodyFields
   - Request.bodyFields=
   - Request.contentLength
   - Request.contentLength=
   - Request.encoding
   - Request.encoding=
   - Request.finalize
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockRequest extends Mock implements http.Request {}
        ^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:99:12: Context: 'BaseRequest.finalized' is defined here.
    bool get finalized => _finalized;
             ^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:67:12: Context: 'BaseRequest.followRedirects' is defined here.
    bool get followRedirects => _followRedirects;
             ^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:70:7: Context: 'BaseRequest.followRedirects=' is defined here.
    set followRedirects(bool value) {
        ^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:96:29: Context: 'BaseRequest.headers' is defined here.
    final Map<String, String> headers;
                              ^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:79:11: Context: 'BaseRequest.maxRedirects' is defined here.
    int get maxRedirects => _maxRedirects;
            ^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:82:7: Context: 'BaseRequest.maxRedirects=' is defined here.
    set maxRedirects(int value) {
        ^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:33:16: Context: 'BaseRequest.method' is defined here.
    final String method;
                 ^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:56:12: Context: 'BaseRequest.persistentConnection' is defined here.
    bool get persistentConnection => _persistentConnection;
             ^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:59:7: Context: 'BaseRequest.persistentConnection=' is defined here.
    set persistentConnection(bool value) {
        ^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:140:28: Context: 'BaseRequest.send' is defined here.
    Future<StreamedResponse> send() async {
                             ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/base_request.dart:36:13: Context: 'BaseRequest.url' is defined here.
    final Uri url;
              ^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:102:14: Context: 'Request.body' is defined here.
    String get body => encoding.decode(bodyBytes);
               ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:104:7: Context: 'Request.body=' is defined here.
    set body(String value) {
        ^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:83:17: Context: 'Request.bodyBytes' is defined here.
    Uint8List get bodyBytes => _bodyBytes;
                  ^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:86:7: Context: 'Request.bodyBytes=' is defined here.
    set bodyBytes(List<int> value) {
        ^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:130:27: Context: 'Request.bodyFields' is defined here.
    Map<String, String> get bodyFields {
                            ^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:141:7: Context: 'Request.bodyFields=' is defined here.
    set bodyFields(Map<String, String> fields) {
        ^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:23:11: Context: 'Request.contentLength' is defined here.
    int get contentLength => bodyBytes.length;
            ^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:26:7: Context: 'Request.contentLength=' is defined here.
    set contentLength(int? value) {
        ^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:52:16: Context: 'Request.encoding' is defined here.
    Encoding get encoding {
                 ^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:60:7: Context: 'Request.encoding=' is defined here.
    set encoding(Encoding value) {
        ^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/http-1.5.0/lib/src/request.dart:160:14: Context: 'Request.finalize' is defined here.
    ByteStream finalize() {
               ^^^^^^^^
  test/unit/mocks/mock_dependencies.dart:22:7: Error: The non-abstract class 'MockSharedPreferences' is missing implementations for these members:
   - SharedPreferences.commit
  Try to either
   - provide an implementation,
   - inherit an implementation from a superclass or mixin,
   - mark the class as abstract, or
   - provide a 'noSuchMethod' implementation.
  
  class MockSharedPreferences extends Mock implements SharedPreferences {
        ^^^^^^^^^^^^^^^^^^^^^
  /C:/Users/KFEB4/AppData/Local/Pub/Cache/hosted/pub.flutter-io.cn/shared_preferences-2.5.3/lib/src/shared_preferences_legacy.dart:193:16: Context: 'SharedPreferences.commit' is defined here.
    Future<bool> commit() async => true;
                 ^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:11:10: Error: 'StreamConfig' isn't a type.
      late StreamConfig testConfig;
           ^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:15:20: Error: Undefined name 'StreamConfig'.
        testConfig = StreamConfig.sceneDescription(
                     ^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:34:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:43:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:51:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:58:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:67:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:94:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:108:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:117:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:130:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:139:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:153:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:162:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:170:50: Error: Undefined name 'StreamContentWidget'.
          final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                   ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:170:75: Error: 'StreamContentWidget' isn't a type.
          final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                                            ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:182:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:204:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:217:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:228:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:238:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:247:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:260:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:267:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:277:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:288:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:301:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:308:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:316:50: Error: Undefined name 'StreamContentWidget'.
          final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                   ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:316:75: Error: 'StreamContentWidget' isn't a type.
          final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                                            ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:324:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:333:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:359:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:367:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:373:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsNothing);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:377:9: Error: 'StreamConfig' isn't a type.
          StreamConfig? capturedConfig;
          ^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:385:26: Error: Method not found: 'StreamContentWidget'.
                    return StreamContentWidget(
                           ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:398:50: Error: Undefined name 'StreamContentWidget'.
          final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                   ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:398:75: Error: 'StreamContentWidget' isn't a type.
          final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                                            ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:407:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsNothing);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:417:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:439:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:448:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:455:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:459:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:468:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:481:24: Error: Undefined name 'StreamConfig'.
          final config = StreamConfig.sceneDescription(
                         ^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:489:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:510:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:522:50: Error: Undefined name 'StreamContentWidget'.
          final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                   ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:522:75: Error: 'StreamContentWidget' isn't a type.
          final widget = tester.widget(find.byType(StreamContentWidget)) as StreamContentWidget;
                                                                            ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:523:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:532:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:556:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:568:28: Error: Undefined name 'StreamContentWidget'.
          expect(find.byType(StreamContentWidget), findsOneWidget);
                             ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:583:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/widgets/stream_content_widget_test.dart:609:21: Error: Method not found: 'StreamContentWidget'.
                body: StreamContentWidget(
                      ^^^^^^^^^^^^^^^^^^^
  test/unit/mocks/mock_dependencies.dart:106:5: Error: Method not found: 'when'.
      when(() => response.statusCode).thenReturn(statusCode);
      ^^^^
  test/unit/mocks/mock_dependencies.dart:109:7: Error: Method not found: 'when'.
        when(() => response.stream)
        ^^^^
  test/unit/mocks/mock_dependencies.dart:112:7: Error: Method not found: 'when'.
        when(() => response.stream)
        ^^^^
  test/unit/mocks/mock_dependencies.dart:282:3: Error: Method not found: 'registerFallbackValue'.
    registerFallbackValue(Uri());
    ^^^^^^^^^^^^^^^^^^^^^
  test/unit/mocks/mock_dependencies.dart:283:3: Error: Method not found: 'registerFallbackValue'.
    registerFallbackValue(http.Request('POST', Uri()));
    ^^^^^^^^^^^^^^^^^^^^^
  test/unit/mocks/mock_dependencies.dart:284:3: Error: Method not found: 'registerFallbackValue'.
    registerFallbackValue(StreamController<String>());
    ^^^^^^^^^^^^^^^^^^^^^
  test/unit/mocks/mock_dependencies.dart:285:3: Error: Method not found: 'registerFallbackValue'.
    registerFallbackValue(const Duration(milliseconds: 100));
    ^^^^^^^^^^^^^^^^^^^^^
  .
00:17 +401 ~9 -65: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 应显示过滤菜单
00:17 +402 ~9 -65: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 应显示过滤菜单
00:17 +403 ~9 -65: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 应显示过滤菜单
00:17 +404 ~9 -65: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 应显示过滤菜单
00:17 +404 ~10 -65: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 应显示过滤菜单
00:18 +405 ~10 -65: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 应显示过滤菜单
00:18 +406 ~10 -65: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_interaction_test.dart: LogViewerScreen 交互功能 复制功能 复制按钮应存在并可点击
00:18 +407 ~10 -65: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_interaction_test.dart: LogViewerScreen 交互功能 复制功能 复制按钮应存在并可点击
00:18 +408 ~10 -65: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_interaction_test.dart: LogViewerScreen 交互功能 复制功能 复制按钮应存在并可点击
00:18 +408 ~10 -65: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 基础 UI Golden 测试 有日志状态 Golden 测试
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following assertion was thrown while running async test code:
Golden "goldens/log_viewer_with_logs.png": Pixel test failed, 9.83%, 47180px diff detected.
Failure feedback can be found at
/D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/failures

When the exception was thrown, this was the stack:
#0      LocalFileComparator.compare (package:flutter_test/src/_goldens_io.dart:108:5)
<asynchronous suspension>
#1      MatchesGoldenFile.matchAsync.<anonymous closure> (package:flutter_test/src/_matchers_io.dart:124:32)
<asynchronous suspension>
<asynchronous suspension>
#3      _expect.<anonymous closure> (package:matcher/src/expect/expect.dart:123:26)
<asynchronous suspension>
<asynchronous suspension>
#5      expectLater.<anonymous closure> (package:flutter_test/src/widget_tester.dart:508:19)
<asynchronous suspension>
#6      main.<anonymous closure>.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart:61:9)
<asynchronous suspension>
#7      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#8      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided 3 frames from dart:async and package:stack_trace)

The exception was caught asynchronously.
════════════════════════════════════════════════════════════════════════════════════════════════════
00:18 +408 ~10 -66: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_interaction_test.dart: LogViewerScreen 交互功能 复制功能 复制按钮应存在并可点击
00:18 +408 ~10 -66: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 基础 UI Golden 测试 有日志状态 Golden 测试 [E]
  Test failed. See exception logs above.
  The test description was: 有日志状态 Golden 测试
  
00:18 +409 ~10 -66: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容
00:18 +410 ~10 -66: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容
00:18 +411 ~10 -66: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容
00:18 +412 ~10 -66: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容
00:18 +413 ~10 -66: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容
00:18 +414 ~10 -66: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容
00:18 +415 ~10 -66: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容
00:18 +416 ~10 -66: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容
00:18 +417 ~10 -66: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容
00:18 +418 ~10 -66: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容
00:18 +418 ~10 -66: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 基础 UI Golden 测试 不同级别日志颜色 Golden 测试
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following assertion was thrown while running async test code:
Golden "goldens/log_viewer_log_levels.png": Pixel test failed, 22.35%, 107270px diff detected.
Failure feedback can be found at
/D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/failures

When the exception was thrown, this was the stack:
#0      LocalFileComparator.compare (package:flutter_test/src/_goldens_io.dart:108:5)
<asynchronous suspension>
#1      MatchesGoldenFile.matchAsync.<anonymous closure> (package:flutter_test/src/_matchers_io.dart:124:32)
<asynchronous suspension>
<asynchronous suspension>
#3      _expect.<anonymous closure> (package:matcher/src/expect/expect.dart:123:26)
<asynchronous suspension>
<asynchronous suspension>
#5      expectLater.<anonymous closure> (package:flutter_test/src/widget_tester.dart:508:19)
<asynchronous suspension>
#6      main.<anonymous closure>.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart:80:9)
<asynchronous suspension>
#7      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#8      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided 3 frames from dart:async and package:stack_trace)

The exception was caught asynchronously.
════════════════════════════════════════════════════════════════════════════════════════════════════
00:18 +418 ~10 -67: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容
00:18 +418 ~10 -67: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 基础 UI Golden 测试 不同级别日志颜色 Golden 测试 [E]
  Test failed. See exception logs above.
  The test description was: 不同级别日志颜色 Golden 测试
  
00:19 +419 ~10 -67: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容
00:19 +420 ~10 -67: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容
00:19 +421 ~10 -67: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容
🧹 DifyStreamingMixin 清理资源
Pending timers:
Timer (duration: 0:01:00.000000, periodic: true), created:
#0      new FakeTimer._ (package:fake_async/fake_async.dart:342:62)
#1      FakeAsync._createTimer (package:fake_async/fake_async.dart:260:29)
#2      FakeAsync.run.<anonymous closure> (package:fake_async/fake_async.dart:187:15)
#5      ChapterManager._initializeCleanupTimer (package:novel_app/services/chapter_manager.dart:152:27)
#6      new ChapterManager._internal (package:novel_app/services/chapter_manager.dart:19:5)
#7      ChapterManager._instance (package:novel_app/services/chapter_manager.dart:16:58)
#8      ChapterManager._instance (package:novel_app/services/chapter_manager.dart)
#9      new ChapterManager (package:novel_app/services/chapter_manager.dart:17:31)
#10     new ApiServiceWrapper._internal (package:novel_app/services/api_service_wrapper.dart:39:42)
#11     ApiServiceWrapper._instance (package:novel_app/services/api_service_wrapper.dart:30:64)
#12     ApiServiceWrapper._instance (package:novel_app/services/api_service_wrapper.dart)
#13     new ApiServiceWrapper (package:novel_app/services/api_service_wrapper.dart:31:34)
#14     ApiServiceProvider.instance (package:novel_app/core/di/api_service_provider.dart:10:19)
#15     new _ParagraphRewriteDialogState (package:novel_app/widgets/reader/paragraph_rewrite_dialog.dart:48:36)
#16     ParagraphRewriteDialog.createState (package:novel_app/widgets/reader/paragraph_rewrite_dialog.dart:41:50)
#17     new StatefulElement (package:flutter/src/widgets/framework.dart:5804:60)
#18     StatefulWidget.createElement (package:flutter/src/widgets/framework.dart:779:38)
...     Normal element mounting (270 frames)
#288    Element.inflateWidget (package:flutter/src/widgets/framework.dart:4548:16)
#289    MultiChildRenderObjectElement.inflateWidget (package:flutter/src/widgets/framework.dart:7169:36)
#290    MultiChildRenderObjectElement.mount (package:flutter/src/widgets/framework.dart:7185:32)
...     Normal element mounting (465 frames)
#755    Element.inflateWidget (package:flutter/src/widgets/framework.dart:4548:16)
#756    Element.updateChild (package:flutter/src/widgets/framework.dart:3998:20)
#757    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#758    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#759    ProxyElement.update (package:flutter/src/widgets/framework.dart:6051:5)
#760    _InheritedNotifierElement.update (package:flutter/src/widgets/inherited_notifier.dart:108:11)
#761    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#762    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#763    StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5884:11)
#764    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#765    StatefulElement.update (package:flutter/src/widgets/framework.dart:5909:5)
#766    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#767    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#768    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#769    ProxyElement.update (package:flutter/src/widgets/framework.dart:6051:5)
#770    _InheritedNotifierElement.update (package:flutter/src/widgets/inherited_notifier.dart:108:11)
#771    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#772    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#773    StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5884:11)
#774    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#775    StatefulElement.update (package:flutter/src/widgets/framework.dart:5909:5)
#776    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#777    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#778    StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5884:11)
#779    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#780    StatefulElement.update (package:flutter/src/widgets/framework.dart:5909:5)
#781    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#782    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#783    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#784    ProxyElement.update (package:flutter/src/widgets/framework.dart:6051:5)
#785    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#786    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#787    StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5884:11)
#788    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#789    StatefulElement.update (package:flutter/src/widgets/framework.dart:5909:5)
#790    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#791    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#792    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#793    ProxyElement.update (package:flutter/src/widgets/framework.dart:6051:5)
#794    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#795    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#796    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#797    ProxyElement.update (package:flutter/src/widgets/framework.dart:6051:5)
#798    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#799    _RawViewElement._updateChild (package:flutter/src/widgets/view.dart:481:16)
#800    _RawViewElement.update (package:flutter/src/widgets/view.dart:568:5)
#801    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#802    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#803    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#804    StatelessElement.update (package:flutter/src/widgets/framework.dart:5797:5)
#805    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#806    ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5747:16)
#807    StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5884:11)
#808    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#809    StatefulElement.update (package:flutter/src/widgets/framework.dart:5909:5)
#810    Element.updateChild (package:flutter/src/widgets/framework.dart:3982:15)
#811    RootElement._rebuild (package:flutter/src/widgets/binding.dart:1716:16)
#812    RootElement.update (package:flutter/src/widgets/binding.dart:1694:5)
#813    RootElement.performRebuild (package:flutter/src/widgets/binding.dart:1708:7)
#814    Element.rebuild (package:flutter/src/widgets/framework.dart:5435:7)
#815    BuildScope._tryRebuild (package:flutter/src/widgets/framework.dart:2695:15)
#816    BuildScope._flushDirtyElements (package:flutter/src/widgets/framework.dart:2752:11)
#817    BuildOwner.buildScope (package:flutter/src/widgets/framework.dart:3056:18)
#818    AutomatedTestWidgetsFlutterBinding.drawFrame (package:flutter_test/src/binding.dart:1506:19)
#819    RendererBinding._handlePersistentFrameCallback (package:flutter/src/rendering/binding.dart:495:5)
#820    SchedulerBinding._invokeFrameCallback (package:flutter/src/scheduler/binding.dart:1434:15)
#821    SchedulerBinding.handleDrawFrame (package:flutter/src/scheduler/binding.dart:1347:9)
#822    AutomatedTestWidgetsFlutterBinding.pump.<anonymous closure> (package:flutter_test/src/binding.dart:1335:9)
#825    TestAsyncUtils.guard (package:flutter_test/src/test_async_utils.dart:74:41)
#826    AutomatedTestWidgetsFlutterBinding.pump (package:flutter_test/src/binding.dart:1324:27)
#827    WidgetTester.pumpWidget.<anonymous closure> (package:flutter_test/src/widget_tester.dart:598:22)
#830    TestAsyncUtils.guard (package:flutter_test/src/test_async_utils.dart:74:41)
#831    WidgetTester.pumpWidget (package:flutter_test/src/widget_tester.dart:595:27)
#832    main.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart:49:20)
#833    testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:29)
<asynchronous suspension>
#834    TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided 7 frames from dart:async and package:stack_trace)

══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following assertion was thrown running a test:
A Timer is still pending even after the widget tree was disposed.
'package:flutter_test/src/binding.dart':
Failed assertion: line 1617 pos 12: '!timersPending'

When the exception was thrown, this was the stack:
#2      AutomatedTestWidgetsFlutterBinding._verifyInvariants (package:flutter_test/src/binding.dart:1617:12)
#3      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1078:7)
<asynchronous suspension>
<asynchronous suspension>
(elided 3 frames from class _AssertionError and package:stack_trace)

The test description was:
  基础替换逻辑测试：删除选中段落并插入新内容
════════════════════════════════════════════════════════════════════════════════════════════════════
00:19 +421 ~10 -68: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 选择INFO级别应只显示信息日志
00:19 +421 ~10 -68: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 基础替换逻辑测试：删除选中段落并插入新内容 [E]
  Test failed. See exception logs above.
  The test description was: 基础替换逻辑测试：删除选中段落并插入新内容
  
00:19 +422 ~10 -68: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 选择INFO级别应只显示信息日志
00:19 +423 ~10 -68: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 选择INFO级别应只显示信息日志
00:19 +424 ~10 -68: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 选择INFO级别应只显示信息日志
00:19 +425 ~10 -68: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 选择INFO级别应只显示信息日志
00:19 +426 ~10 -68: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 选择INFO级别应只显示信息日志
00:19 +427 ~10 -68: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 选择INFO级别应只显示信息日志
00:19 +428 ~10 -68: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 选择INFO级别应只显示信息日志
00:19 +429 ~10 -68: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +429 ~10 -69: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +429 ~10 -69: D:/myspace/novel_builder/novel_app/test/unit/widgets/paragraph_rewrite_widget_test.dart: 段落替换功能测试 特殊情况：包含空行的处理 [E]
  Expected: <5>
    Actual: <6>
  第一段和第二段之间有2个空行
  
  package:matcher                                             expect
  package:flutter_test/src/widget_tester.dart 473:18          expect
  test\unit\widgets\paragraph_rewrite_widget_test.dart 188:7  main.<fn>.<fn>
  
00:19 +430 ~10 -69: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +431 ~10 -69: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +432 ~10 -69: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +433 ~10 -69: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +434 ~10 -69: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +435 ~10 -69: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +436 ~10 -69: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
test/unit/widgets/tts_widgets_test.dart:108:15: Error: No named parameter with the name 'hasPrevious'.
              hasPrevious: true,
              ^^^^^^^^^^^
lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
  const TtsControlPanel({
        ^^^^^^^^^^^^^^^
test/unit/widgets/tts_widgets_test.dart:143:15: Error: No named parameter with the name 'hasPrevious'.
              hasPrevious: true,
              ^^^^^^^^^^^
lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
  const TtsControlPanel({
        ^^^^^^^^^^^^^^^
test/unit/widgets/tts_widgets_test.dart:170:15: Error: No named parameter with the name 'hasPrevious'.
              hasPrevious: true,
              ^^^^^^^^^^^
lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
  const TtsControlPanel({
        ^^^^^^^^^^^^^^^
test/unit/widgets/tts_widgets_test.dart:197:15: Error: No named parameter with the name 'hasPrevious'.
              hasPrevious: false, // 没有上一段
              ^^^^^^^^^^^
lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
  const TtsControlPanel({
        ^^^^^^^^^^^^^^^
test/unit/widgets/tts_widgets_test.dart:225:15: Error: No named parameter with the name 'hasPrevious'.
              hasPrevious: true,
              ^^^^^^^^^^^
lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
  const TtsControlPanel({
        ^^^^^^^^^^^^^^^
test/unit/widgets/tts_widgets_test.dart:255:15: Error: No named parameter with the name 'hasPrevious'.
              hasPrevious: false,
              ^^^^^^^^^^^
lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
  const TtsControlPanel({
        ^^^^^^^^^^^^^^^
test/unit/widgets/tts_widgets_test.dart:283:15: Error: No named parameter with the name 'hasPrevious'.
              hasPrevious: false,
              ^^^^^^^^^^^
lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
  const TtsControlPanel({
        ^^^^^^^^^^^^^^^
test/unit/widgets/tts_widgets_test.dart:312:15: Error: No named parameter with the name 'hasPrevious'.
              hasPrevious: false,
              ^^^^^^^^^^^
lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
  const TtsControlPanel({
        ^^^^^^^^^^^^^^^
test/unit/widgets/tts_widgets_test.dart:346:15: Error: No named parameter with the name 'hasPrevious'.
              hasPrevious: false,
              ^^^^^^^^^^^
lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
  const TtsControlPanel({
        ^^^^^^^^^^^^^^^
00:19 +436 ~10 -69: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart: LogViewerScreen 边界测试 超长消息场景 超长消息应可滚动
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following TestFailure was thrown running a test:
Expected: exactly one matching candidate
  Actual: _DescendantWidgetFinder:<Found 2 widgets with type "InkWell" descending from widgets with
type "Card": [
            InkWell,
            InkWell(dependencies: [_ParentInkResponseProvider]),
          ]>
   Which: is too many

When the exception was thrown, this was the stack:
#4      main.<anonymous closure>.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart:167:9)
<asynchronous suspension>
#5      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#6      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided one frame from package:stack_trace)

This was caught by the test expectation on the following line:
  file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart line 167
The test description was:
  超长消息应可滚动
════════════════════════════════════════════════════════════════════════════════════════════════════
00:19 +436 ~10 -70: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +436 ~10 -70: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart: LogViewerScreen 边界测试 超长消息场景 超长消息应可滚动 [E]
  Test failed. See exception logs above.
  The test description was: 超长消息应可滚动
  
00:19 +437 ~10 -70: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +438 ~10 -70: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +439 ~10 -70: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +440 ~10 -70: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +440 ~10 -71: loading D:/myspace/novel_builder/novel_app/test/unit/widgets/tts_widgets_test.dart [E]
  Failed to load "D:/myspace/novel_builder/novel_app/test/unit/widgets/tts_widgets_test.dart":
  Compilation failed for testPath=D:/myspace/novel_builder/novel_app/test/unit/widgets/tts_widgets_test.dart: test/unit/widgets/tts_widgets_test.dart:108:15: Error: No named parameter with the name 'hasPrevious'.
                hasPrevious: true,
                ^^^^^^^^^^^
  lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
    const TtsControlPanel({
          ^^^^^^^^^^^^^^^
  test/unit/widgets/tts_widgets_test.dart:143:15: Error: No named parameter with the name 'hasPrevious'.
                hasPrevious: true,
                ^^^^^^^^^^^
  lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
    const TtsControlPanel({
          ^^^^^^^^^^^^^^^
  test/unit/widgets/tts_widgets_test.dart:170:15: Error: No named parameter with the name 'hasPrevious'.
                hasPrevious: true,
                ^^^^^^^^^^^
  lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
    const TtsControlPanel({
          ^^^^^^^^^^^^^^^
  test/unit/widgets/tts_widgets_test.dart:197:15: Error: No named parameter with the name 'hasPrevious'.
                hasPrevious: false, // 没有上一段
                ^^^^^^^^^^^
  lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
    const TtsControlPanel({
          ^^^^^^^^^^^^^^^
  test/unit/widgets/tts_widgets_test.dart:225:15: Error: No named parameter with the name 'hasPrevious'.
                hasPrevious: true,
                ^^^^^^^^^^^
  lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
    const TtsControlPanel({
          ^^^^^^^^^^^^^^^
  test/unit/widgets/tts_widgets_test.dart:255:15: Error: No named parameter with the name 'hasPrevious'.
                hasPrevious: false,
                ^^^^^^^^^^^
  lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
    const TtsControlPanel({
          ^^^^^^^^^^^^^^^
  test/unit/widgets/tts_widgets_test.dart:283:15: Error: No named parameter with the name 'hasPrevious'.
                hasPrevious: false,
                ^^^^^^^^^^^
  lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
    const TtsControlPanel({
          ^^^^^^^^^^^^^^^
  test/unit/widgets/tts_widgets_test.dart:312:15: Error: No named parameter with the name 'hasPrevious'.
                hasPrevious: false,
                ^^^^^^^^^^^
  lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
    const TtsControlPanel({
          ^^^^^^^^^^^^^^^
  test/unit/widgets/tts_widgets_test.dart:346:15: Error: No named parameter with the name 'hasPrevious'.
                hasPrevious: false,
                ^^^^^^^^^^^
  lib/widgets/tts_control_panel.dart:17:9: Context: Found this candidate, but the arguments don't match.
    const TtsControlPanel({
          ^^^^^^^^^^^^^^^
  .
00:19 +441 ~10 -71: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +442 ~10 -71: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
00:19 +443 ~10 -71: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following assertion was thrown while running async test code:
Golden "goldens/log_viewer_filtered_error.png": Pixel test failed, 3.60%, 17264px diff detected.
Failure feedback can be found at
/D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/failures

When the exception was thrown, this was the stack:
#0      LocalFileComparator.compare (package:flutter_test/src/_goldens_io.dart:108:5)
<asynchronous suspension>
#1      MatchesGoldenFile.matchAsync.<anonymous closure> (package:flutter_test/src/_matchers_io.dart:124:32)
<asynchronous suspension>
<asynchronous suspension>
#3      _expect.<anonymous closure> (package:matcher/src/expect/expect.dart:123:26)
<asynchronous suspension>
<asynchronous suspension>
#5      expectLater.<anonymous closure> (package:flutter_test/src/widget_tester.dart:508:19)
<asynchronous suspension>
#6      main.<anonymous closure>.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart:100:9)
<asynchronous suspension>
#7      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#8      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided 3 frames from dart:async and package:stack_trace)

The exception was caught asynchronously.
════════════════════════════════════════════════════════════════════════════════════════════════════
00:19 +443 ~10 -72: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 选择WARN级别应只显示警告日志
00:19 +443 ~10 -72: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 ERROR 过滤状态 Golden 测试 [E]
  Test failed. See exception logs above.
  The test description was: ERROR 过滤状态 Golden 测试
  
00:19 +444 ~10 -72: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 选择WARN级别应只显示警告日志
00:19 +445 ~10 -72: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 选择WARN级别应只显示警告日志
00:19 +446 ~10 -72: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 选择WARN级别应只显示警告日志
00:19 +447 ~10 -72: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_interaction_test.dart: LogViewerScreen 交互功能 清空功能 取消清空应保留日志
00:19 +448 ~10 -72: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_interaction_test.dart: LogViewerScreen 交互功能 清空功能 取消清空应保留日志
00:19 +449 ~10 -72: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 过滤提示栏 Golden 测试
00:19 +450 ~10 -72: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 过滤提示栏 Golden 测试
00:20 +451 ~10 -72: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 过滤提示栏 Golden 测试
00:20 +452 ~10 -72: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 过滤提示栏 Golden 测试
00:20 +453 ~10 -72: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 过滤提示栏 Golden 测试
00:20 +454 ~10 -72: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 过滤提示栏 Golden 测试
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following assertion was thrown while running async test code:
Golden "goldens/log_viewer_filter_bar.png": Pixel test failed, 3.60%, 17264px diff detected.
Failure feedback can be found at
/D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/failures

When the exception was thrown, this was the stack:
#0      LocalFileComparator.compare (package:flutter_test/src/_goldens_io.dart:108:5)
<asynchronous suspension>
#1      MatchesGoldenFile.matchAsync.<anonymous closure> (package:flutter_test/src/_matchers_io.dart:124:32)
<asynchronous suspension>
<asynchronous suspension>
#3      _expect.<anonymous closure> (package:matcher/src/expect/expect.dart:123:26)
<asynchronous suspension>
<asynchronous suspension>
#5      expectLater.<anonymous closure> (package:flutter_test/src/widget_tester.dart:508:19)
<asynchronous suspension>
#6      main.<anonymous closure>.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart:117:9)
<asynchronous suspension>
#7      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#8      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided 3 frames from dart:async and package:stack_trace)

The exception was caught asynchronously.
════════════════════════════════════════════════════════════════════════════════════════════════════
00:20 +454 ~10 -73: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart: LogViewerScreen 边界测试 极端堆栈信息场景 应处理超长堆栈信息
00:20 +454 ~10 -73: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 过滤状态 Golden 测试 过滤提示栏 Golden 测试 [E]
  Test failed. See exception logs above.
  The test description was: 过滤提示栏 Golden 测试
  
00:20 +455 ~10 -73: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 应用过滤后应显示过滤提示栏
00:20 +456 ~10 -73: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 应用过滤后应显示过滤提示栏
00:20 +457 ~10 -73: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 对话框 Golden 测试 堆栈信息对话框 Golden 测试
00:20 +458 ~10 -73: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart: LogViewerScreen 边界测试 快速操作场景 快速连续点击过滤按钮不应崩溃
00:20 +459 ~10 -73: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart: LogViewerScreen 边界测试 快速操作场景 快速连续点击过滤按钮不应崩溃

Warning: A call to tap() with finder "Found 1 widget with type "PopupMenuButton<LogLevel?>": [
  PopupMenuButton<LogLevel?>(dependencies: [IconTheme, InheritedCupertinoTheme, _InheritedTheme, _LocalizationsScope-[GlobalKey#ae484]], state: PopupMenuButtonState<LogLevel?>#771f0),
]" derived an Offset (Offset(632.0, 28.0)) that would not hit test on the specified widget.
Maybe the widget is actually off-screen, or another widget is obscuring it, or the widget cannot receive pointer events.
The finder corresponds to this RenderBox: RenderSemanticsAnnotations#28673 relayoutBoundary=up14
The hit test result at that offset is: HitTestResult(RenderMouseRegion#736d6@Offset(632.0, 28.0), RenderSemanticsAnnotations#a7834@Offset(632.0, 28.0), RenderPointerListener#6fb7b@Offset(632.0, 28.0), RenderSemanticsGestureHandler#b699f@Offset(632.0, 28.0), RenderExcludeSemantics#c56a2@Offset(632.0, 28.0), RenderBlockSemantics#c2efa@Offset(632.0, 28.0), RenderIgnorePointer#0f607@Offset(632.0, 28.0), RenderSemanticsAnnotations#44504@Offset(632.0, 28.0), _RenderTheater#0722c@Offset(632.0, 28.0), RenderAbsorbPointer#cdeb8@Offset(632.0, 28.0), RenderPointerListener#1610d@Offset(632.0, 28.0), RenderSemanticsAnnotations#a9d56@Offset(632.0, 28.0), RenderSemanticsAnnotations#c32e5@Offset(632.0, 28.0), RenderSemanticsAnnotations#bdc7d@Offset(632.0, 28.0), RenderTapRegionSurface#01a74@Offset(632.0, 28.0), RenderSemanticsAnnotations#88aee@Offset(632.0, 28.0), RenderSemanticsAnnotations#d4bfe@Offset(632.0, 28.0), RenderSemanticsAnnotations#a8329@Offset(632.0, 28.0), HitTestEntry<HitTestTarget>#0d568(_ReusableRenderView#786ac), HitTestEntry<HitTestTarget>#dd258(<AutomatedTestWidgetsFlutterBinding>))
#0      WidgetController._getElementPoint (package:flutter_test/src/controller.dart:2077:25)
#1      WidgetController.getCenter (package:flutter_test/src/controller.dart:1861:12)
#2      WidgetController.tap (package:flutter_test/src/controller.dart:1041:7)
#3      main.<anonymous closure>.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart:281:24)
<asynchronous suspension>
#4      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#5      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
#6      StackZoneSpecification._registerCallback.<anonymous closure> (package:stack_trace/src/stack_zone_specification.dart:114:42)
<asynchronous suspension>
To silence this warning, pass "warnIfMissed: false" to "tap()".
To make this warning fatal, set WidgetController.hitTestWarningShouldBeFatal to true.


Warning: A call to tap() with finder "Found 1 widget with type "PopupMenuButton<LogLevel?>": [
  PopupMenuButton<LogLevel?>(dependencies: [IconTheme, InheritedCupertinoTheme, _InheritedTheme, _LocalizationsScope-[GlobalKey#ae484]], state: PopupMenuButtonState<LogLevel?>#771f0),
]" derived an Offset (Offset(632.0, 28.0)) that would not hit test on the specified widget.
Maybe the widget is actually off-screen, or another widget is obscuring it, or the widget cannot receive pointer events.
The finder corresponds to this RenderBox: RenderSemanticsAnnotations#28673 relayoutBoundary=up14
The hit test result at that offset is: HitTestResult(RenderMouseRegion#f5fd0@Offset(632.0, 28.0), RenderSemanticsAnnotations#e9fbc@Offset(632.0, 28.0), RenderPointerListener#3e607@Offset(632.0, 28.0), RenderSemanticsGestureHandler#3a5fe@Offset(632.0, 28.0), RenderExcludeSemantics#1fb77@Offset(632.0, 28.0), RenderBlockSemantics#02c33@Offset(632.0, 28.0), RenderIgnorePointer#30ba0@Offset(632.0, 28.0), RenderSemanticsAnnotations#db1ad@Offset(632.0, 28.0), _RenderTheater#0722c@Offset(632.0, 28.0), RenderAbsorbPointer#cdeb8@Offset(632.0, 28.0), RenderPointerListener#1610d@Offset(632.0, 28.0), RenderSemanticsAnnotations#a9d56@Offset(632.0, 28.0), RenderSemanticsAnnotations#c32e5@Offset(632.0, 28.0), RenderSemanticsAnnotations#bdc7d@Offset(632.0, 28.0), RenderTapRegionSurface#01a74@Offset(632.0, 28.0), RenderSemanticsAnnotations#88aee@Offset(632.0, 28.0), RenderSemanticsAnnotations#d4bfe@Offset(632.0, 28.0), RenderSemanticsAnnotations#a8329@Offset(632.0, 28.0), HitTestEntry<HitTestTarget>#39b8e(_ReusableRenderView#786ac), HitTestEntry<HitTestTarget>#4723f(<AutomatedTestWidgetsFlutterBinding>))
#0      WidgetController._getElementPoint (package:flutter_test/src/controller.dart:2077:25)
#1      WidgetController.getCenter (package:flutter_test/src/controller.dart:1861:12)
#2      WidgetController.tap (package:flutter_test/src/controller.dart:1041:7)
#3      main.<anonymous closure>.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart:281:24)
<asynchronous suspension>
#4      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#5      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
#6      StackZoneSpecification._registerCallback.<anonymous closure> (package:stack_trace/src/stack_zone_specification.dart:114:42)
<asynchronous suspension>
To silence this warning, pass "warnIfMissed: false" to "tap()".
To make this warning fatal, set WidgetController.hitTestWarningShouldBeFatal to true.

00:20 +460 ~10 -73: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 对话框 Golden 测试 清空确认对话框 Golden 测试
00:20 +461 ~10 -73: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 无过滤时不显示过滤提示栏
00:20 +461 ~11 -73: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 无过滤时不显示过滤提示栏
00:20 +462 ~11 -73: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart: LogViewerScreen 边界测试 快速操作场景 快速切换过滤级别不应崩溃
00:20 +462 ~11 -73: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 大量日志 Golden 测试 多日志滚动状态 Golden 测试
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following assertion was thrown while running async test code:
Golden "goldens/log_viewer_multiple_logs.png": Pixel test failed, 26.10%, 125300px diff detected.
Failure feedback can be found at
/D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/failures

When the exception was thrown, this was the stack:
#0      LocalFileComparator.compare (package:flutter_test/src/_goldens_io.dart:108:5)
<asynchronous suspension>
#1      MatchesGoldenFile.matchAsync.<anonymous closure> (package:flutter_test/src/_matchers_io.dart:124:32)
<asynchronous suspension>
<asynchronous suspension>
#3      _expect.<anonymous closure> (package:matcher/src/expect/expect.dart:123:26)
<asynchronous suspension>
<asynchronous suspension>
#5      expectLater.<anonymous closure> (package:flutter_test/src/widget_tester.dart:508:19)
<asynchronous suspension>
#6      main.<anonymous closure>.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart:189:9)
<asynchronous suspension>
#7      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#8      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided 3 frames from dart:async and package:stack_trace)

The exception was caught asynchronously.
════════════════════════════════════════════════════════════════════════════════════════════════════
00:20 +462 ~11 -74: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart: LogViewerScreen 边界测试 快速操作场景 快速切换过滤级别不应崩溃
00:20 +462 ~11 -74: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 大量日志 Golden 测试 多日志滚动状态 Golden 测试 [E]
  Test failed. See exception logs above.
  The test description was: 多日志滚动状态 Golden 测试
  
00:20 +463 ~11 -74: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart: LogViewerScreen 边界测试 快速操作场景 快速切换过滤级别不应崩溃
00:21 +463 ~11 -74: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 主题适配 Golden 测试 深色主题 Golden 测试
══╡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ╞════════════════════════════════════════════════════
The following assertion was thrown while running async test code:
Golden "goldens/log_viewer_dark_theme.png": Pixel test failed, 3.54%, 16986px diff detected.
Failure feedback can be found at
/D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/failures

When the exception was thrown, this was the stack:
#0      LocalFileComparator.compare (package:flutter_test/src/_goldens_io.dart:108:5)
<asynchronous suspension>
#1      MatchesGoldenFile.matchAsync.<anonymous closure> (package:flutter_test/src/_matchers_io.dart:124:32)
<asynchronous suspension>
<asynchronous suspension>
#3      _expect.<anonymous closure> (package:matcher/src/expect/expect.dart:123:26)
<asynchronous suspension>
<asynchronous suspension>
#5      expectLater.<anonymous closure> (package:flutter_test/src/widget_tester.dart:508:19)
<asynchronous suspension>
#6      main.<anonymous closure>.<anonymous closure>.<anonymous closure> (file:///D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart:210:9)
<asynchronous suspension>
#7      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:192:15)
<asynchronous suspension>
#8      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1059:5)
<asynchronous suspension>
<asynchronous suspension>
(elided 3 frames from dart:async and package:stack_trace)

The exception was caught asynchronously.
════════════════════════════════════════════════════════════════════════════════════════════════════
00:21 +463 ~11 -75: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart: LogViewerScreen 边界测试 快速操作场景 快速切换过滤级别不应崩溃
00:21 +463 ~11 -75: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_golden_test.dart: LogViewerScreen Golden 测试 主题适配 Golden 测试 深色主题 Golden 测试 [E]
  Test failed. See exception logs above.
  The test description was: 深色主题 Golden 测试
  
00:21 +464 ~11 -75: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 多个同级别日志应都被过滤显示
00:21 +464 ~12 -75: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 多个同级别日志应都被过滤显示
00:21 +465 ~12 -75: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_edge_cases_test.dart: LogViewerScreen 边界测试 时间边界场景 相同时间戳的日志应正确排序
00:21 +466 ~12 -75: D:/myspace/novel_builder/novel_app/test/unit/widgets/log_viewer_screen/log_viewer_screen_filter_test.dart: LogViewerScreen 过滤功能 过滤级别图标应正确显示
00:21 +467 ~12 -75: Some tests failed.
