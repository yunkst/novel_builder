# å•å…ƒæµ‹è¯•ä¿®å¤å·¥ä½œè®¡åˆ’

**åˆ›å»ºæ—¥æœŸ**: 2026-01-26
**ç›®æ ‡**: ä¿®å¤æ‰€æœ‰å¤±è´¥çš„å•å…ƒæµ‹è¯•ï¼ˆ79ä¸ªï¼‰

---

## ğŸ“Š å¤±è´¥æµ‹è¯•åˆ†ç±»

### ç±»åˆ«1: AIä¼´è¯»åŠŸèƒ½æµ‹è¯•å¤±è´¥ï¼ˆçº¦24ä¸ªï¼‰
**é—®é¢˜**: æ•°æ®åº“Schemaç¼ºå¤± `isAccompanied` å­—æ®µ
**å½±å“æµ‹è¯•**:
- `test/unit/accompaniment_display_test.dart`
- `test/unit/services/ai_accompaniment_background_test.dart`
- `test/unit/services/ai_accompaniment_database_test.dart`
- `test/unit/ai_companion_auto_trigger_test.dart`

**ä¿®å¤æ–¹æ¡ˆ**:
1. åœ¨æ•°æ®åº“è¿ç§»v18ä¸­æ·»åŠ ç¼ºå¤±å­—æ®µ
2. æ›´æ–°DatabaseServiceæ–¹æ³•
3. éªŒè¯æ‰€æœ‰AIä¼´è¯»æµ‹è¯•é€šè¿‡

**é¢„è®¡å·¥ä½œé‡**: 30åˆ†é’Ÿ

---

### ç±»åˆ«2: CharacterEditScreenæµ‹è¯•è¶…æ—¶ï¼ˆçº¦7ä¸ªï¼‰
**é—®é¢˜**: æœåŠ¡åˆå§‹åŒ–è€—æ—¶ï¼ŒpumpAndSettleè¶…æ—¶
**å½±å“æµ‹è¯•**:
- `test/unit/screens/character_edit_screen_auto_save_test.dart`

**ä¿®å¤æ–¹æ¡ˆ**:
1. ä¼˜åŒ–æµ‹è¯•åˆå§‹åŒ–é€»è¾‘
2. ä½¿ç”¨Mockæ›¿ä»£çœŸå®æœåŠ¡
3. å‡å°‘pumpAndSettleè°ƒç”¨

**é¢„è®¡å·¥ä½œé‡**: 20åˆ†é’Ÿ

---

### ç±»åˆ«3: é›†æˆæµ‹è¯•è¶…æ—¶/å¤±è´¥ï¼ˆçº¦8ä¸ªï¼‰
**é—®é¢˜**: Widgetæµ‹è¯•ä¾èµ–å¤æ‚ï¼Œå¼‚æ­¥çŠ¶æ€ç®¡ç†
**å½±å“æµ‹è¯•**:
- `test/integration/character_extraction_integration_test.dart`
- `test/integration/paragraph_rewrite_integration_test.dart`
- `test/integration/character_relationship_integration_test.dart`

**ä¿®å¤æ–¹æ¡ˆ**:
1. æ·»åŠ æµ‹è¯•æ•°æ®å‡†å¤‡fixture
2. ä¼˜åŒ–å¼‚æ­¥ç­‰å¾…é€»è¾‘
3. ä½¿ç”¨TestFakeä»£æ›¿çœŸå®ä¾èµ–

**é¢„è®¡å·¥ä½œé‡**: 40åˆ†é’Ÿ

---

### ç±»åˆ«4: APIæœåŠ¡æµ‹è¯•å¤±è´¥ï¼ˆçº¦12ä¸ªï¼‰
**é—®é¢˜**: HOSTç¯å¢ƒå˜é‡æœªé…ç½®
**å½±å“æµ‹è¯•**:
- `test/unit/services/api_service_wrapper_test.dart`
- ä¾èµ–APIçš„é›†æˆæµ‹è¯•

**ä¿®å¤æ–¹æ¡ˆ**:
1. æ·»åŠ æµ‹è¯•é…ç½®æ–‡ä»¶
2. ä½¿ç”¨Mock HTTPå“åº”
3. éš”ç¦»å¤–éƒ¨ä¾èµ–

**é¢„è®¡å·¥ä½œé‡**: 25åˆ†é’Ÿ

---

### ç±»åˆ«5: å¹¶å‘æµ‹è¯•å¤±è´¥ï¼ˆçº¦15ä¸ªï¼‰
**é—®é¢˜**: æ•°æ®åº“é”ç«äº‰ï¼Œæµ‹è¯•é—´ç›¸äº’å½±å“
**å½±å“æµ‹è¯•**:
- `test/unit/preload_service_race_condition_test.dart`
- `test/unit/chapter_manager_test.dart`

**ä¿®å¤æ–¹æ¡ˆ**:
1. æ¯ä¸ªæµ‹è¯•ä½¿ç”¨ç‹¬ç«‹æ•°æ®åº“
2. æ·»åŠ setUp/tearDownæ¸…ç†
3. ä¼˜åŒ–é”æœºåˆ¶

**é¢„è®¡å·¥ä½œé‡**: 35åˆ†é’Ÿ

---

### ç±»åˆ«6: Goldenæµ‹è¯•åƒç´ å·®å¼‚ï¼ˆçº¦10ä¸ªï¼‰
**é—®é¢˜**: UIç»†èŠ‚è°ƒæ•´å¯¼è‡´åƒç´ ä¸åŒ¹é…
**å½±å“æµ‹è¯•**:
- `test/unit/widgets/log_viewer_screen/*_golden_test.dart`

**ä¿®å¤æ–¹æ¡ˆ**:
1. é‡æ–°ç”ŸæˆGoldenæ–‡ä»¶
2. æˆ–è°ƒæ•´åƒç´ å®¹å·®é…ç½®

**é¢„è®¡å·¥ä½œé‡**: 15åˆ†é’Ÿ

---

### ç±»åˆ«7: å…¶ä»–é€»è¾‘é”™è¯¯ï¼ˆçº¦4ä¸ªï¼‰
**é—®é¢˜**: å…·ä½“çš„ä¸šåŠ¡é€»è¾‘bug
**å½±å“æµ‹è¯•**: æ•£è½åœ¨å„ä¸ªæ–‡ä»¶ä¸­

**ä¿®å¤æ–¹æ¡ˆ**: é€ä¸ªåˆ†æå¹¶ä¿®å¤

**é¢„è®¡å·¥ä½œé‡**: 20åˆ†é’Ÿ

---

## ğŸ¯ ä¿®å¤æ‰§è¡Œè®¡åˆ’

### é˜¶æ®µ1: æ•°æ®åº“Schemaä¿®å¤ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
**ä»»åŠ¡**: æ·»åŠ AIä¼´è¯»åŠŸèƒ½æ‰€éœ€çš„æ•°æ®åº“å­—æ®µ
**Subagent**: database-fix-agent
**æ‰§è¡Œå†…å®¹**:
1. åˆ›å»ºæ•°æ®åº“è¿ç§»v18è„šæœ¬
2. æ·»åŠ  `isAccompanied` å­—æ®µåˆ°ç›¸å…³è¡¨
3. æ›´æ–°DatabaseServiceæ–¹æ³•
4. è¿è¡ŒAIä¼´è¯»ç›¸å…³æµ‹è¯•éªŒè¯

---

### é˜¶æ®µ2: AIä¼´è¯»æµ‹è¯•ä¿®å¤
**ä»»åŠ¡**: ä¿®å¤AIä¼´è¯»åŠŸèƒ½çš„24ä¸ªå¤±è´¥æµ‹è¯•
**Subagent**: ai-accompaniment-fix-agent
**æ‰§è¡Œå†…å®¹**:
1. ä¿®å¤accompaniment_display_test.dart
2. ä¿®å¤ai_accompaniment_background_test.dart
3. ä¿®å¤ai_accompaniment_database_test.dart
4. éªŒè¯æ‰€æœ‰æµ‹è¯•é€šè¿‡

---

### é˜¶æ®µ3: CharacterEditScreenæµ‹è¯•ä¼˜åŒ–
**ä»»åŠ¡**: ä¿®å¤7ä¸ªè¶…æ—¶æµ‹è¯•
**Subagent**: ui-test-optimization-agent
**æ‰§è¡Œå†…å®¹**:
1. ä¼˜åŒ–æœåŠ¡åˆå§‹åŒ–
2. æ·»åŠ Mockæ”¯æŒ
3. å‡å°‘æµ‹è¯•ç­‰å¾…æ—¶é—´
4. éªŒè¯æµ‹è¯•é€šè¿‡

---

### é˜¶æ®µ4: é›†æˆæµ‹è¯•ä¿®å¤
**ä»»åŠ¡**: ä¿®å¤8ä¸ªé›†æˆæµ‹è¯•å¤±è´¥
**Subagent**: integration-test-fix-agent
**æ‰§è¡Œå†…å®¹**:
1. ä¿®å¤character_extraction_integration_test.dart
2. ä¿®å¤paragraph_rewrite_integration_test.dart
3. ä¿®å¤character_relationship_integration_test.dart
4. æ·»åŠ æµ‹è¯•fixture

---

### é˜¶æ®µ5: APIæœåŠ¡MockåŒ–
**ä»»åŠ¡**: ä¿®å¤12ä¸ªAPIç›¸å…³æµ‹è¯•å¤±è´¥
**Subagent**: api-mock-agent
**æ‰§è¡Œå†…å®¹**:
1. åˆ›å»ºæµ‹è¯•é…ç½®æ–‡ä»¶
2. æ·»åŠ Mock HTTPå®¢æˆ·ç«¯
3. ä¿®å¤api_service_wrapper_test.dart
4. éªŒè¯æµ‹è¯•é€šè¿‡

---

### é˜¶æ®µ6: å¹¶å‘æµ‹è¯•ä¼˜åŒ–
**ä»»åŠ¡**: ä¿®å¤15ä¸ªå¹¶å‘æµ‹è¯•å¤±è´¥
**Subagent**: concurrency-fix-agent
**æ‰§è¡Œå†…å®¹**:
1. å®ç°æµ‹è¯•æ•°æ®åº“éš”ç¦»
2. æ·»åŠ cleanupé€»è¾‘
3. ä¼˜åŒ–preload_serviceæµ‹è¯•
4. ä¿®å¤chapter_manager_test

---

### é˜¶æ®µ7: Goldenæµ‹è¯•æ›´æ–°
**ä»»åŠ¡**: æ›´æ–°10ä¸ªGoldenæµ‹è¯•
**Subagent**: golden-test-update-agent
**æ‰§è¡Œå†…å®¹**:
1. è¿è¡Œ `flutter test --update-goldens`
2. æ£€æŸ¥åƒç´ å·®å¼‚åŸå› 
3. å¿…è¦æ—¶è°ƒæ•´UIæˆ–é‡æ–°ç”Ÿæˆ

---

### é˜¶æ®µ8: å…¶ä»–é€»è¾‘é”™è¯¯ä¿®å¤
**ä»»åŠ¡**: ä¿®å¤4ä¸ªåˆ†æ•£çš„é€»è¾‘é”™è¯¯
**Subagent**: logic-fix-agent
**æ‰§è¡Œå†…å®¹**:
1. åˆ†æå…·ä½“é”™è¯¯ä¿¡æ¯
2. é€ä¸ªä¿®å¤é€»è¾‘bug
3. éªŒè¯ä¿®å¤æ•ˆæœ

---

## ğŸ“‹ ä»»åŠ¡åˆ†é…è¡¨

| é˜¶æ®µ | Subagent | ä»»åŠ¡æ•° | é¢„è®¡æ—¶é—´ | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|------|----------|--------|----------|--------|------|
| 1 | database-fix-agent | 24 | 30min | P0 | â³ å¾…å¼€å§‹ |
| 2 | ai-accompaniment-fix-agent | 24 | 30min | P0 | â³ å¾…å¼€å§‹ |
| 3 | ui-test-optimization-agent | 7 | 20min | P1 | â³ å¾…å¼€å§‹ |
| 4 | integration-test-fix-agent | 8 | 40min | P1 | â³ å¾…å¼€å§‹ |
| 5 | api-mock-agent | 12 | 25min | P1 | â³ å¾…å¼€å§‹ |
| 6 | concurrency-fix-agent | 15 | 35min | P1 | â³ å¾…å¼€å§‹ |
| 7 | golden-test-update-agent | 10 | 15min | P2 | â³ å¾…å¼€å§‹ |
| 8 | logic-fix-agent | 4 | 20min | P2 | â³ å¾…å¼€å§‹ |

---

## ğŸš€ æ‰§è¡Œç­–ç•¥

### å¹¶è¡Œæ‰§è¡Œ
- **é˜¶æ®µ1-2**: ä¸²è¡Œï¼ˆé˜¶æ®µ2ä¾èµ–é˜¶æ®µ1ï¼‰
- **é˜¶æ®µ3-8**: å¹¶è¡Œæ‰§è¡Œï¼ˆç›¸äº’ç‹¬ç«‹ï¼‰

### éªŒè¯æµç¨‹
æ¯ä¸ªé˜¶æ®µå®Œæˆåï¼š
1. è¿è¡Œç›¸å…³æµ‹è¯•éªŒè¯
2. æŠ¥å‘Šä¿®å¤ç»“æœ
3. æ›´æ–°æ€»ä½“è¿›åº¦

### æ€»é¢„è®¡æ—¶é—´
- **ä¸²è¡Œéƒ¨åˆ†**: 60åˆ†é’Ÿ
- **å¹¶è¡Œéƒ¨åˆ†**: 40åˆ†é’Ÿ
- **æ€»è®¡**: çº¦100åˆ†é’Ÿï¼ˆ1å°æ—¶40åˆ†é’Ÿï¼‰

---

## ğŸ“Š æˆåŠŸæ ‡å‡†

- [ ] æ‰€æœ‰P0çº§åˆ«æµ‹è¯•é€šè¿‡ï¼ˆAIä¼´è¯»åŠŸèƒ½ï¼‰
- [ ] æ•´ä½“æµ‹è¯•é€šè¿‡ç‡æå‡åˆ°95%+
- [ ] æ²¡æœ‰æ–°å¢å¤±è´¥æµ‹è¯•
- [ ] æ‰€æœ‰ä¿®å¤éƒ½æœ‰æµ‹è¯•éªŒè¯
- [ ] ç”Ÿæˆæœ€ç»ˆæµ‹è¯•æŠ¥å‘Š

---

**ä¸‹ä¸€æ­¥**: ç­‰å¾…å½“å‰æµ‹è¯•å®Œæˆåï¼Œç«‹å³å¯åŠ¨é˜¶æ®µ1ï¼ˆæ•°æ®åº“Schemaä¿®å¤ï¼‰
